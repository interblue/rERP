/**
 * 제 품: IBSheet8 - Excel Plugin
 * 버 전: v1.0.22 (20231228-15)
 * 회 사: (주)아이비리더스
 * 주 소: https://www.ibsheet.com
 * 전 화: 1644-5615
 */
C7e9p[164208]=(function(){var h5T=2;for(;h5T !== 9;){switch(h5T){case 2:h5T=typeof globalThis === '\x6f\u0062\u006a\u0065\x63\u0074'?1:5;break;case 1:return globalThis;break;case 5:var s60;h5T=4;break;case 4:try{var Y_Q=2;for(;Y_Q !== 6;){switch(Y_Q){case 2:Object['\u0064\x65\x66\u0069\u006e\u0065\u0050\u0072\u006f\x70\u0065\u0072\x74\u0079'](Object['\x70\u0072\x6f\x74\x6f\x74\u0079\x70\x65'],'\x52\u0067\x58\x24\x42',{'\x67\x65\x74':function(){var I7o=2;for(;I7o !== 1;){switch(I7o){case 2:return this;break;}}},'\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x62\x6c\x65':true});s60=RgX$B;s60['\x69\x48\u0068\x39\x24']=s60;Y_Q=4;break;case 4:Y_Q=typeof iHh9$ === '\u0075\x6e\u0064\x65\u0066\x69\x6e\x65\x64'?3:9;break;case 3:throw "";Y_Q=9;break;case 9:delete s60['\u0069\x48\x68\x39\x24'];var z$H=Object['\u0070\u0072\x6f\u0074\x6f\u0074\x79\x70\x65'];delete z$H['\x52\u0067\u0058\u0024\x42'];Y_Q=6;break;}}}catch(y9z){s60=window;}return s60;break;}}})();C7e9p[141663]=true;C7e9p[17334]=C7e9p[164208];C7e9p[587906]=C7e9p[164208];function C7e9p(){}C7e9p[5612]=163;C7e9p[174427]=234;C7e9p[275350]=C7e9p[164208];C7e9p[164208].j833=C7e9p;C7e9p[143575]="fGB";C7e9p[294511]="Axx";!(function(Q,s){var h0S="absolute";var e7N="down2Text";var T3L="*";var I5C="{";var U$Q="RecordFormats";var x3Q="UseJsonAttribute";var N2_="getSheetFontSize";var L7f="Deli";var T1Y="UseDOM";var d16="center";var o1D="IBSheetLoadExcelFrame";var Q4z="SetLoadTextUrl";var k16="DateStrictMode";var v0r="postMessage";var n4O=0;var H5x="Down2ExcelBuffer";var Q$v=6;var E1y="RecordTypes";var O8u='="';var Y6L="/";var t5I="RowHeights";var o20="Date";var j$y="ANY";var a2G="HmFormat";var B4x="setDown2ExcelConfig";var p5Y="#00ff00";var a5z="input";var j69="SaveNames";var e0m="#808000";var r98="setDown2TextUrl";var q1w="getDown2TextConfig";var j6v="getDown2PdfUrl";var D2U="YmFormat";var O3T="DirectLoadExcel.jsp";var b29=100;var u3M="[object Array]";var Z1r="?";var k1v="getStatusValue";var C92='lang="ko"';var M8J="string";var P8M="SaveName";var J77="Filter";var p$R="IBSheetLoadTextFileFinder";var V2U="float";var W39="loadExcel";var G06="getAutoSumPosition";var w$p="loadText";var S6A="fileDownloadError=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";var O8O="debugMode";var b4c="ColLength2Byte";var V80="GetDown2ExcelConfig";var n49="getTheme";var e7c="An error has occurred while downloading the file.";var x$5="directLoadExcel";var R6D="=";var M2$="attrs";var a_Q="SetLoadTextConfig";var a6S="Html";var o$c="C";var m16='<style type="text/css">* { font-family: ';var R3I="GetDown2TextConfig";var h8w="setDown2HmlUrl";var H2k="SetDown2TextConfig";var h3Y="HeaderMatch";var t$s="\t";var R3b="OrgCol";var A11="#808080";var B8x="HH:mm:ss";var J4G="getLoadExcelConfig";var h2h="getOrgType";var U8A="BaseDir";var f_f="GetExcelRowHeight";var v4y=" ";var W7R="columnTag";var c2N="ExpandLeft";var J4f="MaxCols";var c9s="a";var S8Z="GetLoadExcelUrl";var d8_="WorkSheetName";var y_G="RecordFormat";var J06="SetLoadExcelUrl";var g5p=/^[^\<\{]*\{/;var x6T="getLoadExcelUrl";var H1I="HeaderRows";var U2A="#008080";var U3w="getDown2HmlUrl";var U0n="Visible";var z0o="SetLoadExcelConfig";var S1n="DownHeader";var W$8="setLoadExcelConfig";var O66="Malgun Gothic";var Y7s="DateFormat";var g9B="IBSheetLoadExcelFileFinder";var V4j="number";var b0w="ColAlign";var q9Z="Sheet";var e39="getDown2ExcelUrl";var k12="left";var Z3t="Panel";var Z_f="getRHeight";var g48="form";var h_4="Index";var w5Y="IBSheetLoadTextFrame";var P5U="^";var z1b="getFirstColA";var W73="dir";var V8W="LoadFile";var a8D=" !important }</style>";var g1C='"';var q5Z="file";var V2_="RecordType";var M8T="SubSum";var J0v="GetRHeight";var z88="LoadExcelError";var J1g="ColLength";var F97="'*');";var D1V="SheetWork=";var d1o="forEach";var z5A="GetLoadExcelConfig";var o3h="loadExcelBuffer";var X8h="LoadExcel";var k5N="#008000";var K0u="SheetID";var T2J="Pass";var t4$="StatusCol";var N1F=16;var Y3j="Text";var N$w="DirectLoadExcel";var q95="Radio";var s8R=1024;var M83="ExceedFileSize";var d3O="";var Q2C="get";var G4G="GetLoadTextConfig";var e$m="H";var I31="txt";var X9_="GetColIndexInfo";var v2A=", ";var e44="none";var o6q="#800080";var l6o="#";var b_3="ColumnMapping";var x7p="pdf";var z0G="GetStatusValue";var m3$="#000080";var u_Q="_Span";var c1M="down2Hml";var m7I="DirectDown2Excel";var j5R="fileDownloadToken";var z7w="";var o56="down2ExcelBuffer";var m4t="1.0.22-20231228-15";var U8C="setDown2TextConfig";var X5E="ibexcel";var K9S="object";var W5Z="map";var Y5T="EXCEL";var v6x="SetDown2HmlUrl";var G0n="GetSheetFontName";var n0v="display:none;";var J6d="GetDown2ExcelUrl";var C_E="DoSearchScript";var N75="Span";var h2p="fileDownloadError";var D$o="fontTo";var y3I=13;var b84="setLoadTextConfig";var h6g="GetDown2TextUrl";var A_8="getSheetFontName";var a1V="Data";var z7B="LoadExcelUrl";var w90="setLoadTextUrl";var V0H="Url";var g5k="n";var I$M="#800000";var z89="GetFirstColA";var e0b="Foot";var B99="LegacyFormat";var q_S="EndRow";var n2h="has";var B6Q="</";var V5I="HmsFormat";var J92="isArray";var j4s="CollapseLeft";var u4$="Color";var e2v="xlsx";var S$4="\n";var A03="GetDown2HmlUrl";var o$q="Type";function M(W){var M8l="\\\\t";var v1L="\\";var U8x="IBSheetLoadExcelShowProcessDlg";var v$C="IBSheetLoadExcelError";var J1o="IBSheetDown2ExcelError";var e$Y='"Code":';var N11=/(Result( )?:)/;var u4q="FullLoad 기능을 이용하시려면 다이얼로그 플러그인이 필요합니다.";var Q33='"Result":';var b2k=/(Code( )?:)/;var e2I="IBSheetLoadFileSelect";var n$i="IBSheetOnLoadExcel";var J9$=/(data( )?:( )?\[\[)/;var m6t='"Message":';var b65="IBSheetOnLoadFullExcel";var n0D="IBSheetLoadFileExtError";var f03="UploadFile";var e9T='"data":[[';var N$E=/(Message( )?:)/;var J28="\\$1";try{var P,O,E,N,Z=W.data.split(d3O),u=Z[n4O].split(P5U),z={};if(J1o == u[n4O] && S8T == u.length)return (u[m$I] && -i1f < u[m$I].indexOf(v1L) && (u[m$I]=u[m$I].replace(/\\/g,z7w)),alert(e7c),!i1f);if(v$C == u[n4O] && S8T == u.length)return (u[m$I] && -i1f < u[m$I].indexOf(v1L) && (u[m$I]=u[m$I].replace(/\\/g,z7w)),IBSheet[u[i1f]].LoadExcelError(JSON.parse(u[m$I])),!i1f);if(IBSheet[u[i1f]].HasLoadedExcelData)return !i1f;n$i == u[n4O]?(Z[i1f]=Z[i1f].replace(/\&lt\;/g,v1d).replace(/\&gt\;/g,B1Z).replace(/\&#38\;/g,G3H).replace(/\&amp\;/g,G3H),m$I <= u.length && (Z[i1f]=IBSheet[u[i1f]].ConvertAscNumbertoChar(Z[i1f])),F$K == u.length?((P=JSON.parse(Z[i1f].replace(N11,Q33).replace(b2k,e$Y).replace(N$E,m6t).replace(J9$,e9T).replace(/	/g,M8l).replace(/\\(n|'|"|&|r|t|b|f)?/g,J28).replace(/([\u0000-\u0019]+)/g,z7w).replace(/([\u001A-\u001F]+)/g,z7w)).data).length && i1f === P.length && P[n4O].length && (P=P[n4O]),N=m$I == (E=u[c7S].split(R6D)).length?IBSheet[u[i1f]]._getBooleanValue(E[i1f],n4O):z7w,z.append=N,IBSheet[u[i1f]].CheckLoadExcel=u[S8T],IBSheet[u[i1f]].loadSearchData({data:P,append:z.append})):S8T == u.length && (O=JSON.parse(Z[i1f].replace(N11,Q33).replace(b2k,e$Y).replace(N$E,m6t)).Result,J.OnImportFinish && J.OnImportFinish(IBSheet[u[i1f]],u[m$I],D84,O.Code,O.Message))):b65 == u[n4O]?F$K == u.length && (Z[i1f]=IBSheet[u[i1f]].ConvertAscNumbertoChar(Z[i1f]),N=m$I == (E=u[c7S].split(R6D)).length?IBSheet[u[i1f]]._getBooleanValue(E[i1f],n4O):z7w,Z[i1f],z.type=u[S8T],z.append=N,z.dialogType=IBSheet[u[i1f]]._uploadDialogLoadType,IBSheet[u[i1f]].hideMessage(),IBSheet[u[i1f]].parseFullLoadData?IBSheet[u[i1f]].parseFullLoadData(Z[i1f],z):IBSheet[u[i1f]].ShowMessageTime(u4q)):g9B == u[n4O] || p$R == u[n4O]?i1f == u.length && s.getElementById(u[n4O]).click():U8x == u[n4O]?i1f == u.length && this.showMessage(this.getMessage(f03)):e2I == u[n4O]?S8T == u.length && IBSheet.OnLoadFileSelect && IBSheet.OnLoadFileSelect(IBSheet[u[m$I]],u[i1f],Z[i1f]):n0D == u[n4O] && S8T == u.length && (Y5T == u[i1f]?IBSheet[u[m$I]].ShowAlert(IBSheet[u[m$I]].getMessage(A2a,h37),f6F):W2X == u[i1f] && IBSheet[u[m$I]].ShowAlert(IBSheet[u[m$I]].getMessage(q5H,h37),f6F));}catch(d){}}var y0j="FormulaRow";var s5c="Encoding";var q19="#ff00ff";var B4G="getLoadTextConfig";var Y$O="ExportValue";var J94="center|";var s3j="setDown2PdfUrl";var R5Q="Down2Excel";var o3s="function";var W0m="downloadTokenValue";var l$K="_RowSpan";var N2t="isString";var Y_p="multipart/form-data";var J36="down2Pdf";var W5V="TitleText";var U1z="GetOrgType";var B$9="LoadExcel.jsp";var y03="getHeaderBackColor";var O22="Format";var y0m="undefined";var p5z="class";var f3y="RecordColSpan";var i62="onmessage";var o8L="#ff0000";var K13="Status";var B2V=8;var u0p="Down2Text";var U7e="|";var R_L="GetHeaderBackColor";var C9A="setDown2ExcelUrl";var w0p="message";var E7Y="portrait";var m3L="width:0px;";var k97="Int";var X81="DataFormat";var i2R="RecordRowSpan";var D0E="getNextColA";var u8e="includes";var N9t="SetDown2ExcelUrl";var E2O="//";var D5r="LoadExcelBuffer";var Q27="GetSheetFontSize";var B9k="LoadText";var u16="TitleAlign";var p87="Mode";var Z4B="gi";var r5O="blob";var C7z=";";var e1u="Bool";var A2a="InvalidExcelFileExtension";var D84=null;var Z2B="getDataRowHeight";var m2Q="className";var a_W=/^\s+/;var j8c="doSearchScript";var R5W="_GroupTree";var K02="LegacyType";var T1l="keys";var D9r="iframe";var d1M="set";var V5j="EnumKeys";var V1N="loadFile";var L2$="#c0c0c0";var L6W="SEQ";var t7m="GetNextColA";var E4w="down2Excel";var J4m="GetDown2PdfUrl";var U7U="1|";var i2M="#ffff00";var C$y="MB";var n1r=10;var Y2S="GetAutoSumPosition";var Q8A="WorkSheetNo";var C9h="PDF";var d8b="||";var C7n="GetColName";var I3K="EmptyChar";var N4d="Enum";var Y$V="LoadText.jsp";var B5H="YmdHmsFormat";var W2X="TEXT";var M2J="SkipEmptyRow";var u$g="WorkbookPassword";var h3u="SetDown2ExcelConfig";var V$7="'";var B0I="WordWrap";var W5B="StartCol";var q5H="InvalidTextFileExtension";var K0W="Baekmuk Gulim";var E9P=",";var e6w="Down2Hml";var r6s="Background";var d6O="#fffffe";var h1y="<br/>";var C56="ibsheet";var C3f="GetLoadTextUrl";var s0y="MdFormat";var Q_a="[ibsheet-excel] undefined global object: IBSheet";var D8y="GetTheme";var f7u="FillRight";var h37="Alert";var Q1f="csv";var i8v="directDown2Excel";var G3g="url";var v1d="<";var S8T=3;var t8t="}";var p1J=/\s+$/;var i1f=1;var K1T="POST";var r7l="#ffffff";var G0N="getDown2TextUrl";var g5t="toLower";var T4N="_ConstWidth";var I00="ExtendParam";var T4n="getColName";var l0c="StartRow";var W8T="getLoadTextUrl";var B6F="RowSpan";var f6F="U";var B9R="OrgTextHidden";var d45="UnMatchColHidden";var T5Q="YmdFormat";var m$I=2;var Y36="Img";var z3_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var m1F="Link";var m3T="html";var F8g="CutText";var i$B="HML";var y9E="-";var z7y="SetDown2PdfUrl";var V1G="#00ffff";var S2$="getDown2ExcelConfig";var J2$="loadExcelError";var i2O="hidden";var P0n="FileName";var q31="Float";var B1Z=">";var c7S=4;var X0J="body";var A62="ServerFile";var U83="UserSaveName";var K7w="Header";var F$K=5;var z5f="RecordOrgFormats";var s92="GetSumBackColor";var E11="Append";var e8H="GetDataRowHeight";var h2M="post";var W56="SetDown2TextUrl";var i45="YmdHmFormat";var L40="getSumBackColor";var n4L="getExcelRowHeight";var y6Q="DelCheck";var Q6N="return ";var w5J="ColWidths";var T4Q="HeaderText";var A0s="setLoadExcelUrl";var H7j="1";var l8J="#000000";var D8L="SearchMode";var o86="head";var G3H="&";var U_p="#0000ff";var T6y="div";var T8w="boolean";var O3R="IBSheetID";var I9E=".";var o5T="DatePattern";var y$b="Combo";var p2A="<br>";var P$b="ExportFile";var u4s="CellHeader";var Y3a="getColIndexInfo";var d9$="0px";var U8Z="CumulateRow";var F7i="\r\n";var y1H="&#160;";var V2f="isNumeric";var I6l="Down2Pdf";var h88="extendParam";var Y6_="Merge";var S9$="0";var J=Q.IBSheet;if(D84 == J)throw new Error(Q_a);var K,Y,o,X,q=J.Plugins;(q.PluginVers || (q.PluginVers={}),q.PluginVers.ibexcel={name:X5E,version:m4t},K=z3_,Q.btoa=Q.btoa || (function(L){var O3J=64;var R2s=/[^\x00-\xFF]/;var l7R="InvalidCharacterError";var M2a=63;var t1f=15;L=String(L);var A,V,B,w,n=n4O,F=[];if(R2s.test(L))throw new Error(l7R);for(;n < L.length;)(V=(S8T & (A=L.charCodeAt(n++))) << c7S | (w=L.charCodeAt(n++)) >> c7S,B=(t1f & w) << m$I | (w=L.charCodeAt(n++)) >> Q$v,w=M2a & w,n === L.length + m$I?w=B=O3J:n === L.length + i1f && (w=O3J),F.push(K.charAt(A >> m$I),K.charAt(V),K.charAt(B),K.charAt(w)));return F.join(z7w);}),Q.addEventListener?Q.addEventListener(w0p,M,!i1f):Q.attachEvent && Q.attachEvent(i62,M),q.GetFnLib=function(G){return J.__[G] || void n4O;},J.g_isDown2ExcelBuffer=!i1f,J.g_down2ExcelSheetID=[],J.g_down2ExcelBuffer=z7w,J.g_isDirectDown2Excel=!i1f,J.g_isLoadExcelBuffer=!i1f,J.g_isDirectLoadExcel=!i1f,J.g_targetExcelSheetID=z7w,J.g_LoadExcelSheetID=[],J.g_LoadExcelBuffer=[],J.g_LoadExcelBufferExt=z7w,J.g_targetTextSheetID=z7w,J.g_Multipart=!n4O,J._ibsUtil=(Y={},o={transparent:r7l,black:l8J,silver:L2$,gray:A11,white:d6O,maroon:I$M,red:o8L,purple:o6q,fuchsia:q19,green:k5N,lime:p5Y,olive:e0m,yellow:i2M,navy:m3$,blue:U_p,teal:U2A,aqua:V1G},({init:function(){var e2V="init";return ((this.elem.parent=this).delProperty(this,e2V),this);},trim:function(s8){return s8=(s8+=z7w).replace(a_W,z7w).replace(p1J,z7w);},delProperty:function(G0,P6){try{delete G0[P6];}catch(I1){G0[P6]=void n4O;}},isEmpty:function(b6){return b6 || n4O === b6?n4O:i1f;},isZero:function(u5){return n4O !== u5 && S9$ !== u5?n4O:i1f;},isNumberValue:function(d6){var G2=n4O;return (d6=this.trim(d6),this.isEmpty(d6)?G2=n4O:+d6 + z7w != d6 + z7w && isNaN(+d6) || (G2=i1f),G2);},getCacheGroup:function(M7){return (void n4O === Y[M7] && (Y[M7]={}),Y[M7]);},getCache:function(K2,Q7){var T5=z7w;return T5=this.isEmpty(K2) || this.isEmpty(Q7)?T5:this.getCacheGroup(K2)[Q7];},setCache:function(K5,g3,h6){this.isEmpty(K5) || this.isEmpty(g3) || this.isEmpty(h6) || (this.getCacheGroup(K5)[g3]=h6);},padLeft:function(T7,F$,w3){var l1=n4O,O$=z7w,O6=(O$=T7=this.isEmpty(T7)?z7w:T7 + z7w).length;if(this.isEmpty(w3))return T7;for((w3=(w3 + z7w).substring(n4O,i1f),l1=O6);l1 < F$;l1++)O$=w3 + O$;return O$;},padRight:function(Q2,y1,d1){var t5=n4O,c6=z7w,A4=(c6=Q2=this.isEmpty(Q2)?z7w:Q2 + z7w).length;if(this.isEmpty(d1))return Q2;for((d1=(d1 + z7w).substring(n4O,i1f),t5=A4);t5 < y1;t5++)c6+=d1;return c6;},getWebColor:function(z7,M$){var R27="WebColors";var b7h=7;var W0=-i1f,K1=z7,K0=n4O,h5=n4O,s6=n4O;return M$ && z7w === K1?z7w:void n4O !== (M$=this.getCache(R27,z7))?M$:(K1=(K1 + z7w).toLowerCase(),o[K1]?W0=o[K1]:(n4O < K1.indexOf(E9P)?S8T <= (K1=(K1=K1.replace(/[^\d\,\-]/g,z7w)).split(E9P)).length && (K0=+K1[n4O],h5=+K1[i1f],s6=+K1[m$I],W0=isNaN(K0) || isNaN(h5) || isNaN(s6)?-i1f:(W0=l6o,(W0=(W0+=this.padLeft(K0.toString(N1F),m$I,S9$)) + this.padLeft(h5.toString(N1F),m$I,S9$)) + this.padLeft(s6.toString(N1F),m$I,S9$))):l6o === K1.charAt(n4O)?W0=K1:K1.search(/[^0-9a-f]/gi) < n4O && (W0=l6o + K1),-i1f !== W0 && c7S !== (M$=W0.length) && b7h !== M$ && (W0=-i1f)),this.setCache(R27,z7,W0),W0);},elem:{setValue:function(i8,j_){void n4O !== i8 && (void n4O !== i8.value?i8.value=j_:void n4O !== i8.textContent?i8.textContent=j_:i8.innerText=j_);},select:function(z6){var C1L=9999;z6 && (J.BIPAD && !J.BAndroid?z6.setSelectionRange(n4O,C1L):z6.select());}},isArray:function(Q4){return Array.isArray?Array.isArray(Q4):u3M === Object.prototype.toString.call(Q4);},distinctArray:function(v1){var X9,F1=n4O,E0=z7w,P0={},N9=[];if(!this.isArray(v1))return v1;for((F1=n4O,X9=v1.length);F1 < X9;F1++)P0[E0=this.isArray(v1[F1])?v1[F1].join(P5U):v1[F1]] || (P0[E0]=i1f,N9.push(v1[F1]));return N9;},cloneArray:function(y0){var r2,t6=this.isArray(y0)?[]:{};for(r2 in y0)y0[r2] && K9S == typeof y0[r2]?t6[r2]=this.cloneArray(y0[r2]):t6[r2]=y0[r2];return t6;},getFullPath:function(c7){var n__="<a></a>";var n7=s.createElement(T6y);return (n7.innerHTML=n__,n7.firstChild.href=c7,n7.innerHTML=n7.innerHTML,n7.firstChild.href);},getDomain:function(){var N_=s.location,v7=z7w;return (v7+=N_.protocol + E2O) + N_.host;},escapeRegExp:function(p4){var V3Z="\\$&";var i_=z7w;return i_=this.isEmpty(p4)?i_:(p4 + z7w).replace(/[\^\$\.\*\+\?\=\!\:\|\\\/\(\)\[\]\{\}\/]/g,V3Z);},jsonStringify:function(O7){var x24="\\t";var s1l="\\r";var L0l="\\b";var q$y="\\\\";var y1N='\\"';var m6w="\\f";var C31="\\n";var l9,c_=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n3={"\b":L0l,"\t":x24,"\n":C31,"\f":m6w,"\r":s1l,'"':y1N,"\\":q$y};return (function c5(L1,D0){var I55="[";var W9j="{\n";function m$(I_){return (c_.lastIndex=n4O,c_.test(I_)?g1C + I_.replace(c_,function(S1){var d0y="\\u";var i79="0000";var Z3=n3[S1];return M8J == typeof Z3?Z3:d0y + (i79 + S1.charCodeAt(n4O).toString(N1F)).slice(-c7S);}) + g1C:g1C + I_ + g1C);}var X7C=":";var q6c="null";var D6W="{}";var q9m="]";var g6Y="[\n";var c1Y=",\n";var g2c=": ";var y34="[]";var g8,U0,A0,a1,w_,T3=l9,P5=D0[L1];switch(typeof (P5=P5 && K9S == typeof P5 && o3s == typeof P5.toJSON?P5.toJSON(L1):P5)){case M8J:return m$(P5);case V4j:return isFinite(P5)?String(P5):q6c;case T8w:case q6c:return String(P5);case K9S:if(!P5)return q6c;if((l9+=void n4O,w_=[],u3M === Object.prototype.toString.apply(P5))){for((a1=P5.length,g8=n4O);g8 < a1;g8+=i1f)w_[g8]=c5(g8,P5) || q6c;return (A0=n4O === w_.length?y34:l9?g6Y + l9 + w_.join(c1Y + l9) + S$4 + T3 + q9m:I55 + w_.join(E9P) + q9m,l9=T3,A0);}for(U0 in P5)Object.prototype.hasOwnProperty.call(P5,U0) && (A0=c5(U0,P5)) && w_.push(m$(U0) + (l9?g2c:X7C) + A0);return (A0=n4O === w_.length?D6W:l9?W9j + l9 + w_.join(c1Y + l9) + S$4 + T3 + t8t:I5C + w_.join(E9P) + t8t,l9=T3,A0);}})(z7w,{"":O7});},toJson:function(x1){var J8=D84;if(M8J == typeof x1 && n4O <= x1.search(g5p))try{try{J8=JSON.parse(x1);}catch(T0){J8=(J8=new Function(Q6N + x1))();}}catch(P4){J8=D84;}else J8=K9S == typeof x1?x1:D84;return J8;},toObject:function(y6){var n2a=/\}[^\}]*$/;var q2=D84;if(M8J == typeof y6 && n4O <= y6.search(g5p))try{q2=(q2=new Function(Q6N + y6.replace(g5p,I5C).replace(n2a,t8t)))();}catch(i$){q2=D84;}else q2=K9S == typeof y6?y6:D84;return q2;},exponentToNumberString:function(A2){var S2z=/^\-/;var y4L="0.";var h5L=/[eE]/;var l2=(A2 + z7w).split(h5L),h0=z7w,J1=z7w,f_=z7w;if(i1f == l2.length)return l2[n4O];if((A2=A2 < n4O?y9E:z7w,J1=l2[n4O].replace(I9E,z7w),(f_=+l2[i1f] + i1f) < n4O)){for(h0=A2 + y4L;f_++;)h0+=S9$;return h0 + J1.replace(S2z,z7w);}for(f_-=J1.length;f_--;)h0+=S9$;return J1 + h0;},getFileName:function(t7,r0){return t7=(t7 + z7w).indexOf(I9E) < n4O?t7 + I9E + r0:t7;},getTableBody:function(p$){var i6v="tbody";var e8Q="table";var C3,d4,t9=D84,E6=n4O;if(K9S != typeof p$)return D84;if(e8Q !== p$.tagName.toLowerCase())return p$.firstChild;for((t9=(C3=p$.getElementsByTagName(i6v))[n4O],E6=n4O,d4=C3.length);E6 < d4;E6++)if(n4O < C3[E6].childNodes.length){t9=C3[E6];break;}return t9;},removeHTMLTag:function(Z$,c0){if(D84 == Z$ || M8J != typeof Z$)return z7w;switch(c0){case i1f:return Z$.replace(/<([^>]*)>/gi,z7w);case m$I:return Z$.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,z7w);default:return Z$.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,z7w);}},convert2ByteChar2:function(U8){var Q4s=65248;var g_d=65290;var A2d=65305;for(var A1=new String(),t3=U8.length,G5=n4O;G5 < t3;G5++){var S7=U8.charCodeAt(G5);A1+=g_d <= S7 && S7 <= A2d?String.fromCharCode(S7 - Q4s):U8.charAt(G5);}return A1;},wrapUp:function(N8,B4){return B4 + N8 + B4;},getElementsByClassName:function(k$,F8){var l8n="( |$)";var G$_="(^| )";if((F8=F8 || s).getElementsByClassName)return F8.getElementsByClassName(k$);if(F8.querySelectorAll)return F8.querySelectorAll(I9E + k$);for(var V0=new RegExp(G$_ + k$ + l8n),g5=new Array(),S4=F8.body.getElementsByTagName(T3L),w7=S4.length,W8=n4O;W8 < w7;W8++)V0.test(S4[W8].className) && g5.push(S4[W8]);return (S4=D84,g5);}}).init()),q.DirectDown2Excel=function(s2){var s0=this.Down2Excel(s2,!n4O);if(s2 && s2.debugMode)return s0;},q.DirectLoadExcel=function(w4){return (J.g_isDirectLoadExcel=!n4O,this.LoadExcel(w4));},q.Down2Excel=function(R8,i2){var E_;if((J.g_isDown2ExcelBuffer5 || J.g_isDown2ExcelBuffer || this.showMessage(this.getMessage(P$b)),void n4O === R8 && (R8={}),J.g_isDown2ExcelBuffer || R8.debugMode))return (E_=this._delayedDown2Excel(R8,i2),R8.debugMode && this.hideMessage(),E_);setTimeout((function(){this._delayedDown2Excel(R8,i2);}).bind(this),b29);},q._delayedDown2Excel=function(E2,x7){var G8O="auto";var B7X="&lt";var l8Z="Down2Excel.jsp";var d5I="-1";var y73="&gt";var a9Y=/^\s*((http(s?))\:\/\/)/i;var L2_="Excel";var P5p="Post";this._prepareExportSetting();var P1,N2,w5,C9,t8=z7w,m2=this,N6=z7w;if((J.g_isDirectDown2Excel=i1f == x7,J.g_down2ExcelBuffer || (J.g_down2ExcelSheetID=[]),J.g_down2ExcelSheetID.push(this.id),void n4O === (P1=J._ibsUtil.cloneArray(E2)) && (P1=[]),E2=this.Down2ExcelConfig,P1.downHeader=this._getDefault(void n4O !== P1.downHeader?P1.downHeader:P1.DownHeader,this._getDefault((E2=void n4O === E2?{}:E2).downHeader,!n4O)),P1.downSum=this._getDefault(void n4O !== P1.downSum?P1.downSum:P1.DownSum,this._getDefault(E2.downSum,!n4O)),P1.RequiredMark=this._getDefault(void n4O !== P1.requiredMark?P1.requiredMark:P1.RequiredMark,this._getDefault(E2.RequiredMark,!n4O)),P1.multipart=this._getDefault(void n4O !== P1.multipart?P1.multipart:P1.Multipart,this._getDefault(E2.multipart,!n4O)),P1.textToGeneral=this._getDefault(void n4O !== P1.textToGeneral?P1.textToGeneral:P1.TextToGeneral,this._getDefault(E2.textToGeneral,!n4O)),P1.wordWrap=this._getDefault(void n4O !== P1.wordWrap?P1.wordWrap:P1.WordWrap,this._getDefault(E2.wordWrap,!n4O)),P1.allTypeToText=this._getDefault(void n4O !== P1.allTypeToText?P1.allTypeToText:P1.AllTypeToText,this._getDefault(E2.allTypeToText,!i1f)),P1.appendPrevSheet=this._getDefault(void n4O !== P1.appendPrevSheet?P1.appendPrevSheet:P1.AppendPrevSheet,this._getDefault(E2.appendPrevSheet,!i1f)),P1.autoSizeColumn=this._getDefault(void n4O !== P1.autoSizeColumn?P1.autoSizeColumn:P1.AutoSizeColumn,this._getDefault(E2.autoSizeColumn,!i1f)),P1.checkBoxOffValue=this._getDefault(void n4O !== P1.checkBoxOffValue?P1.checkBoxOffValue:P1.CheckBoxOffValue,this._getDefault(E2.checkBoxOffValue,z7w)),P1.checkBoxOnValue=this._getDefault(void n4O !== P1.checkBoxOnValue?P1.checkBoxOnValue:P1.CheckBoxOnValue,this._getDefault(E2.checkBoxOnValue,z7w)),P1.comboValidation=this._getDefault(void n4O !== P1.comboValidation?P1.comboValidation:P1.ComboValidation,this._getDefault(E2.comboValidation,!i1f)),P1.debugMode=this._getDefault(void n4O !== P1.debugMode?P1.debugMode:P1.DebugMode,this._getDefault(E2.debugMode,!i1f)),P1.downCols=this._getDefault(void n4O !== P1.downCols?P1.downCols:P1.DownCols,this._getDefault(E2.downCols,z7w)),P1.downCombo=this._getDefault(void n4O !== P1.downCombo?P1.downCombo:P1.DownCombo,this._getDefault(E2.downCombo,W2X)).toUpperCase(),P1.downRows=this._getDefault(void n4O !== P1.downRows?P1.downRows:P1.DownRows,this._getDefault(E2.downRows,z7w)),P1.downTreeHide=this._getDefault(void n4O !== P1.downTreeHide?P1.downTreeHide:P1.DownTreeHide,this._getDefault(E2.downTreeHide,!!this.ExcelTreeMode)),P1.excelFontSize=this._getDefault(void n4O !== P1.excelFontSize?P1.excelFontSize:P1.ExcelFontSize,this._getDefault(E2.excelFontSize,n4O)),P1.excelRowHeight=this._getDefault(void n4O !== P1.excelRowHeight?P1.excelRowHeight:P1.ExcelRowHeight,this._getDefault(E2.excelRowHeight,z7w)),P1.excludeSubSum=this._getDefault(void n4O !== P1.excludeSubSum?P1.excludeSubSum:P1.ExcludeSubSum,this._getDefault(E2.excludeSubSum,n4O)),P1.extendParam=this._getDefault(void n4O !== P1.extendParam?P1.extendParam:P1.ExtendParam,this._getDefault(E2.extendParam,z7w)),P1.extendParamMethod=this._getDefault(void n4O !== P1.extendParamMethod?P1.extendParamMethod:P1.ExtendParamMethod,this._getDefault(E2.extendParamMethod,z7w)),P1.fileName=this._getDefault(void n4O !== P1.fileName?P1.fileName:P1.FileName,this._getDefault(E2.fileName,L2_)),P1.hiddenColumn=this._getDefault(void n4O !== P1.hiddenColumn?P1.hiddenColumn:P1.HiddenColumn,this._getDefault(E2.hiddenColumn,!i1f)),P1.merge=this._getDefault(void n4O !== P1.merge?P1.merge:P1.Merge,this._getDefault(E2.merge,this.MultiRecord && i1f & this.MultiRecordShape?i1f:n4O)),P1.mode=this._getDefault(void n4O !== P1.mode?P1.mode:P1.Mode,S9$),P1.numberFormatMode=this._getDefault(void n4O !== P1.numberFormatMode?P1.numberFormatMode:P1.NumberFormatMode,this._getDefault(E2.numberFormatMode,n4O)),P1.numberTypeToText=this._getDefault(void n4O !== P1.numberTypeToText?P1.numberTypeToText:P1.NumberTypeToText,this._getDefault(E2.numberTypeToText,!i1f)),P1.onlyHeaderMerge=this._getDefault(void n4O !== P1.onlyHeaderMerge?P1.onlyHeaderMerge:P1.OnlyHeaderMerge,this._getDefault(E2.onlyHeaderMerge,!i1f)),P1.reportXML=this._getDefault(void n4O !== P1.reportXML?P1.reportXML:P1.ReportXML,this._getDefault(E2.reportXML,z7w)),P1.reportXMLURL=this._getDefault(void n4O !== P1.reportXMLURL?P1.reportXMLURL:P1.ReportXMLURL,this._getDefault(E2.reportXMLURL,z7w)),P1.sheetDesign=this._getDefault(void n4O !== P1.sheetDesign?P1.sheetDesign:P1.SheetDesign,this._getDefault(E2.sheetDesign,i1f)),P1.sheetName=this._getDefault(void n4O !== P1.sheetName?P1.sheetName:P1.SheetName,this._getDefault(E2.sheetName,q9Z)),P1.sheetNo=this._getDefault(void n4O !== P1.sheetNo?P1.sheetNo:P1.SheetNo,this._getDefault(E2.sheetNo,n4O)),P1.startCol=this._getDefault(void n4O !== P1.startCol?P1.startCol:P1.StartCol,this._getDefault(E2.startCol,n4O)),P1.startRow=this._getDefault(void n4O !== P1.startRow?P1.startRow:P1.StartRow,this._getDefault(E2.startRow,n4O)),P1.tempFile=this._getDefault(void n4O !== P1.tempFile?P1.tempFile:P1.TempFile,this._getDefault(E2.tempFile,z7w)),P1.titleAlign=this._getDefault(void n4O !== P1.titleAlign?P1.titleAlign:P1.TitleAlign,this._getDefault(E2.titleAlign,d16)),P1.titleText=this._getDefault(void n4O !== P1.titleText?P1.titleText:P1.TitleText,this._getDefault(E2.titleText,z7w)),P1.treeLevel=this._getDefault(void n4O !== P1.treeLevel?P1.treeLevel:P1.TreeLevel,this._getDefault(E2.treeLevel,!i1f)),P1.url=this._getDefault(void n4O !== P1.url?P1.url:P1.URL,this._getDefault(E2.url,z7w)),P1.userMerge=this._getDefault(void n4O !== P1.userMerge?P1.userMerge:P1.UserMerge,this._getDefault(E2.userMerge,z7w)),P1.workbookPassword=this._getDefault(void n4O !== P1.workbookPassword?P1.workbookPassword:P1.WorkbookPassword,this._getDefault(E2.workbookPassword,z7w)),P1.numberExMode=this._getDefault(void n4O !== P1.numberExMode?P1.numberExMode:P1.NumberExMode,this._getDefault(E2.numberExMode,!i1f)),P1.useFormula=this._getDefault(void n4O !== P1.useFormula?P1.useFormula:P1.UseFormula,this._getDefault(E2.useFormula,!i1f)),P1.excelHeaderRowHeight=this._getDefault(void n4O !== P1.excelHeaderRowHeight?P1.excelHeaderRowHeight:P1.ExcelHeaderRowHeight,this._getDefault(E2.excelHeaderRowHeight,z7w)),P1.imageProcessType=this._getDefault(void n4O !== P1.imageProcessType?P1.imageProcessType:P1.ImageProcessType,this._getDefault(E2.imageProcessType,n4O)),P1.excludeFooterRow=this._getDefault(void n4O !== P1.excludeFooterRow?P1.excludeFooterRow:P1.ExcludeFooterRow,this._getDefault(E2.excludeFooterRow,!i1f)),P1.timeout=this._getDefault(void n4O !== P1.timeout?P1.timeout:P1.Timeout,this._getDefault(E2.timeout,n4O)),P1.useXhr=this._getDefault(void n4O !== P1.useXhr?P1.useXhr:P1.UseXhr,this._getDefault(E2.useXhr,!i1f)),P1.reqHeader=P1.reqHeader || P1.ReqHeader || E2.reqHeader,P1.sendParam=P1.sendParam || P1.SendParam || E2.sendParam,P1.downRowSpan=P1.downRowSpan || P1.DownRowSpan || n4O,void n4O === P1.header && (P1.header=E2.header),void n4O === P1.footer && (P1.footer=E2.footer),this._autoExcelModeCheck(P1,this.AutoExcelMode,Y5T,!n4O,x7)))return ((P1.tempFile || P1.TempFile) && (P1.sheetDesign=n4O),P1.sheetName=P1.sheetName.replace(/\//gi,z7w).replace(/\?/gi,z7w).replace(/\\/gi,z7w).replace(/\*/gi,z7w).replace(/\[/gi,z7w).replace(/\]/gi,z7w).replace(/\:/gi,z7w),z7w == P1.sheetName && (P1.sheetName=q9Z),P1.reportXML?t8=P1.reportXML:z7w != P1.reportXMLURL && ((P1.reportXMLURL + z7w).toLowerCase().search(a9Y) < n4O && (P1.reportXMLURL=J._ibsUtil.getFullPath(P1.reportXMLURL)),M8J == typeof (E2=AjaxCall({Url:P1.reportXMLURL,Method:P5p})) && (t8=E2)),P1.reportXML=t8.replace(/\</gi,B7X).replace(/\>/gi,y73),G8O == (P1.excelRowHeight + z7w).toLowerCase() && (P1.excelRowHeight=d5I),z7w == P1.excelHeaderRowHeight?P1.excelHeaderRowHeight=P1.excelRowHeight:G8O == (P1.excelHeaderRowHeight + z7w).toLowerCase() && (P1.excelHeaderRowHeight=d5I),z7w != P1.downRows && P1.downTreeHide && (P1.downTreeHide=n4O),F7i == P1.titleText.substring(P1.titleText.length - m$I) && (P1.titleText+=v4y),P1.downRows=U7e + P1.downRows + U7e,P1.merge=this._getNumberValue(P1.merge,n4O,n4O,n4O,m$I),d8b != (x7=P1.downCols) && (U7e == (x7=U7e == x7.substring(n4O,i1f)?x7.substring(i1f):x7).substring(x7.length - i1f) && (x7=x7.substring(n4O,x7.length - i1f)),P1.downCols=x7),i1f == J.g_isDirectDown2Excel?(P1.downSum=n4O,P1.onlyHeaderMerge=n4O,P1.treeLevel=n4O,J.g_DirectDownUrl=this.Source.DirectDown2Excel.Url):(void n4O !== this.Source.Down2Excel.Url && z7w != this.Source.Down2Excel.Url || (this.Source.Down2Excel.Url=l8Z),N6=this.Source.Down2Excel.Url),z7w != P1.url && (N6=P1.url,J.g_isDown2ExcelBuffer && (J.g_DirectDownUrl=N6)),N2=P1.extendParam,w5=P1.extendParamMethod,C9=J._ibsUtil.getFileName(P1.fileName,e2v),this.Down2ExcelBufferInfo.extendParam=N2,this.Down2ExcelBufferInfo.extendParamMethod=w5,this.Down2ExcelBufferInfo.timeout=P1.timeout,this.Down2ExcelBufferInfo.useXhr=P1.useXhr,this.Down2ExcelBufferInfo.fileName=C9,this.Down2ExcelBufferInfo.sendParam=P1.sendParam,this.Down2ExcelBufferInfo.reqHeader=P1.reqHeader,this._getDown2Excel(P1,function(V_){m2._sendDown(V_,N6,N2,w5,P1.multipart,Y5T,P1.debugMode,P1.timeout,P1.useXhr,C9,P1.sendParam,P1.reqHeader);}));void n4O === J.g_isDown2ExcelBuffer5 && setTimeout(function(){m2.hideMessage();},n1r);},q.Down2ExcelBuffer=function(q5,y7){this._prepareExportSetting();var w0,a6=z7w,T8=this.IB_DELIMITER_SHEET.length,H8=this._autoExcelModeCheck(z7w,this.AutoExcelMode,Y5T,!n4O,!i1f,q5);if(H8)return q5?(J.g_isDown2ExcelBuffer=q5,void this.showMessage(this.getMessage(P$b))):!q5 && this.Source.Down2Excel && z7w != J.g_down2ExcelBuffer?(J.g_isDown2ExcelBuffer=q5,this.fileDownloadCheckToken=J.g_isDown2ExcelBufferToken,J.g_isDown2ExcelBufferToken=D84,i1f != (w0=this).Down2ExcelBufferInfo.useXhr && (J.fileDownloadCheckTimer=Q.setInterval(function(){var l6=w0._getCookie(j5R);(w0._getCookie(h2p) && (s.cookie=S6A,w0.FileDownloadError=!n4O),l6 == w0.fileDownloadCheckToken && (w0.fileDownloadCheckToken=D84,w0._finishDownload()));},b29)),a6=J.g_isDirectDown2Excel?J.g_DirectDownUrl:this.Source.Down2Excel.Url,this._sendDown(J.g_down2ExcelBuffer.substring(n4O,J.g_down2ExcelBuffer.length - T8),a6,this.Down2ExcelBufferInfo.extendParam,this.Down2ExcelBufferInfo.extendParamMethod,J.g_Multipart,Y5T,y7,this.Down2ExcelBufferInfo.timeout,this.Down2ExcelBufferInfo.useXhr,this.Down2ExcelBufferInfo.fileName,this.Down2ExcelBufferInfo.sendParam,this.Down2ExcelBufferInfo.reqHeader)):void n4O;},q.GetDown2ExcelConfig=function(){return this.Down2ExcelConfig || ({});},q.GetDown2ExcelUrl=function(){var h_=z7w;return h_=this.Source.Down2Excel.Url?this.Source.Down2Excel.Url:h_;},q.GetLoadExcelConfig=function(){return this.LoadExcelConfig || ({});},q.GetLoadExcelUrl=function(){var Z8=z7w;return Z8=this.Source.LoadExcel.Url?this.Source.LoadExcel.Url:Z8;},q.LoadExcel=function(H1){var s_7="FormatCellValue";var i8N="WorkSheetNameStrict";var v$y="MultiRecordNames";this.LoadFileType=Y5T;var s$,B9,e0,e7,N0,S_,M2=(this.LoadExcelExecute=i1f) & this.MultiRecordShape,H1=(this.MultiRecordShape=n4O,this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting(),J._ibsUtil.cloneArray(H1)),P_={},M5=z7w,g0=[],H2=z7w;if((J.g_targetExcelSheetID=this.id,J.g_isLoadExcelBuffer || (J.g_LoadExcelSheetID=[]),J.g_LoadExcelSheetID.push(this.id),void n4O !== this.LoadExcelConfig && (P_=this.LoadExcelConfig),(H1=void n4O === H1?[]:H1).append=this._getDefault(void n4O !== H1.append?H1.append:H1.Append,this._getDefault(P_.append,!i1f)),H1.columnMapping=this._getDefault(void n4O !== H1.columnMapping?H1.columnMapping:H1.ColumnMapping,this._getDefault(P_.columnMapping,z7w)),H1.debugMode=this._getDefault(void n4O !== H1.debugMode?H1.debugMode:H1.DebugMode,this._getDefault(P_.debugMode,!i1f)),H1.endRow=this._getDefault(void n4O !== H1.endRow?H1.endRow:H1.EndRow,this._getDefault(P_.endRow,n4O)),H1.extendParam=this._getDefault(void n4O !== H1.extendParam?H1.extendParam:H1.ExtendParam,this._getDefault(P_.extendParam,z7w)),H1.fileExt=this._getDefault(void n4O !== H1.fileExt?H1.fileExt:H1.FileExt,this._getDefault(P_.fileExt,z7w)),H1.maxFileSize=this._getDefault(void n4O !== H1.maxFileSize?H1.maxFileSize:H1.MaxFileSize,this._getDefault(P_.maxFileSize,n4O,V2U),V2U),H1.merge=this._getDefault(void n4O !== H1.merge?H1.merge:H1.Merge,this._getDefault(P_.merge,i1f)),H1.mode=this._getDefault(void n4O !== H1.mode?H1.mode:H1.Mode,this._getDefault(P_.mode,h3Y)),H1.serverFile=this._getDefault(void n4O !== H1.serverFile?H1.serverFile:H1.ServerFile,this._getDefault(P_.serverFile,z7w)),H1.startCol=this._getDefault(void n4O !== H1.startCol?H1.startCol:H1.StartCol,this._getDefault(P_.startCol,i1f)),H1.startRow=this._getDefault(void n4O !== H1.startRow?H1.startRow:H1.StartRow,this._getDefault(P_.startRow,i1f)),H1.unMatchColHidden=this._getDefault(void n4O !== H1.unMatchColHidden?H1.unMatchColHidden:H1.UnMatchColHidden,this._getDefault(P_.unMatchColHidden,z7w)),H1.useDOM=this._getDefault(void n4O !== H1.useDOM?H1.useDOM:H1.UseDOM,this._getDefault(P_.useDOM,!i1f)),H1.workSheetName=this._getDefault(void n4O !== H1.workSheetName?H1.workSheetName:H1.WorkSheetName,this._getDefault(P_.workSheetName,z7w)),H1.workSheetNo=this._getDefault(void n4O !== H1.workSheetNo?H1.workSheetNo:H1.WorkSheetNo,this._getDefault(P_.workSheetNo,i1f)),H1.skipEmptyRow=this._getDefault(void n4O !== H1.skipEmptyRow?H1.skipEmptyRow:H1.SkipEmptyRow,this._getDefault(P_.skipEmptyRow,!n4O)),H1.useXhr=this._getDefault(void n4O !== H1.useXhr?H1.useXhr:H1.UseXhr,this._getDefault(P_.useXhr,!i1f)),H1.reqHeader=H1.reqHeader || H1.ReqHeader || P_.reqHeader,H1.sendParam=H1.sendParam || H1.SendParam || P_.sendParam,H1.workbookPassword=this._getDefault(void n4O !== H1.workbookPassword?H1.workbookPassword:H1.WorkbookPassword,this._getDefault(P_.workbookPassword,z7w)),H1.formatCellValue=this._getDefault(void n4O !== H1.formatCellValue?H1.formatCellValue:H1.FormatCellValue,this._getDefault(P_.formatCellValue,n4O)),H1.workSheetNameStrict=this._getDefault(void n4O !== H1.workSheetNameStrict?H1.workSheetNameStrict:H1.WorkSheetNameStrict,this._getDefault(P_.workSheetNameStrict,!i1f)),this._uploadDialogLoadType=H1.dialogType || H1.DialogType,this._autoExcelModeCheck(H1,this.AutoExcelMode,Y5T,!i1f,!i1f)))return (this.GetLoadColNames(g0,H1),P_=this._getHeaderText(g0),s$=(S_=this._getColInfo(H1,g0,!i1f)).name,B9=S_.saveName,e0=S_.type,e7=S_.format,N0=S_.datePattern,dataFormat=S_.dataFormat,M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5=(M5+=this._makeColumnTag(k16,H1.DateStrictMode?i1f:n4O)) + this._makeColumnTag(E11,H1.append?i1f:n4O)) + this._makeColumnTag(d45,H1.unMatchColHidden)) + this._makeColumnTag(D8L,this.SearchMode)) + this._makeColumnTag(I00,H1.extendParam)) + this._makeColumnTag(J4f,g0.length)) + this._makeColumnTag(X81,dataFormat)) + this._makeColumnTag(l0c,H1.startRow)) + this._makeColumnTag(q_S,H1.endRow)) + this._makeColumnTag(W5B,H1.startCol)) + this._makeColumnTag(Q8A,H1.workSheetNo)) + this._makeColumnTag(d8_,H1.workSheetName)) + this._makeColumnTag(p87,H1.mode.replace(/ /g,z7w).toUpperCase())) + this._makeColumnTag(t4$,void n4O !== this.StatusCol?this.StatusCol:z7w)) + this._makeColumnTag(b_3,H1.columnMapping)) + this._makeColumnTag(j69,s$)) + this._makeColumnTag(U83,B9)) + this._makeColumnTag(T4Q,P_)) + this._makeColumnTag(P8M,s$)) + this._makeColumnTag(V2_,e0)) + this._makeColumnTag(y_G,e7)) + this._makeColumnTag(o5T,N0)) + this._makeColumnTag(O3R,this.id)) + this._makeColumnTag(Y6_,H1.merge)) + this._makeColumnTag(x3Q,this.UseJsonAttribute)) + this._makeColumnTag(A62,H1.serverFile)) + this._makeColumnTag(M2J,H1.skipEmptyRow?i1f:n4O)) + this._makeColumnTag(u$g,this._encodeBase64(H1.workbookPassword))) + (n4O < H1.formatCellValue?this._makeColumnTag(s_7,H1.formatCellValue):z7w)) + this._makeColumnTag(i8N,H1.workSheetNameStrict),H2=J.g_isDirectLoadExcel?this._getDefault(this.Source.DirectLoadExcel.Url,O3T):this._getDefault(this.Source.LoadExcel.Url,B$9),H2=J._ibsUtil.getFullPath(H2),M5+=this._makeColumnTag(z7B,H2),o3s != typeof Q.postMessage && K9S != typeof Q.postMessage || (M5+=this._makeColumnTag(K0u,this.id)),M5+=this._makeColumnTag(T1Y,H1.useDOM?i1f:n4O),this.MultiRecordShapeLoad?M5=(M5+=this._makeColumnTag(v$y,this._getMultiRecordNames())) + this._makeColumnTag(H1I,this.MultiRecordMax):M5+=this._makeColumnTag(H1I,this.getHeaderRows().length),J.g_isLoadExcelBuffer?(J.g_LoadExcelBuffer.push(M5),J.g_LoadExcelBufferExt=H1.fileExt,J.g_LoadExcelBufferMaxFileSize=H1.maxFileSize,this.g_LoadExcelBufferCfg.useXhr=H1.useXhr,this.g_LoadExcelBufferCfg.sendParam=H1.sendParam,void (this.g_LoadExcelBufferCfg.reqHeader=H1.reqHeader)):H1.debugMode?M5:(H1.useXhr || H1.reqHeader && K9S == typeof H1.reqHeader?this._makeLoadXhr(Y5T,M5,H1.maxFileSize,H1.sendParam,H1.fileExt,H1.reqHeader):this._makeLoadForm(Y5T,J.g_isDirectLoadExcel,H1.fileExt,M5,H1.maxFileSize,H1.serverFile,H1.sendParam),M2 && (this.MultiRecordShape=M2),void (J.g_isDirectLoadExcel=!i1f)));},q.LoadExcelBuffer=function(A_,s9){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var A_=this._getBooleanValue(A_,n4O),r5=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.useXhr,n1=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.sendParam,V7=this.g_LoadExcelBufferCfg && this.g_LoadExcelBufferCfg.reqHeader;if(this._autoExcelModeCheck({},this.AutoExcelMode,Y5T,!i1f,!i1f,A_)){if((J.g_isLoadExcelBuffer=A_,s9))return J.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET);!A_ && n4O < J.g_LoadExcelBuffer.length?(r5 || V7 && K9S == typeof V7?this._makeLoadXhr(Y5T,J.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),J.g_LoadExcelBufferMaxFileSize,n1,J.g_LoadExcelBufferExt,V7,!n4O):this._makeLoadForm(Y5T,J.g_isDirectLoadExcel,J.g_LoadExcelBufferExt,J.g_LoadExcelBuffer.join(this.IB_DELIMITER_SHEET),J.g_LoadExcelBufferMaxFileSize),J.g_LoadExcelBuffer=[]):J.g_LoadExcelSheetID=[];}},q.LoadExcelError=function(P8){this._prepareExportSetting();var A$=n4O,c2=J.g_LoadExcelSheetID.length,J_=(this.getMessage(z88,h37),n4O),e_=z7w;if(!(c2 < i1f))for((void n4O !== P8 && (J_=P8.result || n4O,(e_=P8.message || z7w) && n4O),A$=n4O);A$ < c2;A$++)(J[J.g_LoadExcelSheetID[A$]].hideMessage(),J.OnImportFinish && J.OnImportFinish(this,this.LoadFileType,D84,J_,e_));},q.SetDown2ExcelConfig=function(Y7){(this.Down2ExcelConfig=J._ibsUtil.cloneArray(Y7),void n4O !== this.Down2ExcelConfig.appendPrevSheet && (H7j === this.Down2ExcelConfig.appendPrevSheet?this.Down2ExcelConfig.appendPrevSheet=!n4O:S9$ === this.Down2ExcelConfig.appendPrevSheet && (this.Down2ExcelConfig.appendPrevSheet=!i1f)),void n4O !== this.Down2ExcelConfig.autoSizeColumn && (H7j === this.Down2ExcelConfig.autoSizeColumn?this.Down2ExcelConfig.autoSizeColumn=!n4O:S9$ === this.Down2ExcelConfig.autoSizeColumn && (this.Down2ExcelConfig.autoSizeColumn=!i1f)),void n4O !== this.Down2ExcelConfig.comboValidation && (H7j === this.Down2ExcelConfig.comboValidation?this.Down2ExcelConfig.comboValidation=!n4O:S9$ === this.Down2ExcelConfig.comboValidation && (this.Down2ExcelConfig.comboValidation=!i1f)),void n4O !== this.Down2ExcelConfig.downHeader && (H7j === this.Down2ExcelConfig.downHeader?this.Down2ExcelConfig.downHeader=!n4O:S9$ === this.Down2ExcelConfig.downHeader && (this.Down2ExcelConfig.downHeader=!i1f)),void n4O !== this.Down2ExcelConfig.downSum && (H7j === this.Down2ExcelConfig.downSum?this.Down2ExcelConfig.downSum=!n4O:S9$ === this.Down2ExcelConfig.downSum && (this.Down2ExcelConfig.downSum=!i1f)),void n4O !== this.Down2ExcelConfig.hiddenColumn && (H7j === this.Down2ExcelConfig.hiddenColumn?this.Down2ExcelConfig.hiddenColumn=!n4O:S9$ === this.Down2ExcelConfig.hiddenColumn && (this.Down2ExcelConfig.hiddenColumn=!i1f)),void n4O !== this.Down2ExcelConfig.RequiredMark && (H7j === this.Down2ExcelConfig.RequiredMark?this.Down2ExcelConfig.RequiredMark=!n4O:S9$ === this.Down2ExcelConfig.RequiredMark && (this.Down2ExcelConfig.RequiredMark=!i1f)),void n4O !== this.Down2ExcelConfig.multipart && (H7j === this.Down2ExcelConfig.multipart?this.Down2ExcelConfig.multipart=!n4O:S9$ === this.Down2ExcelConfig.multipart && (this.Down2ExcelConfig.multipart=!i1f)),void n4O !== this.Down2ExcelConfig.numberTypeToText && (H7j === this.Down2ExcelConfig.numberTypeToText?this.Down2ExcelConfig.numberTypeToText=!n4O:S9$ === this.Down2ExcelConfig.numberTypeToText && (this.Down2ExcelConfig.numberTypeToText=!i1f)),void n4O !== this.Down2ExcelConfig.onlyHeaderMerge && (H7j === this.Down2ExcelConfig.onlyHeaderMerge?this.Down2ExcelConfig.onlyHeaderMerge=!n4O:S9$ === this.Down2ExcelConfig.onlyHeaderMerge && (this.Down2ExcelConfig.onlyHeaderMerge=!i1f)),void n4O !== this.Down2ExcelConfig.textToGeneral && (H7j === this.Down2ExcelConfig.textToGeneral?this.Down2ExcelConfig.textToGeneral=!n4O:S9$ === this.Down2ExcelConfig.textToGeneral && (this.Down2ExcelConfig.textToGeneral=!i1f)),void n4O !== this.Down2ExcelConfig.treeLevel && (H7j === this.Down2ExcelConfig.treeLevel?this.Down2ExcelConfig.treeLevel=!n4O:S9$ === this.Down2ExcelConfig.treeLevel && (this.Down2ExcelConfig.treeLevel=!i1f)),void n4O !== this.Down2ExcelConfig.wordWrap && (H7j === this.Down2ExcelConfig.wordWrap?this.Down2ExcelConfig.wordWrap=!n4O:S9$ === this.Down2ExcelConfig.wordWrap && (this.Down2ExcelConfig.wordWrap=!i1f)),void n4O !== this.Down2ExcelConfig.numberExMode && (H7j === this.Down2ExcelConfig.numberExMode?this.Down2ExcelConfig.numberExMode=!n4O:S9$ === this.Down2ExcelConfig.numberExMode && (this.Down2ExcelConfig.numberExMode=!i1f)),void n4O !== this.Down2ExcelConfig.useFormula && (H7j === this.Down2ExcelConfig.useFormula?this.Down2ExcelConfig.useFormula=!n4O:S9$ === this.Down2ExcelConfig.useFormula && (this.Down2ExcelConfig.useFormula=!i1f)),void n4O !== this.Down2ExcelConfig.excludeFooterRow && (H7j === this.Down2ExcelConfig.excludeFooterRow?this.Down2ExcelConfig.excludeFooterRow=!n4O:S9$ === this.Down2ExcelConfig.excludeFooterRow && (this.Down2ExcelConfig.excludeFooterRow=!i1f)),void n4O !== this.Down2ExcelConfig.allTypeToText && (H7j === this.Down2ExcelConfig.allTypeToText?this.Down2ExcelConfig.allTypeToText=!n4O:S9$ === this.Down2ExcelConfig.allTypeToText && (this.Down2ExcelConfig.allTypeToText=!i1f)),void n4O !== this.Down2ExcelConfig.downTreeHide && (H7j === this.Down2ExcelConfig.downTreeHide?this.Down2ExcelConfig.downTreeHide=!n4O:S9$ === this.Down2ExcelConfig.downTreeHide && (this.Down2ExcelConfig.downTreeHide=!i1f)));},q.SetDown2ExcelUrl=function(q_){(this.Source.Down2Excel || (this.Source.Down2Excel={}),this.Source.Down2Excel.Url=q_);},q.SetLoadExcelConfig=function(Y3){(this.LoadExcelConfig=J._ibsUtil.cloneArray(Y3),void n4O !== this.LoadExcelConfig.append && (H7j === this.LoadExcelConfig.append?this.LoadExcelConfig.append=!n4O:S9$ === this.LoadExcelConfig.append && (this.LoadExcelConfig.append=!i1f)),void n4O !== this.LoadExcelConfig.useDOM && (H7j === this.LoadExcelConfig.useDOM?this.LoadExcelConfig.useDOM=!n4O:S9$ === this.LoadExcelConfig.useDOM && (this.LoadExcelConfig.useDOM=!i1f)),void n4O !== this.LoadExcelConfig.skipEmptyRow && (H7j === this.LoadExcelConfig.skipEmptyRow?this.LoadExcelConfig.skipEmptyRow=!n4O:S9$ === this.LoadExcelConfig.skipEmptyRow && (this.LoadExcelConfig.skipEmptyRow=!i1f)));},q.SetLoadExcelUrl=function(C6){(this.Source.LoadExcel || (this.Source.LoadExcel={}),this.Source.LoadExcel.Url=C6);},q._addCellColor=function(b3,Q0,H0){var v$;if(!b3)return z7w;if((H0 && a1V == Q0.Kind && y0j !== Q0.id && (this.Cols[H0].Background || this.Cols[H0].Color) && (v$=this.Cols[H0].Background || this.Cols[H0].Color),(Q0.Background || Q0.Color || Q0.Def && Q0.Def.Color) && (v$=Q0.Background || Q0.Color || Q0.Def && Q0.Def.Color),(Q0[H0 + r6s] || Q0[H0 + u4$]) && (v$=Q0[H0 + r6s] || Q0[H0 + u4$]),y0j === Q0.id && void n4O === v$ && (v$=this.GetSumBackColor(H0)),(v$=a1V == Q0.Kind && M8T === Q0.Name?Q0.Background || Q0.Color || Q0.Def.Color:v$) && -i1f !== v$)){if(-i1f < (v$+=z7w).indexOf(l6o))S8T == (v$=v$.replace(l6o,z7w)).length && (r=v$.substr(n4O,i1f),g=v$.substr(i1f,i1f),b=v$.substr(m$I,i1f),v$=r + r + g + g + b + b);else {if(-i1f == (v$=J._ibsUtil.getWebColor(v$)))return z7w;-i1f < v$.indexOf(l6o) && (v$=v$.replace(l6o,z7w));}return (this._addExcelPaletteList(v$),this.IB_DELIMITER_COLOR + v$);}return z7w;},q._addCellFontColor=function(p9,Y6,o6){var n4t="TextColor";var q4;if(!p9)return z7w;if((o6 && this.Cols[o6].TextColor && K7w != Y6.Kind && (q4=this.Cols[o6].TextColor),(Y6.TextColor || Y6.Def && Y6.Def.TextColor) && (q4=Y6.TextColor || Y6.Def && Y6.Def.TextColor),(q4=Y6[o6 + n4t] || Y6.Def && Y6.Def[o6 + n4t]?Y6[o6 + n4t] || Y6.Def && Y6.Def[o6 + n4t]:q4) && -i1f !== q4)){if(-i1f < (q4+=z7w).indexOf(l6o))S8T == (q4=q4.replace(l6o,z7w)).length && (r=q4.substr(n4O,i1f),g=q4.substr(i1f,i1f),b=q4.substr(m$I,i1f),q4=r + r + g + g + b + b);else {if(-i1f == (q4=J._ibsUtil.getWebColor(q4)))return z7w;-i1f < q4.indexOf(l6o) && (q4=q4.replace(l6o,z7w));}return (this._addExcelPaletteList(q4),this.IB_DELIMITER_COLOR + q4);}return z7w;},q._addExcelPaletteList=function(T_){(T_=v4y + T_.toLowerCase(),-i1f == this.g_excelPaletteList.indexOf(T_) && (this.g_excelPaletteList+=T_));},q._excelDataFixedMergeRange=function(){var J9,V1,H$=n4O,W6=n4O,o8=n4O,I4=n4O;for((void n4O === this.FixedMergeTemplate && this._setFixedMergeTemplate(),J9=this.FixedMergeTemplate,W6=n4O);W6 < this.ExcelXB.length;W6++){for((this.ExcelXB[W6],I4=n4O,V1=J9.length);I4 < V1;I4++)H$ == J9[I4][n4O] && (o8=J9[I4][m$I]?W6 + J9[I4][m$I] - i1f:W6,this.ExcelColsMap[J9[I4][i1f]] && this.ExcelColsMap[J9[I4][S8T]] && this._excelSpanRange(this.ExcelXB,W6,this.ExcelColsMap[J9[I4][i1f]],this.ExcelXB[o8],this.ExcelColsMap[J9[I4][S8T]],n4O));++H$ == this.DataRows && (H$=n4O);}},q._excelDataMergeRange=function(){var S2,K3,u8,D8,Z0,m8,v2,r9,C_,m4,i4;if(!this.MainCol){if(i1f < this.DataRows)for((S2=n4O,D8=this.ExcelXB.length);S2 < D8;S2++)for((v2=this.ExcelXB[S2],K3=n4O,u8=this.ExcelCol.length);K3 < u8;K3++)(C_=v2) != (C_=(v2[(m4=r9=this.ExcelCol[K3]) + B6F] || n4O == v2[r9 + B6F]) && i1f != v2[r9 + B6F]?C_:this._excelMergeTypeExtendBottom(v2,r9,this.XB,S2)) && this._excelSpanRange(this.ExcelXB,S2,r9,C_,r9,n4O);if(this.DataMergeAction){for((i4=[],K3=n4O,u8=this.ExcelCol.length);K3 < u8;K3++)(r9=this.ExcelCol[K3],this.ExcelColMerge[K3] && i4.push(r9));for(S2=n4O;S2 < this.ExcelXB.length;S2++)for((v2=this.ExcelXB[S2],Z0=-i1f,K3=n4O,m8=this.ExcelCol.length);K3 < m8;K3++)(C_=v2,m4=r9=this.ExcelCol[K3],this.ExcelColMerge[K3] && Z0++,n4O == v2[r9 + N75] || (v2[r9 + B6F] || n4O == v2[r9 + B6F]) && i1f != v2[r9 + B6F] || (C_=this._excelMergeExtendBottom(v2,r9,this.ExcelXB,Z0,i4,S2)),!this.DataRowMerge && !v2.RowMerge || n4O === v2[r9 + B6F] || n4O == v2[r9 + B6F] || (v2[r9 + N75] || n4O == v2[r9 + N75]) && i1f != v2[r9 + N75] || (m4=this._excelMergeExtendRight(v2,r9,C_,D84,this.ExcelXB,S2)),v2 == C_ && r9 == m4 || this._excelSpanRange(this.ExcelXB,S2,r9,C_,m4,n4O));}}},q._excelHeaderMergeRange=function(){var q9,y$,R7,j9,l0,M3,e8;if(this.HeaderMergeAction)for(q9=n4O;q9 < this.ExcelXH.length;q9++)for((j9=this.ExcelXH[q9],y$=n4O,R7=this.ExcelCol.length);y$ < R7;y$++)(M3=this.ExcelCol[y$],n4O == (l0=j9)[(e8=this.ExcelCol[y$]) + N75] || (j9[e8 + B6F] || n4O == j9[e8 + B6F]) && i1f != j9[e8 + B6F] || (l0=this._excelMergeExtendBottom(j9,e8,this.ExcelXH,n4O,n4O,q9)),n4O == j9[e8 + B6F] || (j9[e8 + N75] || n4O == j9[e8 + N75]) && i1f != j9[e8 + N75] || (M3=this._excelMergeExtendRight(j9,e8,l0,this.ExcelXH,this.ExcelXH,q9)),j9 == l0 && e8 == M3 || this._excelSpanRange(this.ExcelXH,q9,e8,l0,M3,n4O));},q._excelMergeExtendBottom=function(X7,B8,f1,F6,A6,r_){var x2,x0,x9,d_,P9=X7,H6=(X7[B8],m$I),k2=this.DataMergeAction;if((m$I !== k2 && c7S !== k2 || this.PreColumnMergeMode || (H6=i1f),!this.Cols[X7[B8 + R3b]].ColMerge && (f1 != this.ExcelXH || i1f == this.HeaderMergeMode)))return P9;if(M8T === X7.Name || X7.CumulateRow)return P9;for((x9=(x2=this.GetSheetPageLength()) && m$I == H6?parseInt(r_ / x2) * x2 + x2:f1.length,x0=r_ + i1f);x0 < x9 && (X7=f1[x0]);x0++)if(y0j !== X7.id){if(M8T === X7.Name || X7.CumulateRow)break;if(i1f < this.DataRows && f1 != this.ExcelXH && !X7.UnitPos)break;if((X7[B8],m$I !== k2 && c7S !== k2 || a1V != X7.Kind))break;if((d_=D84,A6?n4O < F6 && (d_=m$I === k2?A6[F6 - i1f]:A6[n4O]):i1f < (F6=parseInt(B8.substring(i1f))) && (d_=o$c + (F6 - i1f)),d_)){if(!X7[d_ + B6F] && n4O != X7[d_ + B6F])break;if(X7[d_ + B6F] && i1f < X7[d_ + B6F])break;}}return P9;},q._excelMergeExtendRight=function(Q$,Q_,z8,T4,M0,l8){var S6N="I";for(var Z7,j$,o$,R_=Q_,I7=Q$[Q_],p_=z7w,u9=Q$[Q_ + R3b],W5=this.Cols[u9].Section,M4=i1f,e6=this.getType(Q$,Q_),t$=[K13,y6Q],z0=n4O;z0 < t$.length;z0++)if(e6 == t$[z0])return R_;if((!this.DataRowMerge || M0) && !Q$.RowMerge)return R_;if(!this.Cols[u9].RowMerge && !M0)return R_;if(S6N == Q$.Status)return R_;for((Z7=Q_.substr(i1f,Q_.length),j$=this.ExcelCol.length);Z7 <= j$;Z7++){if((u9=Q$[(Q_=o$c + Z7) + R3b],M4=i1f,W5 != this.Cols[u9].Section)){M4=n4O;break;}if(!this.Cols[u9].RowMerge && !M0){M4=n4O;break;}if(Q$ != z8)for(z0=l8;;z0++){if(I7 != (p_=(o$=M0[z0])[Q_])){M4=n4O;break;}if(o$ == z8)break;}else (p_=Q$[Q_],n4O != Q$[Q_ + B6F] && I7 == p_ || (M4=n4O));if(!M4)break;(R_=Q_,W5=this.Cols[u9].Section);}return R_;},q._excelMergeTypeExtendBottom=function(t1,h7,J7,z3){var a2,o5,R$=t1,x4=n4O,o_=this.getType(t1,t1[h7 + R3b]);if(!({Status:i1f,Seq:i1f,DelCheck:i1f,Result:i1f})[o_])return R$;for((a2=o_,x4=z3 + i1f,o5=this.ExcelXB.length);x4 < o5 && (t1=this.ExcelXB[x4]).UnitPos;x4++)if(y0j !== t1.id){if(a2 != this.getType(t1,t1[h7 + R3b]))break;R$=t1;}return R$;},q._excelSpanRange=function(m9,u3,z2,x_,w9){var p2,o0,r3,G1,i9,l4=n4O,F0=n4O,f3=n4O,h$=parseInt(z2.substring(i1f)),k9=parseInt(w9.substring(i1f));if(void n4O !== m9[u3][z2] && void n4O !== m9[u3][w9]){if(i1f == m9[u3][z2 + B6F] && n4O == m9[u3][z2 + N75])for(o0=h$;n4O <= o0;o0--)if(i1f < m9[u3][o$c + o0 + N75]){m9[u3][o$c + o0 + N75]=m9[u3][o$c + o0 + N75] - i1f;break;}for(o0=h$;o0 <= k9;o0++)if(n4O == m9[i9=u3][o$c + o0 + B6F]){for((l4=n4O,r3=i9 - i1f);n4O <= r3;r3--)if((l4++,n4O < m9[r3][o$c + o0 + B6F])){m9[r3][o$c + o0 + B6F]=l4;break;}if(n4O == m9[i9 + i1f][o$c + o0 + B6F])for((l4=n4O,r3=i9 + i1f,G1=m9.length);r3 < G1 && n4O == m9[r3][o$c + o0 + B6F];r3++)(this.DelProperty(m9[r3],[o$c + o0 + B6F]),this.DelProperty(m9[r3],[o$c + o0 + N75]));}for((f3=n4O,p2=u3);;p2++){for((f3++,o0=h$);o0 <= k9;o0++)(F0=o0 == h$?k9 - h$ + i1f:n4O,m9[p2][o$c + o0 + B6F]=n4O,m9[p2][o$c + o0 + N75]=F0);if(m9[p2] == x_)break;}for(o0=h$;o0 <= k9;o0++)m9[u3][o$c + o0 + B6F]=f3;}},q._getDown2Excel=function(u_,U3){var o_J="AutoSizeColumn";var I3F="|visible|";var Z0n="ExcelFontSize";var r22="background-color";var F6Z="FootRow";var D$v="TempFile";var T0G="ReportXML";var t7z="NumberFormatMode";var y12="SheetFontName";var H1a="SheetNo";var i17="ComboValidation";var o0J="NumberExMode";var C3q="UserMerge";var V7S="MergeMode";var r_U="PrintSetup";var c_V="BottomFontName";var a5t="BottomBorder";var N7r="BottomHeight";var n8L="HeaderBackColor";var E1p=255;var m$Y="CellFormula";var b9W="TopFontColor";var r63="TextToGeneral";var F5O="color";var b9F="SumEndRow";var Y_N="TopFontBold";var S$H="TopFontSize";var o1C="BottomFontUnder";var b9$="ColMerge";var k1D="ColVisibles";var k1W="TopFontName";var L0z="TopFontUnder";var R11="_IBCC";var y1e="SheetName";var J6H="Palette";var U7Y="SheetFontSize";var e00="BottomFontColor";var A8M="TopText";var Q8j="16777215";var X02="SumRow";var A6$="SumStartRow";var c$5="TopBorder";var A2g="SheetDesign";var r60="BottomAlign";var I4t="allTypeToText";var z5o="TopHeight";var E_E="TopBackColor";var Y1$="UseFormula";var E$v="ImageProcessType";var z$P="HeaderFontColor";var a8w="ImageList";var e$J="BottomText";var I93="SumBackColor";var I1d="BottomBackColor";var S$x="AppendPrevSheet";var F6e="SumCell";var t5l="DownCombo";var E$f="SubSumRow";var j$$=" .";var G7k="_IBCT";var j6A="DownRowSpan";var n_h="ExcelHeaderRowHeight";var m35="BottomFontSize";var Y$A="TopAlign";var z4l="ExcelRowHeight";var M2C="BottomFontBold";var V2,F_,h3,Z5,v8,x3,U7,E1,J0,T2,I0,t2,H7,d8=[],I5=z7w,V8=[],D_=i1f,B7=z7w,Q5=z7w,k0=!i1f,Q1=this,m7=n4O,K9=!i1f,B3=z7w,v9=z7w,r$=[],X5=n4O,q8=n4O,u0=n4O,X0=d8b != u_.downRows,k3=I3F == (u_.downRows + z7w).toLowerCase(),H4=u_.downHeader && u_.merge,p6=!u_.onlyHeaderMerge,Z_=u_.treeLevel,n_=n4O,f6=n4O,N7=[],a0=[],b4=[],Y4=[],C8=z7w,X2=z7w,e$=z7w,k6=z7w,p8=(this.Cols,this.ImageList),G6=[],D1={},y5=z7w,w8=z7w,Y5=z7w,v_=z7w,B2=z7w,I9=z7w,f4=z7w,Y_=z7w,C8=z7w,U_=z7w,M9=z7w,O_=z7w,K$=z7w,J3=z7w,F2=z7w,L2=z7w,V9=z7w,x6=z7w,A9=z7w,A9=z7w,q3=z7w,S6=n4O,A5=n4O,L9=[],O1=this.hasFilter();for((this.g_excelPaletteList=z7w,i1f != u_.sheetDesign && m$I != u_.sheetDesign && c7S != u_.sheetDesign || (k0=!n4O),F_=(r$=this.MultiRecord && i1f & this.MultiRecordShape?this._DownMultiMap[n4O]:this._getDownColNames(u_)).length,n_=n4O);n_ < this.DataRows;n_++)for((U7=this.Cols,f6=n4O);f6 < F_;f6++)(void n4O !== (B3=(V2=(this.MultiRecord && i1f & this.MultiRecordShape?this._DownMultiMap[n_]:r$)[f6]) && U7[V2] && U7[V2].EnumKeys?(z7w + U7[V2].EnumKeys).substring(i1f):void n4O) && B3.length < E1p && (v9+=this._makeColumnTag(m7 + R11,void n4O !== B3?B3:z7w)),void n4O !== (B3=V2 && U7[V2] && U7[V2].Enum?(z7w + U7[V2].Enum).substring(i1f):void n4O) && B3.length < E1p && (v9+=this._makeColumnTag(m7 + G7k,void n4O !== B3?B3:z7w)),m7++);if((B7+=v9,n4O == F_))return (this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,Y5T,!i1f),-i1f);if((C8=this.GetHeaderBackColor(),X2=this.GetSumBackColor(),B2=this.GetHeaderFontColor(),z7w == C8 && (C8=-i1f == (C8=J._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(j$$ + this.GetTheme() + u4s,r22)))?z7w:C8),z7w == X2 && (X2=-i1f == (X2=J._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(j$$ + this.GetTheme() + F6e,r22)))?z7w:X2),z7w == B2 && (B2=-i1f == (B2=J._ibsUtil.getWebColor(this._getCCSStylesheetRuleStyle(j$$ + this.GetTheme() + T4Q,F5O)))?z7w:B2),C8=C8.replace(/#/g,z7w),X2=X2.replace(/#/g,z7w),B2=B2.replace(/#/g,z7w),e$=parseInt(C8,N1F),k6=parseInt(X2,N1F),headerFontColorInt=parseInt(B2,N1F),e$=isNaN(e$)?Q8j:e$,k6=isNaN(k6)?Q8j:k6,headerFontColorInt=isNaN(headerFontColorInt)?Q8j:headerFontColorInt,this._addExcelPaletteList(X2),this._addExcelPaletteList(C8),this._addExcelPaletteList(B2),this.ExcelXH=[],this.ExcelXB=[],this.ExcelXF=[],this.ExcelColsMap={},X2={from:Y5T,cfg:u_,sheetDesign:k0,isTreeLevel:Z_,isDownRows:X0,isDownRowVisible:k3,rowHeights:V8,downColNames:r$,downColNamesLength:F_,data:d8,p:D_,headerRows:q8,isHeaderMerge:H4},u_.merge)){for((n_=n4O,h3=this.getCols().length);n_ < h3;n_++){if((K9=!i1f,V2=this.getCols()[n_],this.Cols[V2].Visible))for(f6=n4O;f6 < F_;f6++)V2 == r$[f6] && (K9=!n4O);else for((K9=!n4O,f6=n4O);f6 < F_;f6++)if(V2 == r$[f6]){K9=!i1f;break;}if(!(E1=K9))break;}if(((J.g_isDirectDown2Excel || X0 && !k3 || u_.downRowSpan) && (p6=!i1f),R5W == this.MainCol && (p6=!i1f),X5=n4O,u_.downHeader || (X5=this.getHeaderRows().length),this.Rows.FormulaRow && e0b == this.Rows.FormulaRow.Fixed && this.Rows.FormulaRow.Visible && !u_.downSum && X5++,this.Rows.Filter && this.Rows.Filter.Visible && X5++,(X2.isSameDownColAndVisible=E1) && (this.ExLoad || !O1) && (!this.ExLoad || X0 && !k3 || !this.MergeVisibleDom && (n4O != this.RowIndexMap.length || this.MainTag.offsetHeight && this.MainTag.offsetWidth)) || (this.MergeAllRanges=!n4O),H4))for(var K7=this.getHeaderRows(),n_=n4O;n_ < K7.length;n_++)this.SetRowAutoMerge(K7[n_],this.HeaderMerge,r$);if(!J.g_isDirectDown2Excel && this.MergeAllRanges){if((!this.ExLoad || !this.CalcMergeMode && (n4O != this.RowIndexMap.length || this.MainTag.offsetHeight && this.MainTag.offsetWidth) || (H7=this.RowIndexMap,this.UpdateRowIndex()),p6)){(this.ExLoad && !this.MergeVisibleDom && this.SplitDataAutoMerge(),this.MergeAllRanges && !X0 && (this.RowsMergeRow=this.getDataRows()));for(var j6=k3?this.getFirstVisibleRow():this.getFirstRow(D84,B2V);j6;j6=k3?this.getNextVisibleRow(j6):this.getNextRow(j6))this.SetRowAutoMerge(j6,this.DataMerge,r$);this.ExLoad && !this.MergeVisibleDom && (Q1=this,setTimeout(function(){(this.MergeAllRanges=!n4O,Q1.SetDataAutoMerge(),delete this.MergeAllRanges);},b29));}(D84 != H7 && (this.RowIndexMap=H7),delete this.RowsMergeRow);}}for((u_.downHeader && (Z5=this._getHeaderData(X2),X2.p=Z5.p,D_=Z5.p,X2.headerRows=Z5.headerRows,u0=Z5.headerRows),c7S == u_.sheetDesign && (X2.sheetDesign=!i1f),i1f != J.g_isDirectDown2Excel && (D_=(Z5=this._getBodyData(X2)).p,d8=Z5.data,q8=Z5.headerRows,V8=Z5.rowHeights,N7=Z5.sumRow,a0=Z5.subSumRow,b4=Z5.cumulateRow,Y4=Z5.footRow,L9=Z5.formulas),O1=(k0=this._getColInfo(u_,r$,Z_)).saveName,X0=k0.align,H7=k0.type,X2=k0.format,Z5=k0.orgFormat,Z_=k0.width,v8=k0.visible,x3=k0.datePattern,t2=k0.formulaRow,k0=k0.colMerge,u_.merge && (I5=this._getExcelMergeInfo(r$,H4,p6,q8,E1,X5,u_.downSum)),n_=n4O,J0=p8.length);n_ < J0;n_++)(T2=n_,-i1f != (I0=this.GetImageList(T2)) && (I0=J._ibsUtil.getFullPath(I0),G6.push(T2 + R6D + I0)));(u_.header && K9S == typeof u_.header && (y5=(D1=this._getTitleConfig(u_.header)).text,w8=D1.align,Y5=D1.height,v_=D1.fontBold,B2=D1.fontColor,I9=D1.fontName,f4=D1.fontSize,Y_=D1.fontUnderline,C8=D1.backColor,U_=D1.border,S6=!n4O),u_.footer && K9S == typeof u_.footer && (M9=(D1=this._getTitleConfig(u_.footer)).text,O_=D1.align,K$=D1.height,J3=D1.fontBold,F2=D1.fontColor,L2=D1.fontName,V9=D1.fontSize,x6=D1.fontUnderline,A9=D1.backColor,q3=D1.border,A5=!n4O),this.ExcelXH=D84,this.ExcelXB=D84,this.ExcelXF=D84,this.fileDownloadCheckToken=new Date().getTime(),J.g_isDown2ExcelBuffer || i1f == u_.useXhr?J.g_isDown2ExcelBufferToken?this.fileDownloadCheckToken=J.g_isDown2ExcelBufferToken:J.g_isDown2ExcelBufferToken=this.fileDownloadCheckToken:J.fileDownloadCheckTimer=Q.setInterval(function(){var G_=Q1._getCookie(j5R);(Q1._getCookie(h2p) && (s.cookie=S6A,Q1.FileDownloadError=!n4O),G_ == Q1.fileDownloadCheckToken && (Q1.fileDownloadCheckToken=D84,Q1._finishDownload()));},b29),B7+=this._makeColumnTag(W0m,this.fileDownloadCheckToken),(Q5=location.href.substring(location.href.indexOf(E2O) + m$I).split(Y6L))[n4O]=z7w,Q5[Q5.length - i1f]=z7w,n4O < u_.excelFontSize && (B7+=this._makeColumnTag(Z0n,u_.excelFontSize)),i1f != u_.sheetDesign && m$I != u_.sheetDesign && c7S != u_.sheetDesign || (B7=(B7=(B7=(B7=(B7+=this._makeColumnTag(y12,this.GetSheetFontName())) + this._makeColumnTag(U7Y,this.GetSheetFontSize())) + this._makeColumnTag(n8L,e$)) + this._makeColumnTag(I93,k6)) + this._makeColumnTag(z$P,headerFontColorInt)),B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7+=this._makeColumnTag(U8A,Q5.join(Y6L))) + this._makeColumnTag(P0n,J._ibsUtil.getFileName(u_.fileName,e2v))) + this._makeColumnTag(I00,u_.extendParam)) + this._makeColumnTag(z4l,u_.excelRowHeight)) + this._makeColumnTag(y1e,u_.sheetName)) + this._makeColumnTag(t5l,u_.downCombo)) + this._makeColumnTag(T0G,u_.reportXML)) + this._makeColumnTag(r63,u_.textToGeneral?i1f:n4O)) + this._makeColumnTag(B0I,u_.wordWrap?i1f:n4O)) + this._makeColumnTag(o_J,u_.autoSizeColumn?i1f:n4O)) + this._makeColumnTag(b0w,X0)) + this._makeColumnTag(Y6_,I5)) + this._makeColumnTag(V7S,u_.merge)) + this._makeColumnTag(j69,O1)) + this._makeColumnTag(J6H,this.g_excelPaletteList)) + this._makeColumnTag(H1I,u0)) + this._makeColumnTag(E1y,H7)) + this._makeColumnTag(U$Q,X2)) + this._makeColumnTag(z5f,Z5)) + this._makeColumnTag(o5T,x3)) + this._makeColumnTag(y0j,t2)) + this._makeColumnTag(w5J,Z_)) + this._makeColumnTag(t5I,V8.join(U7e))) + this._makeColumnTag(k1D,v8)) + this._makeColumnTag(A6$,n4O)) + this._makeColumnTag(b9F,n4O)) + this._makeColumnTag(S1n,u_.downHeader?i1f:n4O)) + this._makeColumnTag(A2g,n4O < u_.sheetDesign && u_.sheetDesign < F$K?u_.sheetDesign:n4O)) + this._makeColumnTag(i17,u_.comboValidation?i1f:n4O)) + this._makeColumnTag(X02,N7.join(E9P))) + this._makeColumnTag(E$f,a0.join(E9P))) + this._makeColumnTag(U8Z,b4.join(E9P))) + this._makeColumnTag(F6Z,Y4.join(E9P))) + this._makeColumnTag(D$v,u_.tempFile)) + this._makeColumnTag(j6A,u_.downRowSpan)) + this._makeColumnTag(b9$,k0),u_.tempFile && (B7=(B7=(B7+=this._makeColumnTag(H1a,u_.sheetNo)) + this._makeColumnTag(l0c,u_.startRow)) + this._makeColumnTag(W5B,u_.startCol)),B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7+=this._makeColumnTag(u$g,this._encodeBase64(u_.workbookPassword))) + this._makeColumnTag(S$x,u_.appendPrevSheet)) + this._makeColumnTag(t7z,u_.numberFormatMode)) + this._makeColumnTag(a8w,G6.join(U7e))) + this._makeColumnTag(o0J,u_.numberExMode?i1f:n4O)) + this._makeColumnTag(Y1$,u_.useFormula?i1f:n4O)) + this._makeColumnTag(n_h,u_.excelHeaderRowHeight)) + this._makeColumnTag(E$v,u_.imageProcessType),S6 || A5?(S6 && (B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7+=this._makeColumnTag(A8M,y5)) + this._makeColumnTag(Y$A,w8)) + this._makeColumnTag(z5o,Y5)) + this._makeColumnTag(S$H,f4)) + this._makeColumnTag(Y_N,v_)) + this._makeColumnTag(L0z,Y_)) + this._makeColumnTag(k1W,I9)) + this._makeColumnTag(b9W,B2 || GetStyle(this.getCell(this.Header,this.GetFirstColA())).color)) + this._makeColumnTag(E_E,C8)) + this._makeColumnTag(c$5,U_)),A5 && (B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7=(B7+=this._makeColumnTag(e$J,M9)) + this._makeColumnTag(r60,O_)) + this._makeColumnTag(N7r,K$)) + this._makeColumnTag(m35,V9)) + this._makeColumnTag(M2C,J3)) + this._makeColumnTag(o1C,x6)) + this._makeColumnTag(c_V,L2)) + this._makeColumnTag(e00,F2)) + this._makeColumnTag(I1d,A9)) + this._makeColumnTag(a5t,q3))):B7=(B7=(B7+=this._makeColumnTag(W5V,u_.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH))) + this._makeColumnTag(u16,u_.titleAlign.toLowerCase())) + this._makeColumnTag(C3q,u_.userMerge));var n5=z7w;if(u_.printSetup && K9S == typeof u_.printSetup){var X4,a8=n4O;for(X4 in u_.printSetup)(n5+=(n4O < a8?U7e:z7w) + (X4.charAt(n4O).toUpperCase() + X4.slice(i1f,X4.length)) + R6D + u_.printSetup[X4] + z7w,a8+=i1f);}B7+=this._makeColumnTag(r_U,n5);var k8=z7w;if(u_.useFormula && n4O < L9.length)for(n_=n4O;n_ < L9.length;n_++)(n4O < n_ && (k8+=l6o),k8=(k8+=L9[n_].SaveName) + (this.IB_DELIMITER_COL + L9[n_].Formula));if((B7+=this._makeColumnTag(m$Y,k8),u_.allTypeToText && (B7+=this._makeColumnTag(I4t,u_.allTypeToText)),B7+=this.IB_DELIMITER_ROW,d8[n4O]=B7,J.g_isDown2ExcelBuffer))(d8[D_++]=this.IB_DELIMITER_SHEET,J.g_down2ExcelBuffer+=d8.join(z7w),J.g_Multipart=u_.multipart);else {if(u_.debugMode)return d8.join(z7w);U3 && U3(d8.join(z7w));}delete this.MergeAllRanges;},q._getExcelMergeInfo=function(p7,y3,k7,R2,H_,g_,W3){var B1,b$,n0,Q3,n$,R6,h8=[],U6={},B_=n4O,Y8=n4O,M6=[],T1={};(this.Rows.FormulaRow && this.Rows.FormulaRow.Visible && this.Rows.FormulaRow.Fixed,this.Rows.Filter.Visible,this.getHeaderRows().length);(this.ExcelCol=[],this.ExcelColMerge=[],M6=this.getCols(),this.Cols[this.RowIndex || L6W].Visible || M6.shift());for(B_=n4O;B_ < M6.length;B_++)T1[M6[B_]]=B_;for((B1=n4O,n0=p7.length);B1 < n0;B1++)(this.ExcelCol.push(o$c + (B1 + i1f)),this.ExcelColMerge.push(p7[B1]?this.Cols[p7[B1]].ColMerge:void n4O),U6[p7[B1]]=B1);if(y3)for((this._excelHeaderMergeRange(),B1=n4O,n0=this.ExcelXH.length);B1 < n0;B1++)if(y0j !== (Q3=this.ExcelXH[B1]).id && J77 != Q3.id)for((b$=n4O,Y8=this.ExcelCol.length);b$ < Y8;b$++){var i5,E8=B1,b8=(i5=this.ExcelCol[b$]).substr(i1f,i5.length) - i1f,f5=Q3[i5 + B6F],B6=Q3[i5 + N75];n4O < f5 && n4O < B6?(h8.push(E8 + E9P + b8),h8.push(E8 + f5 - i1f + E9P + (b8 + B6 - i1f) + U7e)):this.MultiRecord && i1f & this.MultiRecordShape && (i1f < Q3[i5 + B6F] || i1f < Q3[i5 + N75]) && (h8.push(E8 + E9P + b8),h8.push(E8 + (i1f < Q3[i5 + B6F]?Q3[i5 + B6F] - i1f:n4O) + E9P + (b8 + (i1f < Q3[i5 + N75]?Q3[i5 + N75] - i1f:n4O)) + U7e));}if(k7)for((i1f < this.DataRows && S8T == this.DataMergeAction?this._excelDataFixedMergeRange():this._excelDataMergeRange(),B1=n$=n4O,n0=this.ExcelXB.length);B1 < n0;B1++)if(y0j !== (Q3=this.ExcelXB[B1]).id && J77 != Q3.id){for((b$=n4O,Y8=this.ExcelCol.length);b$ < Y8;b$++){(E8=n$ + R2,b8=(i5=this.ExcelCol[b$]).substr(i1f,i5.length) - i1f);(f5=Q3[i5 + B6F],B6=Q3[i5 + N75]);n4O < f5 && n4O < B6?(h8.push(E8 + E9P + b8),h8.push(E8 + f5 - i1f + E9P + (b8 + B6 - i1f) + U7e)):this.MultiRecord && i1f & this.MultiRecordShape && (i1f < f5 || i1f < B6) && (h8.push(E8 + E9P + b8),h8.push(E8 + (i1f < f5?f5 - i1f:n4O) + E9P + (b8 + (i1f < B6?B6 - i1f:n4O)) + U7e));}n$++;}if(W3)if((R6=(R6=n4O) == this.GetAutoSumPosition()?R2 - i1f:this.ExcelXB.length + R2,H_))for((B1=n$=n4O,n0=this.ExcelXF.length);B1 < n0;B1++){for((Q3=this.ExcelXF[B1],b$=n4O,Y8=this.ExcelCol.length);b$ < Y8;b$++)if((E8=n$ + R6,b8=(i5=this.ExcelCol[b$]).substr(i1f,i5.length) - i1f,n4O < Q3[i5 + B6F] && n4O < Q3[i5 + N75])){var O9=Q3[i5 + N75],G9=b8 + O9;if(n4O < Q3[i5 + N75])for(B_=m$I;B_ <= Q3[i5 + N75];B_++){var i3=Q3[o$c + (b8 + B_) + R3b];i3 && i3.substr(i1f,i3.length) > G9 && O9--;}n4O < Q3[i5 + B6F] && n4O < O9?(h8.push(E8 + E9P + b8),h8.push(E8 + Q3[i5 + B6F] - i1f + E9P + (b8 + O9 - i1f) + U7e)):this.MultiRecord && i1f & this.MultiRecordShape && (i1f < Q3[i5 + B6F] || i1f < O9) && (h8.push(E8 + E9P + b8),h8.push(E8 + (i1f < Q3[i5 + B6F]?Q3[i5 + B6F] - i1f:n4O) + E9P + (b8 + (i1f < O9?O9 - i1f:n4O)) + U7e));}n$++;}else for((B1=n$=n4O,n0=this.ExcelXF.length);B1 < n0;B1++){for((Q3=this.ExcelXF[B1],b$=n4O,Y8=this.ExcelCol.length);b$ < Y8;b$++)(E8=n$ + R6,b8=(i5=this.ExcelCol[b$]).substr(i1f,i5.length) - i1f,n4O < Q3[i5 + B6F] && n4O < Q3[i5 + N75]?(h8.push(E8 + E9P + b8),h8.push(E8 + Q3[i5 + B6F] - i1f + E9P + (b8 + Q3[i5 + N75] - i1f) + U7e)):this.MultiRecord && i1f & this.MultiRecordShape && (i1f < Q3[i5 + B6F] || i1f < Q3[i5 + N75]) && (h8.push(E8 + E9P + b8),h8.push(E8 + (i1f < Q3[i5 + B6F]?Q3[i5 + B6F] - i1f:n4O) + E9P + (b8 + (i1f < Q3[i5 + N75]?Q3[i5 + N75] - i1f:n4O)) + U7e)));n$++;}for(B1=n4O;B1 < h8.length;B1+=m$I)h8[B1].replace(/\|/g,z7w) == h8[B1 + i1f].replace(/\|/g,z7w) && h8.splice(B1,m$I);return ((h8=(h8=h8.join(E9P)).replace(/\|\,/g,v4y)) && U7e == h8.substring(h8.length - i1f) && (h8=h8.substring(n4O,h8.length - i1f)),this.ExcelXH=D84,this.ExcelXB=D84,this.ExcelXF=D84,this.ExcelCol=D84,this.ExcelColMerge=D84,h8);},q._getExcelRowHeight=function(c4,y4){c4=this.GetExcelRowHeight(c4,y4);return c4=n4O != c4 && c4 != this.InvalidValue?c4:this.GetDataRowHeight();},q._getMultiRecordNames=function(){for(var C4=z7w,u$=n4O;u$ < this.MultiHeaderMap.length;u$++){for(var g$=this.MultiHeaderMap[u$],G3=z7w,z4=n4O;z4 < g$.length;z4++)(n4O < G3.length && (G3+=this.IB_DELIMITER_COL),G3+=g$[z4]);(n4O < C4.length && (C4+=this.IB_DELIMITER_ROW),C4+=G3);}return C4;},q._getStringExcel=function(u2,j3,i1,R9,L0){var g$g="***";var v_1="g";var v3d="GR";var V7w=/\:/;var p43=/\-|\/|\./;var g_v="CODE";var X6W=/\-/;var l4q="BLANK";var a_,P2=n4O,z1=z7w,y_=z7w,u1=!i1f,X3=this.GetFnLib(N2t),o4=this.getAttribute(u2,j3,B99) || this.getAttribute(u2,j3,O22),q7=this.getType(u2,j3);if(i$B == L0)return g7(this._getCellText(u2,j3));var D9,p0,L0=this.getAttribute(u2,j3,Y$O);if(D84 != L0){if(Y36 == q7)if(!J._ibsUtil.isEmpty(L0) && X3(L0))return (p0=L0.charAt(n4O),L0=L0.split(p0)[i1f],(L0=J._ibsUtil.getFullPath(L0)).replace(new RegExp(J._ibsUtil.escapeRegExp(J._ibsUtil.getDomain()),v_1),z7w));return L0;}if(this._isNumberType(q7) && !R9.numberTypeToText && (y_=this._getCellValue(u2,j3),j3 && j3 == (this.RowIndex || L6W) && !y_ && (!u2.Visible || u2.Hidden?y_=l4q:D84 != this.ExLoadSEQ && (y_=++this.ExLoadSEQ)),y_=g7(y_),this.MainCol !== j3))return y_;if(i1){if(T2J === (q7=q95 == q7 && (this.getAttribute(u2,j3,N4d) || this.getAttribute(u2,j3,V5j))?N4d:q7))return g$g;if((o20 == q7 && (L0=D84,D9=y_=this._getCellValue(u2,j3),(z7w + (o4=(o4=o4 || (this.getAttribute(u2,j3,Y7s) || this.DateFormat || this.getAttribute(u2,j3,X81) || this.DataFormat)) && o4.replace(/[h]/g,e$m))).match(p43) && (L0=o4.replace(/\-|\/|\./gi,z7w),D9=D9.replace(/\-|\/|\./gi,z7w)),D9=J.stringToDate(z7w + D9,y_.match(X6W) || !L0 && D9.match(V7w)?D84:L0 || o4),M8J == typeof (y_=isNaN(D9)?y_:D9) && y_.match(V7w) && (D9=J.stringToDate(y_,B8x),isNaN(D9) || (y_=D9)),M8J == typeof (y_=J.dateToString(y_,o4)) && (y_=this._removeHTMLTag(y_))),e1u === q7))return this.Grouped && this.GroupTreeCols && this.GroupTreeCols[j3] && !u2.Def.Group?z7w:this.Cols[j3] && this.Cols[j3].UseTFValue && (this.Cols[j3].TrueValue || this.Cols[j3].FalseValue)?this.getValue(u2,j3) == this.Cols[j3].TrueValue?R9.checkBoxOnValue || this.Cols[j3].TrueValue:this.getValue(u2,j3) == this.Cols[j3].FalseValue?R9.checkBoxOffValue || this.Cols[j3].FalseValue:R9.checkBoxOffValue || this.Cols[j3].FalseValue || n4O:H7j == this.getValue(u2,j3)?R9.checkBoxOnValue || i1f:R9.checkBoxOffValue || n4O;if((N4d === q7 && (g_v == R9.downCombo?(y_=g7(this._getCellValue(u2,j3)),u1=!n4O):y_=g7(this._getCellText(u2,j3))),Y36 === q7))if((y_=this._getCellText(u2,j3),!J._ibsUtil.isEmpty(y_) && X3(y_)))return (p0=y_.charAt(n4O),y_=y_.split(p0)[i1f],(y_=J._ibsUtil.getFullPath(y_)).replace(new RegExp(J._ibsUtil.escapeRegExp(J._ibsUtil.getDomain()),v_1),z7w));if(m1F === q7)return this._getCellText(u2,j3);if(a6S === q7)return this._removeHTMLTag(this._getCellText(u2,j3));}function g7(H9){return H9=M8J == typeof H9?H9.replace(/[\x00]/g,z7w):H9;}if((n4O == u2.id.indexOf(v3d) && j3 == this.GroupMain && a1V == u2.Kind?(L0=o3s == typeof this.getSpanned?this.getSpanned(u2,j3):this.getMergeRange(u2,j3),y_=this._getCellText(L0[n4O],L0[i1f])):u1 || (y_=this._getCellText(u2,j3)),z7w == y_ && (u2.SubSumRow || u2.CumulateRow) && Y3j == this.Cols[j3].Type))return g7(u2[j3]);if(i1 && this.MainCol == j3){for((P2=n4O,a_=+u2.Level);P2 <= a_;P2++)z1+=this.IB_DELIMITER_TREE_INDENT;y_=z1 + y_;}return g7(y_);},q._sendDown=function(d2,y8,d9,o3,O4,N3,E$,f8,W$,r6,I$,c1){var w9H="IBSheetDown2ExcelFrame";var m5I="IBSheetDown2ExcelFrm";var O4A="load";var m0,j2,J$,r4,W_,D$=w9H,M1=n4O,k_=z7w,b5=!i1f;if((J.g_down2ExcelBuffer=z7w,E$))return (this.hideMessage(),d2 + this.IB_DELIMITER_END);if((Y5T == N3?k_=i1f == J.g_isDirectDown2Excel?m7I:R5Q:W2X == N3?k_=u0p:C9h == N3 && (k_=I6l),W$ || c1 && K9S == typeof c1))this._xhrSendDown(d2 + this.IB_DELIMITER_END,y8,r6,N3,k_,I$,c1,d9,o3);else {if(((j2=s.getElementById(m5I)) && s.body.removeChild(j2),(j2=s.createElement(g48)).id=m5I,j2.method=K1T,O4 && (j2.encoding=Y_p,j2.enctype=Y_p),(J$=s.createElement(a5z)).type=i2O,J$.name=a1V,J$.value=d2 + this.IB_DELIMITER_END,j2.appendChild(J$),o3=void n4O === (o3=void n4O === d9?z7w:o3)?Q2C:o3.toLowerCase(),E$=y8,E$+=(n4O <= y8.indexOf(Z1r)?G3H:Z1r) + D1V + k_,h2M == o3)){if((j2.action=E$,d9))for((W_=d9.split(G3H),M1=n4O);M1 < W_.length;M1++)(r4=(W_[M1] + R6D).split(R6D),(J$=s.createElement(a5z)).type=i2O,J$.name=r4[n4O],J$.value=r4[i1f],j2.appendChild(J$));}else j2.action=E$ + (z7w != d9?G3H:z7w) + d9;((m0=s.createElement(D9r)).name=D$,m0.id=D$,m0.width=d9$,m0.height=d9$,m0.addEventListener(O4A,(function(){f8 && Q.setTimeout((function(){J.fileDownloadCheckTimer && (Q.clearInterval(J.fileDownloadCheckTimer),J.fileDownloadCheckTimer=D84,m0.parentNode.removeChild(m0),this.hideMessage(),this.showMessageTime(this.Lang.Alert.ResultErrUnknown));}).bind(this),f8);}).bind(this)),j2.target=D$,j2.appendChild(m0),s.body.appendChild(j2),j2.style.display=e44,j2.style.width=d9$,j2.style.height=d9$,Q.frames[D$].name=D$,W$=this._checkCrossDomain(y8),(b5=J.OnBeforeDownload?J.OnBeforeDownload(this,N3,j2):b5) || Y5T != N3 || J.OnReadyExcelDown && (b5=J.OnReadyExcelDown(this,j2)),b5 || j2.submit(),!J.fileDownloadCheckTimer || this.fileDownloadCheckToken && !W$ || (Q.clearInterval(J.fileDownloadCheckTimer),J.fileDownloadCheckTimer=D84,this.hideMessage(),!b5 && IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,N3,!n4O)));}},q._xhrSendDown=function(R4,b1,Y0,l$,V3,y2,S$,h1,M_){var U1=this,e4=z7w,x8=new FormData(),W2=!i1f,e4=b1,a$=(e4+=(n4O <= b1.indexOf(Z1r)?G3H:Z1r) + D1V + V3,Q2C == (M_=void n4O === M_ || z7w === M_?Q2C:M_.toLowerCase()) && (e4=e4 + (z7w != h1?G3H:z7w) + h1),y2 && K9S == typeof y2 && Object.keys(y2).forEach(function(D7,K4){x8.append(D7,y2[D7]);}),new XMLHttpRequest());if((a$.open(h2M.toUpperCase(),e4),S$ && K9S == typeof S$ && Object.keys(S$).forEach(function(L3,R0){a$.setRequestHeader(L3,S$[L3]);}),a$.responseType=r5O,a$.onload=function(b_){var D9m="#tempAnchor";var K9h="Content-Disposition";var w4s=/^"/;var V38="text/html";var D6m="filename";var E53=/"$/;var R3z="tempAnchor";V38 == a$.response.type && (s.cookie=S6A,(J6=new FileReader()).onload=function(){(U1.FileDownloadError=!n4O,U1.fileDownloadCheckToken=D84,U1._finishDownload(l$));var U9=J6.result;M({data:U9.substring(U9.indexOf(v0r) + y3I,U9.indexOf(F97) - S8T).replace(/\\'/g,V$7).replace(/\\n/g,g5k)});},J6.readAsText(a$.response));for(var J6,K8,L$=a$.getResponseHeader(K9h).split(C7z),B5=n4O;B5 < L$.length;B5++)n4O <= L$[B5].indexOf(D6m) && (m$I == (K8=L$[B5].split(R6D)).length && z7w != K8[B5] && (g1C === K8[i1f].charAt(n4O) && g1C === K8[i1f].charAt(K8[i1f].length - i1f) && (K8[i1f]=K8[i1f].replace(w4s,z7w).replace(E53,z7w)),Y0=decodeURI(K8[i1f])));var V$,v3=a$.response;V38 != v3.type && (IBSheet.BIEA10 || IBSheet.BIEA11?Q.navigator.msSaveBlob(v3,Y0):(v3=URL.createObjectURL(v3),V$=D84,(V$=s.querySelector(D9m)?s.querySelector(D9m):s.createElement(c9s)).id=R3z,V$.style.display=e44,s.body.append(V$),V$.href=v3,V$.download=Y0,V$.click(),V$.href=z7w,V$.download=z7w,URL.revokeObjectURL(e4),U1.fileDownloadCheckToken=D84,U1._finishDownload(l$)));},a$.onerror=function(q1){return (s.cookie=S6A,U1.FileDownloadError=!n4O,U1.fileDownloadCheckToken=D84,U1._finishDownload(l$),alert(e7c),!i1f);},x8.append(a1V,R4),h2M == M_ && h1))for((params=h1.split(G3H),i=n4O);i < params.length;i++)(pvs=(params[i] + R6D).split(R6D),x8.append(pvs[n4O],pvs[i1f]));J.OnBeforeDownload && (W2=J.OnBeforeDownload(this,l$,x8));try{W2?this.hideMessage():a$.send(x8);}catch(E3){}},q.Down2Hml=function(E4){var d$z="landscape";var b8h="_IBSheet";var J1N="Down2Hml.jsp";var z_,p3=this,N5=z7w,m5=z7w,H5=d16;return (this.showMessage(this.getMessage(P$b)),E4=J._ibsUtil.cloneArray(E4),z_=this.Down2HmlConfig || ({}),this._prepareExportSetting(),K9S == typeof E4.title && (m5=E4.title.text,H5=E4.title.align),E4.title || K9S != typeof E4.Title || (m5=E4.Title.Text,H5=E4.Title.Align),E4.docOrientation=this._getDefault(E4.docOrientation || E4.DocOrientation,z_.docOrientation || E7Y),E4.downCols=this._getDefault(E4.downCols || E4.DownCols,z_.downCols || z7w),E4.downSum=this._getDefault(E4.downSum || E4.DownSum,z_.downSum || i1f),E4.extendParam=this._getDefault(E4.extendParam || E4.ExtendParam,z_.extendParam || z7w),E4.fileName=this._getDefault(E4.fileName || E4.FileName,z_.fileName || b8h),E4.titleAlign=this._getDefault(H5,z_.titleAlign || d16),E4.titleText=this._getDefault(m5,z_.titleText || z7w),d$z !== E4.docOrientation.toLowerCase() && (E4.docOrientation=E7Y),E4.downTreeHide=!i1f,N5=void n4O !== this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:J1N,this._getDown2Hml(E4,function(o9){p3._sendDown(o9,N5,E4.extendParam,h2M,i1f,i$B);}));},q.GetDown2HmlUrl=function(){var j7=z7w;return j7=this.Source.Down2Hml.Url?this.Source.Down2Hml.Url:j7;},q.SetDown2HmlUrl=function(m1){(this.Source.Down2Hml || (this.Source.Down2Hml={}),this.Source.Down2Hml.Url=m1);},q._getDown2Hml=function(m3,Y2){var G5T="DocOrientation";var a5d="hml";var t_,s5,u4,X$,D5,X8,W4=[],Y$=[],Z2=z7w,v4=z7w,d3=this,d7={};return n4O == (X8=(D5=this._getDownColNames(m3)).length)?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,i$B,!i1f),-i1f):(X8=this._getHeaderData(d7={from:i$B,cfg:m3,sheetDesign:n4O,isTreeLevel:n4O,isDownRows:n4O,isDownRowVisible:n4O,rowHeights:[],downColNames:D5,downColNamesLength:X8,data:W4,p:i1f,headerRows:n4O,isHeaderMerge:n4O}),d7.p=X8.p,X8.p,d7.headerRows=X8.headerRows,t_=X8.headerRows,(X8=this._getBodyData(d7)).p,W4=X8.data,Y$=X8.rowHeights,X8=(d7=this._getColInfo(m3,D5,n4O)).type,D5=d7.format,s5=d7.orgFormat,X$=d7.width,u4=d7.align,d7=d7.datePattern,this.fileDownloadCheckToken=new Date().getTime(),i1f != m3.useXhr && (J.fileDownloadCheckTimer=Q.setInterval(function(){d3._getCookie(j5R) == d3.fileDownloadCheckToken && (d3.fileDownloadCheckToken=D84,d3._finishDownload(i$B));},b29)),Z2+=this._makeColumnTag(W0m,this.fileDownloadCheckToken),(v4=location.href.substring(location.href.indexOf(E2O) + m$I).split(Y6L))[n4O]=z7w,v4[v4.length - i1f]=z7w,Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2=(Z2+=this._makeColumnTag(U8A,v4.join(Y6L))) + this._makeColumnTag(P0n,J._ibsUtil.getFileName(m3.fileName,a5d))) + this._makeColumnTag(I00,m3.extendParam)) + this._makeColumnTag(H1I,t_)) + this._makeColumnTag(E1y,X8)) + this._makeColumnTag(U$Q,D5)) + this._makeColumnTag(z5f,s5)) + this._makeColumnTag(o5T,d7)) + this._makeColumnTag(b0w,u4)) + this._makeColumnTag(w5J,X$)) + this._makeColumnTag(t5I,Y$.join(U7e))) + this._makeColumnTag(W5V,m3.titleText.replace(/\r\n/g,this.IB_DELIMITER_TITLE_NEWLINE).replace(/\|/g,this.IB_DELIMITER_TITLE_BACKSLASH))) + this._makeColumnTag(u16,m3.titleAlign.toLowerCase())) + this._makeColumnTag(G5T,m3.docOrientation.toLowerCase())) + this.IB_DELIMITER_ROW,W4[n4O]=Z2,m3.debugMode || m3.DebugMode?(this.hideMessage(),W4.join(z7w)):void (o3s == typeof Y2 && Y2(W4.join(z7w))));},q.Down2Pdf=function(V6){var f6$="converter";var h7p="wkhtmltopdf";var n5Y="clone";var A9O="itextpdf";var O$E="unset";V6=V6 || ({});var V4=this.GetFnLib(n5Y),g9=this.GetFnLib(Q2C),y9=this.GetFnLib(d1M),F9=this.GetFnLib(O$E),V4=V4(V6) || ({}),g9=g9(V4,f6$) || A9O;return (F9(V4,f6$),F9=h7p === g9?this.GetWKHtml2PDF(V4):this.GetITextHtml2PDF(V4),V4.finish=F9,y9(V6=new Object(),x7p,V4),this.doPrint(V6));},q.GetDown2PdfUrl=function(){var G$=z7w;return G$=this.Source.Down2Pdf.Url?this.Source.Down2Pdf.Url:G$;},q.GetITextHtml2PDF=function(c9){var u_W="ExtendParamMethod";var u6d="fileName";var E$K=32800;var q_9="extendParamMethod";var J4g="FontTo";var h_m="dpi";var U8b="TitleStyle";var x7c="URL";function w6(R1,s_,l5){return v1d + s_ + (l5=D84 != l5?v4y + (l5=z$(l5)?l5.join(v4y).replace(/\s+/g,v4y):l5):z7w) + B1Z + R1 + B6Q + s_ + B1Z;}var L48="useXhr";function C7(X_,U4,U5){return d$(X_,U4)?l3(X_,U4):D84 != U5?U5:void n4O;}var W3s="ExtendParam]";var M7J="wordWrap";var G8A="sendParam";var D$B="downCols";var B3t="UseXhr";var H9I="ReqHeader";function b9(Y9){var f9=C7(Y9,M2$),a5=D4([W73,[m2Q,p5z]],function(t4){W1(t4) && (t4=[t4,t4]);var A7=C7(f9,t4[n4O]);return D84 == A7?z7w:(z$(A7) && (A7=A7.join(v4y)),t4[i1f] + O8u + A7 + g1C);}),g1=(function(){var R$d='style="font-family:';var b0=x$(h79);if(D84 == b0)return z7w;var a4=x$(Y_M,z7w);return w6(b0,T6y,[R$d + T9 + C7z + a4 + g1C]) + h1y;})(),Y9=C7(Y9,m3T,z7w);return w6(g1+=Y9=Y9.length?Y9.replace(new RegExp(p2A,Z4B),h1y).replace(new RegExp(y1H,Z4B),v4y).replace(new RegExp(n0v,Z4B),m3L).replace(new RegExp(A8.Style + j4s,Z4B),z7w).replace(new RegExp(A8.Style + c2N,Z4B),z7w):Y9,X0J,a5);}var E0t="mode";var i_k=50;var h79="title";var Y_M="titleStyle";var v7p="Paper";var p0T="DownCols";var r25="paper";var a_f=2e3;var O$b="Title";var i63="Dpi";var E4f="reqHeader";var d8D="DPI";function x$(U$,P7){return C7(c9,U$,P7);}var u0t="SendParam";var A8=this,l3=this.GetFnLib(Q2C),C0=this.GetFnLib(d1M),d$=this.GetFnLib(n2h),s7=this.GetFnLib(d1o),W1=this.GetFnLib(N2t),z$=this.GetFnLib(J92),D4=this.GetFnLib(W5Z),L8=this.GetFnLib(u8e),D6=this.GetFnLib(T1l),N1=this.GetFnLib(g5t);for(var g2=new Object(),b7=(A8._prepareExportSetting(),D84 == c9 && (c9={FileName:C56,objReturn:i1f}),s7([[D$B,p0T],[E0t,p87],[M7J,B0I],[r25,v7p],[u6d,P0n],[h_m,i63,d8D],[D$o,J4g],[h79,O$b],[Y_M,U8b],[G3g,V0H,x7c],[q_9,u_W],[h88,W3s],[L48,B3t],[E4f,H9I],[G8A,u0t]],function(C1){for(var c3,v6=i1f;v6 < C1.length;v6+=i1f)(c3=C1[v6],d$(c9,c3) && (c9[C1[n4O]]=c9[c3]));}),d$(c9,O8O) && c9.debugMode),e9=(b7 && this.showMessage(this.getMessage(P$b)),d$(c9,E0t) || (c9.mode=n4O),d$(c9,D$B) || (c9.downCols=z7w),A8.getCols()),i0=A8._getDownColNames(c9),w$=n4O;w$ < e9.length;w$++){g2[e9[w$]]=!i1f;for(var i6=n4O;i6 < i0.length;i6++)if(e9[w$] === i0[i6]){g2[e9[w$]]=!n4O;break;}}C0(c9,D$B,g2);var s7=x$(M7J),s7=A8._getBooleanValue(s7,n4O),S8=(C0(c9,M7J,s7),A8.PdfWordWrap=s7?i1f:n4O,x$(u6d,C56)),K_=a_f,f2=(d$(c9,h_m) && (K_=(K_=A8._getNumberValue(c9.dpi,K_)) < i_k?i_k:E$K < K_?E$K:K_),E7Y),T9=(d$(c9,r25) && (f2=c9.paper?c9.paper.toLowerCase():E7Y),K0W);d$(c9,D$o) && (C0=T9,s7=(s7=x$(D$o)) && N1(s7),D6=D6(N1={gulim:K0W,gothic:O66}),T9=L8(D6,s7)?N1[s7]:C0);return function(O8){var h2a="Orientation";(b7 || A8.showMessage(A8.getMessage(P$b)),A8.fileDownloadCheckToken=new Date().getTime(),J.fileDownloadCheckTimer=setInterval(function(){var I3=A8._getCookie(j5R);(A8._getCookie(h2p) && (s.cookie=S6A,A8.FileDownloadError=!n4O),I3 == A8.fileDownloadCheckToken && (A8.fileDownloadCheckToken=D84,A8._finishDownload(C9h)));},b29));var E9=J._ibsUtil.getFileName,o7=A8._makeColumnTag,D2=D4([[W0m,A8.fileDownloadCheckToken],[P0n,E9(S8,x7p)],[d8D,K_],[h2a,f2]],function(C5){return o7.apply(A8,C5);}),O8=(D2+=A8.IB_DELIMITER_ROW,w6([(function(D3){return (D3=D3 || z7w,w6(D3+=m16 + T9 + a8D,o86));})(O8.head || z7w),b9(O8.body || D84)].join(S$4),m3T,C92)),D2=[D2,O8].join(S$4);if(b7)return (A8.hideMessage(),D2);var O8=x$(G3g,A8.Source.Down2Pdf.Url),n4=x$(h88,z7w),L_=x$(q_9,h2M).toLowerCase(),C$=x$(L48,!i1f),E9=E9(S8,x7p),t0=x$(G8A,D84),F4=x$(E4f,D84);return A8._sendDown(D2,O8,n4,L_,!n4O,C9h,b7,D84,C$,E9,t0,F4);};},q.GetWKHtml2PDF=function(r7){function s4(L5,g6){return v5(r7,L5,g6);}var m38="export/wkhtml2pdf.jsp";var g_L="DebugMode";var x4H="ibleaders/v8";function v5(h2,N4,O3){return F3(h2,N4)?O2(h2,N4):D84 != O3?O3:void n4O;}function T$(b2,l_,G7){return v1d + l_ + (G7=D84 != G7?v4y + (G7=f7(G7)?G7.join(v4y).replace(/\s+/g,v4y):G7):z7w) + B1Z + b2 + B6Q + l_ + B1Z;}var z__="https://api.ibleaders.com";var n8=this,C2=m38,B0=[z__,x4H,C2].join(Y6L),w2=C56,O2=this.GetFnLib(Q2C),A3=this.GetFnLib(d1M),F3=this.GetFnLib(n2h),Z6=this.GetFnLib(d1o),c$=this.GetFnLib(N2t),f7=this.GetFnLib(J92),S0=this.GetFnLib(W5Z),z9=this.GetFnLib(u8e),L7=this.GetFnLib(T1l),j4=this.GetFnLib(g5t);(n8._prepareExportSetting(),F3(r7,O8O) || F3(r7,g_L));var S3,Q6,j0=K0W;F3(r7,D$o) && (S3=j0,Q6=(Q6=s4(D$o)) && j4(Q6),L7=L7(j4={gulim:K0W,gothic:O66}),j0=z9(L7,Q6)?j4[Q6]:S3);return function(Y1){var g1v="application/x-www-form-urlencoded";var W8h=96;var J1D="PDFPageSize";var u2h="PDFFormat";var L0U="PrintMarginWidth";var X57="PDFPageOrientation";var K$U="PDFName";var X7f="Content-Type";var z7X="PrintDPI";var s$z="File";var p4T=/Down2Pdf\.jsp$/;var k3E="PrintMarginHeight";var V0b=40;(n8.fileDownloadCheckToken=new Date().getTime(),J.fileDownloadCheckTimer=setInterval(function(){var X6=n8._getCookie(j5R);(n8._getCookie(h2p) && (s.cookie=S6A,n8.FileDownloadError=!n4O),X6 == n8.fileDownloadCheckToken && (n8.fileDownloadCheckToken=D84,n8._finishDownload(C9h)));},b29));var Z4=s4(G3g),d0=(D84 == Z4 && (Z4=v5(n8.Source.Down2Pdf,V0H,B0),p4T.test(Z4) && (Z4=Z4.replace(p4T,C2))),s4(h88,{})),n6=(Z6([{name:K$U,defaultValue:w2},{name:s$z,defaultValue:w2},{name:u2h,defaultValue:x7p},{name:J1D,defaultValue:B2V},{name:X57,defaultValue:n4O},{name:L0U,defaultValue:V0b},{name:k3E,defaultValue:V0b},{name:z7X,defaultValue:W8h}],function(W9){var k4=W9.name;F3(d0,k4) || A3(d0,k4,W9.defaultValue);}),T$([(Y1.head,n6=z7w,T$(n6+=m16 + j0 + a8D,o86)),(function(j1){var a9=v5(j1,M2$),f0=S0([W73,[m2Q,p5z]],function(a7){c$(a7) && (a7=[a7,a7]);var a3=v5(a9,a7[n4O]);return D84 == a3?z7w:(f7(a3) && (a3=a3.join(v4y)),a7[i1f] + O8u + a3 + g1C);});return T$(j1=(j1=v5(j1,m3T,z7w)).length?j1.replace(new RegExp(p2A,Z4B),h1y).replace(new RegExp(y1H,Z4B),v4y).replace(new RegExp(n0v,Z4B),m3L).replace(new RegExp(n8.Style + j4s,Z4B),z7w).replace(new RegExp(n8.Style + c2N,Z4B),z7w):j1,X0J,f0);})(Y1.body || D84)].join(S$4),m3T,C92)),w1=(d0.Data=n6,new XMLHttpRequest());(w1.open(h2M.toUpperCase(),Z4),w1.setRequestHeader(X7f,g1v),w1.responseType=r5O,w1.onload=function(){var D98=".pdf";var Q6f=200;var B$,u6;Q6f === w1.status && (B$=w1.response,(u6=s.createElement(c9s)).href=Q.URL.createObjectURL(B$),u6.download=d0.File + D98,u6.click());});try{w1.send((function(J5){var L4,h4=z7w;for(L4 in J5)J5.hasOwnProperty(L4) && (n4O < h4.length && (h4+=G3H),h4+=encodeURI(L4 + R6D + J5[L4]));return h4;})(d0));}catch(m_){}};},q.SetDown2PdfUrl=function(Z9){(this.Source.Down2Pdf || (this.Source.Down2Pdf={}),this.Source.Down2Pdf.Url=Z9);},q._autoExcelModeCheck=function(j5,c8,k1,O0,J4,q0){var U$2="txt|csv";var d4L=".csv";var z8i=".txt";var P5b="xls|xlsx";var c3U="xls|xlsx|txt|csv";var R5=!i1f;if((i1f == (c8=this._getNumberValue(c8,i1f,n4O,i1f,S8T)) && (R5=!n4O),void n4O === j5 && (j5={}),O0)){if(m$I == c8 || S8T == c8)if(J4 || S8T != c8 || y0m != typeof JSZip){if(void n4O !== q0)return !i1f;if(Y5T == k1){if(J4)return !n4O;this.exportData(j5);}else W2X == k1 && (-i1f == j5.fileName.indexOf(z8i) && -i1f == j5.fileName.indexOf(d4L) && (j5.fileName=j5.fileName.concat(z8i)),this.exportData(j5));}else J.BIEA && !J.BIEA10?R5=!n4O:Y5T == k1?this.exportData(j5):W2X == k1 && (-i1f == j5.fileName.indexOf(z8i) && -i1f == j5.fileName.indexOf(d4L) && (j5.fileName=j5.fileName.concat(z8i)),this.exportData(j5));}else (z7w != (O0=j5.fileExt) && void n4O !== O0 || (Y5T == k1?j5.fileExt=P5b:W2X == k1?j5.fileExt=U$2:j$y == k1 && (j5.fileExt=c3U)),m$I != c8 && S8T != c8 || (S8T == c8 && y0m == typeof JSZip?J.BIEA && !J.BIEA10?R5=!n4O:this.importData(j5):J4 || Y5T != k1 && W2X != k1 && j$y != k1 || this.importData(j5)));return R5;},q._boolFormatter=function(W7,U2,s1,h9){return (i1f == h9?(H7j == s1?s1=i1f:S9$ == s1 && (s1=n4O),s1=this._getBooleanValue(s1,n4O)):n4O == h9 && (s1 + z7w == H7j?s1=H7j:s1 + z7w == S9$ && (s1=S9$)),s1);},q._checkCrossDomain=function(I8){var r9$="http://";var B10="https://";var g4Y="localhost";var E5=!i1f,S9=g4Y,G4=s.location;return (I8 && (n4O != I8.toLowerCase().indexOf(r9$) && n4O != I8.toLowerCase().indexOf(B10) || (G4 && (S9=G4.protocol + E2O + G4.host),((G4=I8.split(Y6L))[n4O] + E2O + G4[m$I]).toLowerCase() != S9.toLowerCase() && (E5=!n4O))),E5);},q._encodeBase64=function(v0){var u7=z7w;return u7=void n4O !== v0?btoa(encodeURIComponent(v0).replace(/%([0-9A-F]{2})/g,function(H3,Q9){var c9b="0x";return String.fromCharCode(c9b + Q9);})):u7;},q._exportJson=function(q6,X1,z5,F7){var A2m="#Edit";var T0y="FontStrike";var A3z="Edit";var H9P="#BackColor";var q2u="FontItalic";var k34="FontUnderline";var q7_="#FontColor";var P$f="FontBold";for(var x5,q$,Z1,I6={data:[]},P$=D84,m6=n4O,J2={},S5=z7w,L6=i1f < this.DataRows,n2=[P$f,q2u,k34,T0y],I2=n4O,f$=n2.length,P$=this.getFirstRow(D84,B2V);P$;P$=this.getNextRow(P$))if(!P$ || y0j !== P$.id && M8T !== P$.Name && U8Z !== P$.Name){for((m6=n4O,x5=q6.length);m6 < x5;m6++){if((q$=q6[m6],!L6 || P$.UnitPos == q$.UnitPos)){if((Z1=q$.Name,S5=X1?this._getCellText(P$,Z1):this._getCellValue(P$,Z1),q$.Name === F7 && i1f != S5))break;if((J2[Z1]=S5,z5))for((this._getBooleanValue(P$[Z1 + A3z],i1f) || (J2[Z1 + A2m]=n4O),P$[Z1 + r6s] && (J2[Z1 + H9P]=P$[Z1 + r6s]),P$[Z1 + u4$] && (J2[Z1 + q7_]=P$[Z1 + u4$]),I2=n4O);I2 < f$;I2++)P$[Z1 + n2[I2]] && (J2[Z1 + l6o + n2[I2]]=i1f);}z5 && (this._getBooleanValue(P$.RowEdit,i1f) || (J2.Edit=n4O),P$.Background && (J2.BackColor=P$.Background),P$.Color && (J2.FontColor=P$.Color));}L6 && P$.UnitPos != this.DataRows - i1f || n4O < Object.keys(J2).length && (I6.data.push(J2),J2={});}return I6;},q._exportXml=function(P3,F5,M8){var V3x="<![CDATA[";var F1m="<row>";var v$v="]]>";var Q_i="</data>";var J04="<data>";var m0t='<?xml version="1.0" encoding="UTF-8" ?>\r\n';var P5C="</row>";var k5,p5,e5=[],G8=D84,r8=n4O,n9=z7w,Q8=i1f < this.DataRows;for((e5.push(J04),G8=this.getFirstRow(D84,B2V));G8;G8=this.getNext(Rowr))if(!G8 || y0j !== G8.id && M8T !== G8.Name && U8Z !== G8.Name){for((Q8 && n4O != G8.UnitPos || e5.push(F1m),r8=n4O,k5=P3.length);r8 < k5;r8++)if((p5=P3[r8],!Q8 || G8.UnitPos == p5.UnitPos)){if((n9=F5?this._getCellText(G8,p5.Name):this._getCellValue(G8,p5.Name),p5.Name === M8 && i1f != n9))break;(e5.push(v1d + p5.Name + B1Z),_ibsUtil.isEmpty(n9) || e5.push(V3x + n9 + v$v),e5.push(B6Q + p5.Name + B1Z));}Q8 && G8.UnitPos != this.DataRows - i1f || P5C != e5[e5.length - i1f] && e5.push(P5C);}return (e5.push(Q_i),e5=m0t + e5.join(z7w));},q._finishDownload=function(R3){var I7f="; path=/";var V4A="fileDownloadToken=; expires=";if((R3=R3 || Y5T,Q.clearInterval(J.fileDownloadCheckTimer),J.fileDownloadCheckTimer=D84,J.g_down2ExcelSheetID.length)){for(var j8=n4O;j8 < J.g_down2ExcelSheetID.length;j8++)J[J.g_down2ExcelSheetID[j8]].hideMessage();J.g_down2ExcelSheetID=[];}else this.hideMessage();(IBSheet.OnDownFinish && !this.FileDownloadError && IBSheet.OnDownFinish(this,R3,!n4O),(R3=new Date()).setDate(R3.getDate() - i1f),s.cookie=V4A + R3.toGMTString() + I7f);},q._getAlignByType=function(O5){var L80="right";return this._isBooleanType(O5)?d16:this._isNumberType(O5)?L80:k12;},q._getBodyData=function(j5h){var C0Y="Align";var D7T="Spanned";var f6y="isNull";var N$,d5,T6,M6$,N57,E7,K6,h9b,G98,F$u,M_3,i7,V5,e79=[],S_A=[],y4j=z7w,P02=z7w,N5Z=z7w,j6p=z7w,S_v=j5h.from,g4=j5h.cfg,f$I=j5h.sheetDesign,x7i=j5h.isTreeLevel,p_P=j5h.isDownRows,i7w=j5h.isDownRowVisible,V9C=j5h.rowHeights,h_Z=j5h.downColNames,w9X=j5h.downColNamesLength,m6S=j5h.data,b52=j5h.p,Q0R=j5h.headerRows,W08=[],W2a=[],S_I=[],e3F=[],e4y=n4O,s3=[],y5$=[],u2_=n4O,E$P=n4O,q3L=[],l5M=z7w,M5F={},P0e=j5h.isSameDownColAndVisible,G39=this.getCols(),P07=this.GetFnLib(V2f),j5h=this.GetFnLib(f6y),A2t=this.Cols[this.RowIndex || L6W],U1u=this.MergeAllRanges?l$K:B6F,E_q=this.MergeAllRanges?u_Q:N75;if(!A2t.Visible && A2t.Def && h_4 === A2t.Def)for(var t77=n4O;t77 < G39.length;t77++)if(G39[t77] === (this.RowIndex || L6W)){G39.splice(t77,i1f);break;}for((N$=n4O,F$u=h_Z.length);N$ < F$u;N$++)M5F[h_Z[N$]]=N$;if(g4.downSum){if(this.Rows.FormulaRow){for((T6=this.Rows.FormulaRow,N$=n4O);N$ < this.DataRows && (T6 && T6.Visible);N$++){for((n4O == this.FormulaRowPosition && (Q0R++,W08.push(e4y++)),S_A.push(this._getExcelRowHeight(T6,N$)),Y5T == S_v && this._setRowProperty(K6={},T6),h9b=[],d5=n4O);d5 < w9X;d5++)if((V5=(this.MultiRecord && i1f & this.MultiRecordShape?this._DownMultiMap[N$]:h_Z)[d5]) && Z3t != V5){if((E7=void n4O === T6[V5]?z7w:this._getStringExcel(T6,V5,!i1f,g4,S_v),P02=this._addCellColor(f$I,T6,V5),N5Z=this._addCellFontColor(f$I,T6,V5),N57=E7=y0m !== (E7=W2X == S_v?(E7 + z7w).replace(/\r\n|\n|\r/g,z7w):E7) && void n4O !== E7?E7:z7w,z7w != P02 && (N57+=P02),z7w != N5Z)){for(var z_g=n4O;z_g < (z7w != P02?F$K:Q$v);z_g++)N57+=this.IB_DELIMITER_COLOR;N57+=N5Z;}(this.MultiRecord && i1f & this.MultiRecordShape?h9b[d5]=N57:h9b.push(N57),Y5T == S_v && (G98=o$c + ((this.MultiRecord && i1f & this.MultiRecordShape?d5:M5F[V5]) + i1f),y4j=this.Cols[V5].Type,void n4O === this._getNumberValue(E7) && (y4j=Y3j),this._setRowData(K6,G98,V5,E7,y4j),j6p=P0e?T6[V5 + N75]:i1f,K6[G98 + B6F]=this.MultiRecord && i1f & this.MultiRecordShape && D84 != this.Cols[V5].RecordRowSpan?this.Cols[V5].RecordRowSpan:T6[V5 + B6F],K6[G98 + N75]=this.MultiRecord && i1f & this.MultiRecordShape && D84 != this.Cols[V5].RecordColSpan?this.Cols[V5].RecordColSpan:j6p,K6[V5 + B6F]=this.MultiRecord && i1f & this.MultiRecordShape && D84 != this.Cols[V5].RecordRowSpan?this.Cols[V5].RecordRowSpan:T6[V5 + B6F],K6[V5 + N75]=this.MultiRecord && i1f & this.MultiRecordShape && D84 != this.Cols[V5].RecordColSpan?this.Cols[V5].RecordColSpan:j6p));}(e79.push(h9b.join(this.IB_DELIMITER_COL)),Y5T == S_v && this.ExcelXF.push(K6));}T6=this.getNextRow(T6);}n4O < e79.length && n4O == this.FormulaRowPosition && (m6S[b52++]=e79.join(this.IB_DELIMITER_ROW),m6S[b52++]=this.IB_DELIMITER_ROW,V9C=S_A.concat(V9C));}if((void n4O !== g4.ExcludeFooterRow && (g4.excludeFooterRow=g4.ExcludeFooterRow),!g4.excludeFooterRow))for((j5h(this.ExLoadSEQ) || delete this.ExLoadSEQ,s3=this.XF.firstChild);s3;s3=s3.nextSibling)if(y0j != s3.id)for(N$=n4O;N$ < this.DataRows;N$++){for((S_A.push(this._getExcelRowHeight(s3,N$)),footerRowData=[],d5=n4O);d5 < w9X;d5++)Z3t != (V5=(this.MultiRecord && i1f & this.MultiRecordShape?(this.MultiFootMerge?this._DownMultiFootMap:this._DownMultiMap)[N$]:h_Z)[d5]) && (!V5 && this.MultiRecord && i1f & this.MultiRecordShape?u2_=this.IB_DELIMITER_COLOR + this.IB_DELIMITER_COLOR + this.IB_DELIMITER_COLOR + this.IB_DELIMITER_COLOR + this.IB_DELIMITER_COLOR + H7j + this.IB_DELIMITER_COLOR:(u2_=i7=this._getStringExcel(s3,V5,!i1f,g4,S_v),W2X == S_v && (i7=(i7 + z7w).replace(/\r\n|\n|\r/g,z7w)),Y5T == S_v && (y4j=s3[V5 + o$q] || this.Cols[V5].Type,void n4O === this._getNumberValue(i7) && (y4j=Y3j),u2_=(u2_+=i1f == f$I && z7w != (i7=this._addCellColor(f$I,s3,V5))?i7:this.IB_DELIMITER_COLOR) + (z7w != y4j?y4j=this.IB_DELIMITER_COLOR + y4j:this.IB_DELIMITER_COLOR),u2_+=(i7=s3[V5 + C0Y] || s3.Def.Align || this.Cols[V5].Align) && y0m != i7?this.IB_DELIMITER_COLOR + i7:this.IB_DELIMITER_COLOR,this.MultiRecord && i1f & this.MultiRecordShape?u2_+=this.IB_DELIMITER_COLOR + (this.MultiFootMerge && s3[V5 + i2R]?s3[V5 + i2R]:this.Cols[V5].RecordRowSpan || z7w):void n4O !== s3[V5 + B6F] && (z7w == g4.downCols || U0n == g4.downCols) && this.getAttribute(D84,V5,D7T) && n4O < s3[V5 + N75]?u2_+=this.IB_DELIMITER_COLOR + s3[V5 + B6F]:u2_+=this.IB_DELIMITER_COLOR,i7=s3[V5 + N75] || s3.Def[V5 + N75] || this.Cols[V5].Span,this.MultiRecord && i1f & this.MultiRecordShape?u2_+=j6p=this.IB_DELIMITER_COLOR + (this.MultiFootMerge && s3[V5 + f3y]?s3[V5 + f3y]:this.Cols[V5].RecordColSpan || i1f):void n4O === i7 || z7w != g4.downCols && U0n != g4.downCols || !this.getAttribute(s3,D84,D7T)?u2_+=this.IB_DELIMITER_COLOR + i1f:u2_+=j6p=this.IB_DELIMITER_COLOR + i7,i7=s3[V5 + O22] || this.Cols[V5].LegacyFormat || this.Cols[V5].Format,void n4O !== (i7=o20 != y4j || i7?i7:this.Cols[V5].DateFormat || this.Cols[V5].DataFormat) && z7w != i7 && K9S != typeof i7?(n4O <= y4j.indexOf(q31) && (i1f < (M_3=i7.split(I9E)).length && l6o == M_3[i1f].charAt(n4O) && (M_3[i1f]=S9$ + M_3[i1f].slice(i1f),i7=M_3.join(I9E))),u2_+=this.IB_DELIMITER_COLOR + i7):u2_+=this.IB_DELIMITER_COLOR,u2_+=i1f == f$I?N5Z=this._addCellFontColor(f$I,s3,V5):this.IB_DELIMITER_COLOR)),footerRowData.push(u2_));(y5$.push(footerRowData.join(this.IB_DELIMITER_COL)),E$P++);}var f6K=n4O,y8U=g4.downRows && g4.downRows.split(U7e);for((this.ExLoadSEQ=n4O,T6=this.getFirstRow(D84,B2V));T6;T6=this.getNextRow(T6))if((g4.downTreeHide || n4O == g4.downTreeHide && this._getTreeVisible(T6)) && (f6K++,!p_P || -i1f < y8U.indexOf(z7w + f6K) || i7w && T6.Visible))for(var l7=n4O;l7 < this.DataRows;l7++)if(!(i1f == g4.excludeSubSum && M8T === T6.Name || m$I == g4.excludeSubSum && T6.CumulateRow || S8T == g4.excludeSubSum && (M8T === T6.Name || T6.CumulateRow))){for((Y5T != S_v && i$B != S_v || V9C.push(this._getExcelRowHeight(T6,l7)),Y5T == S_v && (this._setRowProperty(K6={},T6,this.GetStatusValue(T6)),M8T === T6.Name?W2a.push(e4y++):T6.CumulateRow?S_I.push(e4y++):e4y++),h9b=new Array(w9X),d5=n4O);d5 < G39.length;d5++){var e01=M5F[G39[d5]];if(!(Y5T != S_v || this.MultiRecord && i1f & this.MultiRecordShape || this.MergeAllRanges && (n4O != this.SearchMode || M8T != T6.Name) || G39.length == w9X)){var v0m=T6[G39[d5] + (n4O == this.SearchMode && M8T == T6.Name?N75:E_q)],t6F=v0m;if(!P07(e01)){if(i1f < v0m){for(var l5u=D84,l7=n4O;l7 < v0m;l7++)this.Cols[G39[d5 + l7]].Visible?(l5u=l5u || l7,this.ExLoad && !T6[V5 + l$K] && (K6[G39[d5 + l7] + B6F]=T6[G39[d5] + B6F])):--t6F;K6[G39[d5 + l5u] + N75]=t6F;}continue;}if(P07(e01))if(!P0e && g4.downCols && U0n != g4.downCols)K6[G39[d5] + N75]=i1f;else if(i1f < v0m){for(l7=d5;l7 < d5 + v0m;l7++)void n4O === M5F[G39[l7]] && --t6F;K6[G39[d5] + N75]=t6F;}}if((e01=M5F[G39[d5]],E7=z7w,(V5=this.MultiRecord && i1f & this.MultiRecordShape?this._DownMultiMap[l7][d5]:h_Z[e01]) && Z3t != V5)){if((E7=this._getStringExcel(T6,V5,!n4O,g4,S_v),P02=this._addCellColor(f$I,T6,V5),N5Z=this._addCellFontColor(f$I,T6,V5),M8T !== !T6.Name || T6.CumulateRow || void n4O !== (M6$=J.OnExportEncryption?J.OnExportEncryption(this,T6,V5,E7):M6$) && (E7=M6$),N57=E7=y0m !== E7 && void n4O !== E7?E7:z7w,z7w != P02 && (N57+=P02),z7w != N5Z)){for(z_g=n4O;z_g < (z7w != P02?F$K:Q$v);z_g++)N57+=this.IB_DELIMITER_COLOR;N57+=N5Z;}(h9b[this.MultiRecord && i1f & this.MultiRecordShape?d5:M5F[V5]]=N57,Y5T == S_v && (G98=o$c + ((this.MultiRecord && i1f & this.MultiRecordShape?d5:M5F[V5]) + i1f),this._setRowData(K6,G98,V5,E7,V5 && this.Cols[V5]?this.Cols[V5].Type:Y3j),D84 != T6[V5 + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && T6.Name && M8T == T6.Name?B6F:U1u)] && (K6[G98 + B6F]=K6[V5 + B6F] || T6[V5 + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && T6.Name && M8T == T6.Name?B6F:U1u)],i1f < K6[G98 + B6F] && D84 == K6[G98 + N75] && (K6[G98 + N75]=i1f),this.MergeVisibleDom && delete T6[V5 + l$K]),D84 != T6[V5 + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && T6.Name && M8T == T6.Name?N75:E_q)] && (K6[G98 + N75]=K6[V5 + N75] || T6[V5 + (this.MainTag.offsetHeight && this.MainTag.offsetWidth && T6.Name && M8T == T6.Name?N75:E_q)],i1f < K6[G98 + N75] && D84 == K6[G98 + B6F] && (K6[G98 + B6F]=i1f),this.MergeVisibleDom && delete T6[V5 + u_Q]),V5 && this.MultiRecord && i1f & this.MultiRecordShape && D84 != this.Cols[V5].RecordRowSpan && this._DownMultiMap[l7][d5] && (K6[G98 + B6F]=this.Cols[V5].RecordRowSpan),V5 && this.MultiRecord && i1f & this.MultiRecordShape && D84 != this.Cols[V5].RecordColSpan && this._DownMultiMap[l7][d5] && (K6[G98 + N75]=this.Cols[V5].RecordColSpan)),x7i && this.MainCol == V5 && (h9b[M5F[V5]]=T6.Level + P02));}}(m6S[b52++]=h9b.join(this.IB_DELIMITER_COL),m6S[b52++]=this.IB_DELIMITER_ROW,Y5T == S_v && this.ExcelXB.push(K6));}if((this.ExLoadSEQ && delete this.ExLoadSEQ,Y5T == S_v && g4.useFormula))for(d5=n4O;d5 < w9X;d5++)if((V5=h_Z[d5],(l5M=this.Cols[V5].Formula) && M8J == typeof l5M)){for(var u$q,n_9,G2G=this.getColIndex(this.getLastCol());n4O <= G2G;G2G--)if((u$q=this.getColByIndex(G2G)) && -i1f < (n_9=l5M.indexOf(u$q)) && U7e !== l5M.charAt(n_9 - i1f)){if((n_9=h_Z.indexOf(u$q)) < n4O){l5M=z7w;break;}l5M=l5M.replaceAll(u$q,U7e + u$q + U7e);}l5M && q3L.push({SaveName:V5,Formula:l5M});}if(n4O < e79.length && g4.downSum && n4O != this.FormulaRowPosition)for((m6S[b52++]=e79.join(this.IB_DELIMITER_ROW),m6S[b52++]=this.IB_DELIMITER_ROW,V9C=V9C.concat(S_A),N$=n4O);N$ < this.DataRows;N$++)W08.push(e4y++);if(n4O < y5$.length)for((m6S[b52++]=y5$.join(this.IB_DELIMITER_ROW),m6S[b52++]=this.IB_DELIMITER_ROW,V9C=V9C.concat(S_A),N$=n4O);N$ < E$P;N$++)e3F.push(e4y++);return {p:b52,data:m6S,headerRows:Q0R,rowHeights:V9C,footRow:e3F,sumRow:W08,subSumRow:W2a,cumulateRow:S_I,formulas:q3L};},q._getBooleanValue=function(i4T,q7P){var o$K=q7P,Y9q={1:i1f,true:i1f,0:n4O,false:n4O};return (this.BooleanSettingMode?o$K=void n4O === i4T?q7P:i4T && S9$ != i4T?i1f:n4O:void n4O !== Y9q[i4T=(i4T + z7w).toLowerCase()] && (o$K=Y9q[i4T]),o$K);},q._getCCSStylesheetRuleStyle=function(K5S,A5t){var Q1_="rules";var F7$="cssRules";var K89="initial";var z0g,E$J,i6W,J1m,t9B,Q3l,S9h=z7w;for((A5t=A5t.toLowerCase(),i6W=s.all?Q1_:F7$,J1m=n4O);J1m < s.styleSheets.length;J1m++){try{E$J=s.styleSheets[J1m][i6W];}catch(l8e){continue;}if(E$J)for(t9B=n4O;t9B < E$J.length;t9B++)if(E$J[t9B] && E$J[t9B].selectorText && -i1f != E$J[t9B].selectorText.indexOf(K5S) && E$J[t9B].cssText && -i1f != E$J[t9B].cssText.indexOf(A5t)){for(z0g=E$J[t9B].style;;){if(-i1f == (Q3l=A5t.indexOf(y9E)))break;A5t=A5t.substring(n4O,Q3l) + A5t[Q3l + i1f].toUpperCase() + A5t.substring(Q3l + m$I);}z0g[A5t] && K89 != z0g[A5t] && (S9h=z0g[A5t]);}}return S9h;},q._getCellText=function(y3A,x8O){var u_c="GroupSumType";var r_5="Button";var t6k="FooterRow";var S4p="|| |";var h2E,E74=z7w,T3j=this.getType(y3A,x8O),U_f=J.get(y3A,x8O) + z7w,U76=this.GetFnLib(N2t);if(!y3A || !x8O)return E74;if(D84 != this.getAttribute(y3A,x8O,Y$O))return this.getAttribute(y3A,x8O,Y$O);if(K7w !== y3A.Kind && R5W === this.MainCol && this.GroupTreeCols && t6k !== y3A.id && y0j !== y3A.id){if(this.GroupTreeCols[x8O] && !y3A.Def.Group)return z7w;if(y3A.Def.Group && !this.GroupTreeCols[x8O] && !this.getAttribute(y3A,x8O,u_c))return z7w;}return (K7w == y3A.Kind?E74=a6S == T3j?this.getString(y3A,x8O):this._removeHTMLTag(this.getString(y3A,x8O)):T2J == T3j?E74=this._getPasswordType(y3A,x8O,U_f):this._isBooleanType(T3j)?(h2E=this.getAttribute(y3A,x8O,N4d),E74=q95 == T3j && h2E?this.getString(y3A,x8O):this._getBooleanValue(U_f,n4O)):U76(U_f) && m1F == T3j?E74=(h2E=U_f.split(U_f.charAt(n4O))).length?(z7w == h2E[i1f] || z7w != h2E[m$I] && D84 != h2E[m$I]?(z7w == h2E[m$I] || D84 == h2E[m$I] || h2E.length < S8T) && (h2E[m$I]=v4y):h2E[m$I]=h2E[i1f],e0b != y3A.Kind?h2E.join(U_f.charAt(n4O)):h2E[m$I]):e0b != y3A.Kind?S4p:z7w:r_5 == T3j?E74=U_f?U_f + z7w:z7w:(E74=k97 == T3j || q31 == T3j?U_f:z7w == U_f && N4d != T3j?z7w:this.getString(y3A,x8O),y0j === y3A.id?(n4O == U_f && void n4O !== this.SumZeroValue && (E74=this.SumZeroValue),Y3j == T3j && (E74=U_f)):e0b == y3A.Kind && x8O == (this.RowIndex || L6W) && y0m == E74 && (E74=z7w),this.DataAutoTrim && M8J == typeof E74 && a1V == y3A.Kind && (E74=this._trim(E74))),E74);},q._getCellValue=function(I4H,L$p){var W_e="Popup";var r6k="AutoAvg";var Q00="ComboEdit";var l88="(ALL)";var p51="AutoSum";var S_X="PopupEdit";var b_M="CheckBox";var X5j="FormatFix";var P3K="DummyCheck";this.Lang.Format;var Q26,w15=z7w,D$$=this.getAttribute(I4H,L$p,V5j),l3y=I4H && y0j == I4H.id?this.getType(I4H,L$p):this.getAttribute(I4H,L$p,K02) || this.getAttribute(I4H,L$p,o$q);if(this.getAttribute(I4H,L$p,X5j))return this._getCellText(I4H,L$p);if(D84 != this.getAttribute(I4H,L$p,Y$O))return this.getAttribute(I4H,L$p,Y$O);switch((w15=this.getValue(I4H,L$p),J77 == I4H.Kind && l88 === (w15 + z7w).toUpperCase() && (w15=z7w),K7w == I4H.Kind && a6S == this.Cols[L$p].Type && (w15=this.getString(I4H,L$p)),l3y=q95 == l3y && D$$?N4d:l3y)){case K13:w15=this._getStatusTypeCellValue(l3y,I4H,L$p,w15);break;case Y3j:case W_e:case S_X:w15=this._getTextTypeCellValue(l3y,I4H,L$p,w15);break;case o20:(Q26=this.getAttribute(I4H,L$p,B99) || this.getAttribute(I4H,L$p,O22) || this.getAttribute(I4H,L$p,Y7s) || this.getAttribute(I4H,L$p,X81) || this.DateFormat || this.DataFormat,M8J == typeof (w15=J.dateToString(this.getValue(I4H,L$p),Q26)) && (w15=this._removeHTMLTag(w15)));break;case k97:case q31:case p51:case r6k:w15=this._getNumberTypeCellValue(l3y,I4H,L$p,w15);break;case e1u:case b_M:case y6Q:case q95:case P3K:w15=this._getCheckBoxTypeCellValue(l3y,I4H,L$p,w15);break;case y$b:case N4d:w15=this._getComboTypeCellValue(l3y,I4H,L$p,w15);break;case Q00:w15=this._getComboEditTypeCellValue(l3y,I4H,L$p,w15);}return w15=this.DataAutoTrim && M8J == typeof w15 && a1V == I4H.Kind?IBSheet._ibsUtil.trim(w15):w15;},q._getCheckBoxTypeCellValue=function(y_7,F3R,n7D,k82){(this.getAttribute(F3R,n7D,N4d),this.getAttribute(F3R,n7D,V5j),k82=k82?+k82:n4O);return k82=n4O === this.GetCellValueMode?this._boolFormatter(F3R,n7D,k82,n4O):k82;},q._getColInfo=function(H51,U9i,z5s){var A8d=/Format/i;var S0$="Int|";var s4n="Text|";var N18="IBTreeLevelCol|";var n5R="30|";var D3q="Lines";var l3I="[object Function]";for(var O2x,v2n,T73,t9T,g0q,d9W=z7w,u9N=z7w,X6A=z7w,d0A=z7w,N13=z7w,s9P=z7w,d6_=z7w,H3g=z7w,p7q=z7w,M9z=z7w,H8z=z7w,F0k=H51.hiddenColumn,k$f=H51.numberTypeToText,e9s=H51.allTypeToText,t1s=U9i.length,l0D=z7w,E3m=z7w,g52=z7w,P$Q={Int:i1f,Float:i1f,AutoSum:i1f,AutoAvg:i1f},K0n={Enum:i1f,Combo:i1f,ComboEdit:i1f},m2P={left:i1f,center:i1f,right:i1f},Y0N=n4O;Y0N < this.DataRows;Y0N++){for((v2n=this.Cols,O2x=n4O);O2x < t1s;O2x++){var J_f,u9$=(this.MultiRecord && i1f & this.MultiRecordShape?this._DownMultiMap[Y0N]:U9i)[O2x];(n4O == Y0N && (d9W+=(u9$ && void n4O !== v2n[u9$].Name?v2n[u9$].Name:z7w) + U7e,u9N+=this._getNumberValue(!u9$ && this.MultiRecord && i1f & this.MultiRecordShape?this.MultiHeaderColSpan[this.MultiHeaderMap[Y0N][O2x]][O2x - this._DownMultiMap[Y0N].indexOf(this.MultiHeaderMap[Y0N][O2x]) - i1f] + v2n[this.MultiHeaderMap[Y0N][O2x]].WidthPad:n4O == v2n[u9$].Visible && v2n[u9$].RelWidth?n4O:v2n[u9$].Width || v2n[u9$].MinWidth || this.MinMidWidth,n4O) + U7e,X6A+=(i1f == F0k?v2n[u9$].Visible:H7j) + U7e,z5s && this.MainCol == u9$ && (d9W+=N18,u9N+=n5R,X6A+=U7U)),d0A+=(u9$ && void n4O !== v2n[u9$].SaveName?v2n[u9$].SaveName:u9$ && void n4O !== v2n[u9$].Name?v2n[u9$].Name:z7w) + U7e,T73=u9$?v2n[u9$].LegacyType || v2n[u9$].Type:z7w,l0D=u9$?v2n[u9$].LegacyFormat || v2n[u9$].Format:z7w,t9T=u9$?v2n[u9$].FormulaRow:z7w,H51.downRowSpan && (g0q=u9$ && !v2n[u9$].ColMerge?S9$:H7j,g52+=z7w === g52?g0q:U7e + g0q),M8J != typeof (l0D=o20 != T73 || l0D?l0D:v2n[u9$].DateFormat || this.DateFormat || v2n[u9$].DataFormat || this.DataFormat)?l0D=(void n4O !== l0D && l3I !== Object.prototype.toString.call(l0D) && u3M !== Object.prototype.toString.call(l0D) && V4j != typeof l0D && Object.prototype.toString.call(l0D),z7w):Y3j != T73 && D3q != T73 && T2J != T73 && m1F != T73 && Y36 != T73 || (l0D=z7w),N13+=m2P[s9P=this.Group && n4O < this.Group.length && (this.GroupMain?this.GroupMain == u9$:this.Group.split(E9P)[n4O] == u9$)?k12:u9$?(v2n[u9$].Align + z7w).toLowerCase():z7w]?s9P + U7e:this._getAlignByType(T73) + U7e,P$Q[T73]?k$f?(d6_+=s4n,H3g+=U7e,p7q+=U7e,M9z+=U7e):(d6_+=T73 + U7e,H3g+=(l0D || z7w) + U7e,J_f=this._getDateFormatPattern(T73,l0D),p7q+=(v2n[u9$].OrgFormat || J_f.replace(A8d,z7w)) + U7e,M9z+=J_f + U7e):e9s && !K0n[T73]?(d6_+=s4n,H3g+=U7e,p7q+=U7e,M9z+=U7e):(d6_+=(N4d == T73 || q95 == T73 && v2n[u9$].Enum?y$b:T73) + U7e,H3g+=o20 === T73?(l0D || z7w) + U7e:(l0D?this.ConvertExcelFormat({type:T73,format:l0D}):z7w) + U7e,J_f=this._getDateFormatPattern(T73,l0D),p7q+=(u9$ && v2n[u9$].OrgFormat?v2n[u9$].OrgFormat:J_f.replace(A8d,z7w)) + U7e,M9z+=J_f + U7e),E3m+=t9T?t9T + U7e:U7e,z5s && this.MainCol == u9$ && (d0A+=N18,N13+=J94,d6_+=S0$,H3g+=U7e,p7q+=U7e,M9z+=U7e,E3m+=U7e),H8z+=U7e + (v2n[u9$] && v2n[u9$].DataFormat?v2n[u9$].DataFormat:z7w));}(H8z=H8z.substring(i1f),d0A=d0A.substring(n4O,d0A.length - i1f),N13=N13.substring(n4O,N13.length - i1f),d6_=d6_.substring(n4O,d6_.length - i1f),H3g=H3g.substring(n4O,H3g.length - i1f),p7q=p7q.substring(n4O,p7q.length - i1f),M9z=M9z.substring(n4O,M9z.length - i1f),E3m=E3m.substring(n4O,E3m.length - i1f),i1f < this.DataRows && Y0N < this.DataRows - i1f && (d0A+=P5U,N13+=P5U,d6_+=P5U,H3g+=P5U,p7q+=P5U,M9z+=P5U,H8z+=P5U,E3m+=P5U));}return {name:d9W=d9W.substring(n4O,d9W.length - i1f),width:u9N=u9N.substring(n4O,u9N.length - i1f),visible:X6A=X6A.substring(n4O,X6A.length - i1f),saveName:d0A,align:N13,type:d6_,format:H3g,orgFormat:p7q,datePattern:M9z,dataFormat:H8z,formulaRow:E3m,colMerge:g52};},q._getComboEditTypeCellValue=function(w93,h4_,j9q,x0h){var z47,i$w,S8Q,I75=this.getAttribute(h4_,j9q,V5j),j9q=this.getAttribute(h4_,j9q,N4d),R$D=n4O,h2C=x0h,I75=I75 && (z7w + I75).substring(i1f),j9q=j9q && (z7w + j9q).substring(i1f);if(K7w != h4_.Kind && j9q)for((i$w=j9q.split(U7e),z47=I75.split(U7e),S8Q=i$w.length,R$D=n4O);R$D < S8Q;R$D++)if(x0h == i$w[R$D]){h2C=z47[R$D];break;}return h2C;},q._getComboTypeCellValue=function(R2t,A93,G4I,D1C){var X_A,Z7J,L4H=n4O,e7b=n4O,x2w=D1C,G4I=(G4I=this.getAttribute(A93,G4I,V5j)) && (z7w + G4I).substring(i1f);if(K7w != A93.Kind){if(G4I)for((X_A=(Z7J=G4I.split(U7e)).length,e7b=n4O);e7b < X_A;e7b++)if(D1C == Z7J[e7b]){(L4H=i1f,x2w=D1C);break;}L4H || (x2w=z7w);}return x2w;},q._getCookie=function(p1_){var R2J,Z4D=n4O,A2h=n4O;p1_+=R6D;try{for(;Z4D <= s.cookie.length;){if((R2J=Z4D + p1_.length,s.cookie.substring(Z4D,R2J) == p1_))return (-i1f == (A2h=s.cookie.indexOf(C7z,R2J)) && (A2h=s.cookie.length),unescape(s.cookie.substring(R2J,A2h)));if(n4O == (Z4D=s.cookie.indexOf(v4y,Z4D) + i1f))break;}}catch(a82){}return z7w;},q._getDateFormat=function(m2M){var r4T="MM/dd";var T0d="yyyy/MM/dd HH:mm";var T6P="yyyy/MM/dd HH:mm:ss";var x4w="yyyy/MM/dd";var T$y="yyyy/MM";var k8i="HH:mm";var U3x=x4w;return (m2M && (T5Q == m2M?U3x=x4w:D2U == m2M?U3x=T$y:s0y == m2M?U3x=r4T:B5H == m2M?U3x=T6P:i45 == m2M?U3x=T0d:V5I == m2M?U3x=B8x:a2G == m2M && (U3x=k8i)),U3x);},q._getDateFormatPattern=function(i_B,d_h){var H7h="Ymd";var Y2V=/^y.*d.*M$/;var S0U=/^M.*y$/;var d88="YmdHm";var b4K=/^d.*M$/;var N0q=/^H.*m$/i;var A7U=/^M.*y.*d.*H.*m$/i;var V5O=/^M.*y.*d.*H.*m.*s$/i;var G4_=/^y.*M.*d.*H.*m$/i;var t9b=/^y.*M.*d.*H.*m.*s$/i;var q65=/^M.*d$/;var u3J=/^y.*d.*M.*H.*m$/i;var Z4N=/^y.*d.*M.*H.*m.*s$/i;var h$C="YmdHms";var b70="Md";var N0B=/^d.*y.*M.*H.*m.*s$/i;var p1g=/^d.*M.*y.*H.*m$/i;var I43=/^H.*m.*s$/i;var N_K=/^M.*d.*y.*H.*m$/i;var N4r=/^y.*M.*d$/;var c00=/^d.*y.*M$/;var l3M="Ym";var V1F=/^M.*y.*d$/;var q$a="Hm";var V$N=/^d.*M.*y.*H.*m.*s$/i;var Y9y=/^d.*M.*y$/;var F6V=/^M.*d.*y.*H.*m.*s$/i;var O3U=/^y.*M$/;var g68="Hms";var w3r=/^d.*y.*M.*H.*m$/i;var j6S=/^M.*d.*y$/;var c$G=z7w;return (i_B && (d_h=o20 !== i_B || d_h?d_h:H7h) && (H7h == d_h || n4O <= d_h.search(N4r) || n4O <= d_h.search(Y2V) || n4O <= d_h.search(V1F) || n4O <= d_h.search(j6S) || n4O <= d_h.search(Y9y) || n4O <= d_h.search(c00)?c$G=T5Q:l3M == d_h || n4O <= d_h.search(O3U) || n4O <= d_h.search(S0U)?c$G=D2U:b70 == d_h || n4O <= d_h.search(q65) || n4O <= d_h.search(b4K)?c$G=s0y:h$C == d_h || n4O <= d_h.search(t9b) || n4O <= d_h.search(Z4N) || n4O <= d_h.search(V5O) || n4O <= d_h.search(F6V) || n4O <= d_h.search(V$N) || n4O <= d_h.search(N0B)?c$G=B5H:d88 == d_h || n4O <= d_h.search(G4_) || n4O <= d_h.search(u3J) || n4O <= d_h.search(A7U) || n4O <= d_h.search(N_K) || n4O <= d_h.search(p1g) || n4O <= d_h.search(w3r)?c$G=i45:g68 == d_h || n4O <= d_h.search(I43)?c$G=V5I:(q$a == d_h || n4O <= d_h.search(N0q)) && (c$G=a2G)),c$G);},q._getDefault=function(u6z,j6P,h$B){if(void n4O === u6z || D84 == u6z)return j6P;switch(h$B || typeof j6P){case V4j:return this._getNumberValue(u6z,j6P);case V2U:return this._getNumberValue(u6z,j6P,i1f);case M8J:return n4O == u6z.length?j6P:u6z + z7w;case T8w:return this._getBooleanValue(u6z,j6P);default:return j6P;}},q._getDownColNames=function(x6R){var N1g,I9N,w0u,T5T,M20,q4T=[],M8s=[],z$S=[],b2_=[],K7i=[];if(z7w != x6R.downCols)for((N1g=n4O,I9N=(q4T=U0n === x6R.downCols?this.getCols(U0n):x6R.downCols.split(U7e)).length);N1g < I9N;N1g++){if(!this.Cols[q4T[N1g]])return [];this.GetColName(q4T[N1g]) && M8s.push(this.GetColName(q4T[N1g]));}else for(w0u=this.GetFirstColA(D84,m$I);w0u;w0u=this.GetNextColA(w0u))R5W !== w0u && T4N !== w0u && this.Cols[w0u].CanExport && M8s.push(w0u);for((q4T=[],x6R.objReturn && (b2_=[],K7i=[]),-i1f == x6R.mode?z$S={Status:i1f,DelCheck:i1f,Result:i1f}:i1f == x6R.mode && (z$S={Status:i1f,DelCheck:i1f}),N1g=n4O,I9N=M8s.length);N1g < I9N;N1g++)(w0u=M8s[N1g]) && (T5T=this.Cols[w0u].LegacyType || this.Cols[w0u].Type,M20=this.Cols[w0u].Hidden,z$S[T5T] || (-i1f == x6R.mode || m$I == x6R.mode) && M20 || (x6R.objReturn?(b2_[w0u]=this.Cols[w0u],K7i.push(w0u)):q4T.push(w0u)));return (x6R.objReturn && (q4T[n4O]=b2_,q4T[i1f]=K7i),q4T);},q._getHeaderData=function(Y6P){var R93="HtmlPrefix";var m8H="(*)";var A$M="\0";var P4g="TreeLevel";var F5h="HtmlPostfix";var q67="Required";var Q8Y,C9j,V53,v4l,o$F,q9e,r$x,g2v=Y6P.from,y3D=Y6P.cfg,r3B=Y6P.sheetDesign,W1X=Y6P.isTreeLevel,C7e=(Y6P.isDownRows,Y6P.isDownRowVisible,Y6P.rowHeights),S_k=Y6P.downColNames,d9s=Y6P.downColNamesLength,n6e=Y6P.data,S17=Y6P.p,O5c=Y6P.headerRows,e9y=Y6P.isHeaderMerge,B$m={},f9z=this.getCols(),W7g=Y6P.isSameDownColAndVisible,d4N=this.Style + q67,Y6P=this.Cols[this.RowIndex || L6W],c2J=this.GetFnLib(V2f),i8u={};if(!Y6P.Visible && Y6P.Def && h_4 === Y6P.Def)for(var p8h=n4O;p8h < f9z.length;p8h++)if(f9z[p8h] === (this.RowIndex || L6W)){f9z.splice(p8h,i1f);break;}for((o10=n4O,P0a=S_k.length);o10 < P0a;o10++)B$m[S_k[o10]]=o10;for(var j1m=this.ExLoad || !W7g?l$K:B6F,B8D=this.ExLoad || !W7g?u_Q:N75,o10=n4O,P0a=this.XH.childNodes.length;o10 < P0a;o10++)if(K7w == (C9j=GetNode(this.XH,o10)).Kind && C9j.Visible)for(var A9y=n4O;A9y < this.DataRows;A9y++){for((O5c++,Y5T != g2v && i$B != g2v || C7e.push(this._getExcelRowHeight(C9j,A9y)),Y5T == g2v && this._setRowProperty(o$F={},C9j),q9e=new Array(S_k.length),Q8Y=n4O);Q8Y < (this.MultiRecord && i1f & this.MultiRecordShape?this.MultiHeaderMap[A9y]:f9z).length;Q8Y++){var d9i,R7v,A_n;if(!(Y5T != g2v || this.MultiRecord && i1f & this.MultiRecordShape || this.MergeAllRanges || f9z.length == d9s)){var e2B=C9j[f9z[Q8Y] + N75];if(!c2J(B$m[f9z[Q8Y]])){if(W7g || d9s == f9z.length){if(n4O < e2B){for(var N1U=D84,A9y=n4O;A9y < C9j[f9z[Q8Y] + N75];A9y++)this.Cols[f9z[Q8Y + A9y]].Visible?N1U=N1U || A9y:--e2B;o$F[f9z[Q8Y + N1U] + N75]=e2B;}}else o$F[f9z[Q8Y] + N75]=i1f;continue;}if(c2J(B$m[f9z[Q8Y]]) && n4O < e2B)if(W7g || d9s == f9z.length){for(A9y=Q8Y;A9y < Q8Y + C9j[f9z[Q8Y] + N75];A9y++)void n4O === B$m[f9z[A9y]] && --e2B;o$F[f9z[Q8Y] + N75]=e2B;}else o$F[f9z[Q8Y] + N75]=i1f;}(d9i=B$m[f9z[Q8Y]],(d9i=this.MultiRecord && i1f & this.MultiRecordShape?this.MultiHeaderMap[A9y][Q8Y]:S_k[d9i]) && Z3t != d9i && (A_n=z7w,y3D.RequiredMark && (R7v=this.Cols,d9i && i1f == R7v[d9i].Required && (e9y?(n4O <= (C9j[d9i + R93] + z7w || z7w).indexOf(d4N) || n4O <= (C9j[d9i + F5h] + z7w || z7w).indexOf(d4N)) && (A_n=m8H):(R7v=i1f,this.Rows.Filter && (R7v+=i1f),this.Rows.FormulaRow && n4O == this.GetAutoSumPosition() && (R7v+=i1f),o10 == P0a - R7v && (A_n=m8H)))),R7v=z7w,d9i && a6S == this.Cols[d9i].Type?R7v+=this._getCellValue(C9j,d9i):R7v=C9j[d9i + B9R] || this._getCellText(C9j,d9i),d9i && this.MultiRecord && i1f & this.MultiRecordShape && this.MultiHeaderMerge && (V53=this.MultiHeaderMergeMap[A9y][Q8Y],R7v=this._getCellText(C9j,V53)),d9i && this.MultiRecord && i1f & this.MultiRecordShape && this.MultiHColSpan && this.MultiHColSpan && V4j == typeof this.MultiHColSpanValue[n4O][d9i] && n4O < this.MultiHColSpanValue[A9y][d9i] && (R7v=this.MultiHColSpanTitle[A9y][d9i]),W2X == g2v && (R7v=(R7v + z7w).replace(/\r\n|\n|\r/g,z7w)),v4l=this._addCellColor(r3B,C9j,d9i),r$x=this._addCellFontColor(r3B,C9j,d9i),A_n=(R7v=y0m != (R7v=R7v && (R7v + z7w).replace(A$M,z7w)) && D84 != R7v?R7v:z7w) + A_n,z7w != v4l?A_n+=v4l + r$x:z7w != r$x && (A_n+=this.IB_DELIMITER_COLOR + r$x),q9e[this.MultiRecord && i1f & this.MultiRecordShape?Q8Y:B$m[d9i]]=A_n,Y5T == g2v && (r$x=o$c + ((this.MultiRecord && i1f & this.MultiRecordShape?Q8Y:B$m[d9i]) + i1f),this.ExcelColsMap[d9i]=r$x,this._setRowData(o$F,r$x,d9i,R7v,this.Cols[d9i].Type),C9j.Fixed && (j1m=B6F,B8D=N75),D84 != C9j[d9i + j1m] && i1f < C9j[d9i + j1m] && (o$F[r$x + B6F]=o$F[d9i + B6F] || C9j[d9i + j1m],i1f < o$F[r$x + B6F] && D84 == o$F[r$x + N75] && (o$F[r$x + N75]=i1f),delete C9j[d9i + l$K]),D84 != C9j[d9i + B8D] && i1f < C9j[d9i + B8D] && (o$F[r$x + N75]=o$F[d9i + N75] || C9j[d9i + B8D],i1f < o$F[r$x + N75] && D84 == o$F[r$x + B6F] && (o$F[r$x + B6F]=i1f),delete C9j[d9i + u_Q]),d9i && this.MultiRecord && i1f & this.MultiRecordShape && (this.MultiHColSpan && V4j == typeof this.MultiHColSpanValue[n4O][d9i]?n4O < this.MultiHColSpanValue[A9y][d9i]?(o$F[r$x + N75]=this.MultiHColSpanValue[A9y][d9i],o$F[r$x]=this.MultiHColSpanTitle[A9y][d9i],i8u[d9i]=!n4O):n4O === this.MultiHColSpanValue[A9y][d9i] && n4O < this.Cols[d9i].RecordRowSpan && i8u[d9i]?(o$F[r$x + B6F]=this.Cols[d9i].RecordRowSpan - A9y,i8u[d9i]=!i1f):this.MultiHColSpanValue[A9y][d9i] < n4O && (o$F[r$x + N75]=n4O,i8u[d9i]=!n4O):this.MultiHeaderMerge && (V53 != d9i || C9j[d9i + f3y] || C9j[d9i + i2R])?(V53 != d9i && (o$F[r$x + N75]=n4O,o$F[r$x + B6F]=n4O),C9j[d9i + f3y] && (o$F[r$x + N75]=C9j[d9i + f3y]),C9j[d9i + i2R] && (o$F[r$x + B6F]=C9j[d9i + i2R])):(D84 != this.Cols[d9i].RecordRowSpan && this._DownMultiMap[A9y][Q8Y] && (o$F[r$x + B6F]=this.Cols[d9i].RecordRowSpan),D84 != this.Cols[d9i].RecordColSpan && this._DownMultiMap[A9y][Q8Y] && (o$F[r$x + N75]=this.Cols[d9i].RecordColSpan)))),W1X && this.MainCol == d9i && (q9e[B$m[d9i]]=P4g + v4l)));}(n6e[S17++]=q9e.join(this.IB_DELIMITER_COL),n6e[S17++]=this.IB_DELIMITER_ROW,Y5T == g2v && this.ExcelXH.push(o$F));}return {p:S17,headerRows:O5c};},q._getHeaderText=function(v4W){var y0x,w2H,G9N,W0z,R8i=z7w,p0o=v4W.length,R$x=[];if(this.MultiRecord && i1f & this.MultiRecordShape)for(var e$A=n4O;e$A < this.DataRows;e$A++)for(var L7S=n4O;L7S < this.MultiHeaderMap[n4O].length;L7S++)R$x.push(this.MultiHeaderMap[e$A][L7S]);for((e$A=n4O,y0x=this.XH.childNodes.length);e$A < y0x;e$A++)if(K7w == (G9N=GetNode(this.XH,e$A)).Kind){for((L7S=n4O,w2H=p0o);L7S < w2H;L7S++)v4W[L7S]?(W0z=this.Cols[v4W[L7S]].Name,a6S == this.Cols[W0z].Type?R8i+=this._getCellValue(G9N,W0z) + U7e:G9N[W0z + B9R]?R8i+=G9N[W0z + B9R] + U7e:R8i+=this._getCellText(G9N,W0z) + U7e):R8i+=this._getCellText(G9N,R$x[L7S]) + U7e;(R8i=R8i.substring(n4O,R8i.length - i1f),e$A < y0x - i1f && (R8i+=P5U));}return R8i;},q._getNumberTypeCellValue=function(j$u,A_O,R4c,X0q){var x6e=parseFloat(X0q);return x6e=isNaN(x6e)?+X0q + z7w == X0q?+X0q:X0q:x6e;},q._getNumberValue=function(Z90,u8R,p1a,Q8c,N3c){var V8j=u8R;return (void n4O === Z90 || isNaN(Z90) || (V8j=Z90=p1a?parseFloat(Z90):parseInt(Z90,n1r),isNaN(Z90)?V8j=u8R:(void n4O !== Q8c && Z90 < Q8c && (V8j=u8R),void n4O !== N3c && N3c < Z90 && (V8j=u8R))),V8j);},q._getPasswordType=function(T2_,S6s,x1j){var i1p="Password";var N_v="StaticPassword";var g6z,f5h=z7w,x8F=n4O;if(n4O == this.getAttribute(T2_,S6s,N_v))for((x8F=n4O,g6z=x1j.length);x8F < g6z;x8F++)f5h+=T3L;else f5h=this.getMessage(i1p);return f5h;},q._getStatusTypeCellValue=function(P9q,q9l,u06,Y7A){var b_j="R";var V9W=Y7A;return V9W=({I:i1f,U:i1f,D:i1f})[Y7A]?V9W:b_j;},q._getTextTypeCellValue=function(C1S,t0$,v9y,k2_){this.getAttribute(t0$,v9y,B99) || this.getAttribute(t0$,v9y,O22);return this.getString(t0$,v9y) + z7w;},q._getTitleConfig=function(m9S){var T$e="0|";for(var Q2w,y3E=m9S,Z7v=z7w,C0h=z7w,N62=z7w,X8_={},Y0J=z7w,j_C=z7w,u8I=z7w,J9x=z7w,B91=z7w,i$0=z7w,k9r=z7w,e3M=n4O,H_B={left:i1f,center:i1f,right:i1f},e3M=n4O,s$i=y3E.length;e3M < s$i;e3M++)(void n4O === y3E[e3M].text && (y3E[e3M].text=z7w),void n4O === y3E[e3M].Text && (y3E[e3M].Text=z7w),Z7v+=(y3E[e3M].text || y3E[e3M].Text) + this.IB_DELIMITER_TITLE_BACKSLASH,C0h+=H_B[Q2w=((y3E[e3M].align || y3E[e3M].Align) + z7w).toLowerCase()]?Q2w + U7e:J94,N62+=this._getNumberValue(y3E[e3M].height || y3E[e3M].Height,n4O) + U7e,(X8_=y3E[e3M].style || y3E[e3M].Style) && K9S == typeof X8_?(Y0J+=this._getBooleanValue(X8_.fontBold || X8_.FontBold,n4O) + U7e,void n4O === X8_.fontName && (X8_.fontName=z7w),void n4O === X8_.FontName && (X8_.FontName=z7w),u8I+=(X8_.fontName || X8_.FontName) + U7e,J9x+=this._getNumberValue(X8_.fontSize || X8_.FontSize,n4O) + U7e,B91+=this._getBooleanValue(X8_.fontUnderline || X8_.FontUnderline,n4O) + U7e,j_C+=J._ibsUtil.getWebColor(X8_.fontColor || X8_.FontColor,i1f) + U7e,i$0+=J._ibsUtil.getWebColor(X8_.backColor || X8_.BackColor,i1f) + U7e,k9r+=this._getBooleanValue(X8_.border || X8_.Border,i1f) + U7e):(Y0J+=T$e,u8I+=U7e,J9x+=T$e,B91+=T$e,j_C+=U7e,i$0+=U7e,k9r+=U7U));return {text:Z7v=Z7v.substring(n4O,Z7v.length - i1f),align:C0h=C0h.substring(n4O,C0h.length - i1f),height:N62=N62.substring(n4O,N62.length - i1f),fontBold:Y0J=Y0J.substring(n4O,Y0J.length - i1f),fontColor:j_C=j_C.substring(n4O,j_C.length - i1f),fontName:u8I=u8I.substring(n4O,u8I.length - i1f),fontSize:J9x=J9x.substring(n4O,J9x.length - i1f),fontUnderline:B91=B91.substring(n4O,B91.length - i1f),backColor:i$0=i$0.substring(n4O,i$0.length - i1f),border:k9r=k9r.substring(n4O,k9r.length - i1f)};},q._getTreeVisible=function(m0Y){var Z0T;return !this.MainCol || (n4O == m0Y.Level || !!m0Y.parentNode && (n4O != (Z0T=m0Y.parentNode).Expanded && n4O != Z0T.Visible && this._getTreeVisible(m0Y.parentNode)));},q._isBooleanType=function(P9n){return !!({CheckBox:i1f,DelCheck:i1f,DummyCheck:i1f,Radio:i1f})[P9n];},q._isNumberType=function(m6g){return !!({Int:i1f,Float:i1f,AutoSum:i1f,AutoAvg:i1f})[m6g];},q._makeColumnTag=function(f_o,Z3x){return this.MarkupTagSS + f_o + this.MarkupTagSE + Z3x + this.MarkupTagES + f_o + this.MarkupTagEE;},q._makeLoadForm=function(A0S,w_v,r$e,Y0X,h$Q,x3v,P6H){var R6m="-9999";var T9k="LoadExcelSheetID";var u6C="50";var b$f='<iframe name="';var q7B="IBSheetLoadExcelForm";var U1b='">';var y3e="CrossDomain";var v3_="100";var d$a="submit";var w$C="IBSheetLoadTextForm";var V5X="FileExt";var X1E='" id="';var o3q,V$x=z7w,g9W=z7w,d4Y=z7w,E_i=D84,m3V=D84,L_a=this,t2P=z7w,p0x=z7w,o0h=D84,j_K=J.BIEA && !J.BIEA11,G9X=D84;if((h$Q=this._getNumberValue(h$Q,n4O,i1f),IBSheet && n4O < IBSheet.length))for(var B7n=n4O;B7n < IBSheet.length;B7n++)IBSheet[B7n] && delete IBSheet[B7n].LoadFileType;if(this.Source.LoadExcel && this.Source.LoadText){if((Y5T == A0S || j$y == A0S?(p0x=i1f == J.g_isDirectLoadExcel?(t2P=N$w,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,O3T),this.Source.DirectLoadExcel.Url):(t2P=X8h,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,B$9),this.Source.LoadExcel.Url),V$x=q7B,g9W=o1D,d4Y=g9B):W2X == A0S && (J.g_targetTextSheetID=this.id,t2P=B9k,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,Y$V),p0x=this.Source.LoadText.Url,V$x=w$C,g9W=w5Y,d4Y=p$R),this._removeForm(V$x),o3q=p0x,o3q+=(n4O <= p0x.indexOf(Z1r)?G3H:Z1r) + D1V + t2P,(E_i=s.createElement(g48)).method=K1T,E_i.name=V$x,E_i.id=V$x,E_i.encoding=Y_p,E_i.enctype=Y_p,E_i.target=g9W,E_i.action=o3q,J.BChrome || J.BSafariMac || J.BSafariWin || J.BSafari || J.BOpera || J.BOpera8?(E_i.style.position=h0S,E_i.style.left=d9$,E_i.style.top=d9$,E_i.style.width=d9$,E_i.style.height=d9$,E_i.style.zIndex=R6m):E_i.style.display=e44,(m3V=s.createElement(a5z)).type=d$a,E_i.appendChild(m3V),(m3V=s.createElement(a5z)).type=i2O,m3V.name=W7R,j_K && !x3v && (Y0X=(Y0X=(Y0X+=this._makeColumnTag(y3e,H7j)) + this._makeColumnTag(V5X,r$e)) + this._makeColumnTag(T9k,J.g_LoadExcelSheetID.join(P5U))),m3V.value=Y0X,E_i.appendChild(m3V),o3s == typeof P6H || K9S == typeof P6H && P6H))for(G9X in P6H)((m3V=s.createElement(a5z)).type=i2O,m3V.name=G9X,m3V.value=P6H[G9X],E_i.appendChild(m3V));if(!j_K && !x3v){if(((m3V=s.createElement(a5z)).type=q5Z,m3V.name=q5Z,m3V.id=d4Y,m3V.title=d4Y,o0h=m3V,r$e)){for(var K$Z=(r$e + z7w).split(U7e),m9p=z7w,B7n=n4O;B7n < K$Z.length;B7n++)(n4O < B7n && (m9p+=v2A),m9p+=I9E + K$Z[B7n].replace(I9E,z7w));m3V.accept=m9p;}(m3V.onchange=function(Z77){if(IBSheet && n4O < IBSheet.length)for(var x6Y=n4O;x6Y < IBSheet.length;x6Y++)IBSheet[x6Y] && (IBSheet[x6Y].LoadFileType=IBSheet[x6Y].LoadExcelExecute?Y5T:void n4O);var Z77=Z77.target.files[n4O].size,b5g=s8R * h$Q * s8R;if(z7w != this.value)return n4O < b5g && b5g < Z77?(L_a.hideMessage(),void L_a.ShowAlert(L_a.getMessage(M83,h37).replace(/%d/g,h$Q + C$y),f6F)):void L_a._selectFileAction(E_i,A0S,w_v,r$e,this.value);},E_i.appendChild(m3V));}((m3V=J.BIEA && !J.BIEA9?s.createElement(b$f + g9W + X1E + g9W + U1b):s.createElement(D9r)).name=g9W,m3V.id=g9W,m3V.title=g9W,m3V.width=v3_,m3V.height=u6C,E_i.appendChild(m3V),s.body.appendChild(E_i),E_i.style.visibility=i2O,Q.frames[g9W].name=g9W,j_K || x3v?E_i.submit():(o0h.focus(),o0h.click()));}},q._makeLoadXhr=function(t6j,r82,i4F,G7z,z$4,n8e,u4T){var X42="tempFile";var k$_="text";var M$m="#tempFile";var X0Z,d9Y=this,m6y=z7w,X1k=z7w,G1P=z7w,c_l={},j3W=new FormData();if((i4F=this._getNumberValue(i4F,n4O,i1f),this.Source.LoadExcel && this.Source.LoadText)){(Y5T == t6j?G1P=i1f == J.g_isDirectLoadExcel?(m6y=N$w,this.Source.DirectLoadExcel.Url=this._getDefault(this.Source.DirectLoadExcel.Url,O3T),X1k=this.Source.DirectLoadExcel.Url,c_l={".xls":i1f,".xlsx":i1f},A2a):(m6y=X8h,this.Source.LoadExcel.Url=this._getDefault(this.Source.LoadExcel.Url,B$9),X1k=this.Source.LoadExcel.Url,c_l={".":i1f,".txt":i1f,".csv":i1f},q5H):W2X == t6j?(J.g_targetTextSheetID=this.id,m6y=B9k,this.Source.LoadText.Url=this._getDefault(this.Source.LoadText.Url,Y$V),X1k=this.Source.LoadText.Url):j$y == t6j && (c_l={".":i1f,".txt":i1f,".csv":i1f,".xls":i1f,".xlsx":i1f},G1P=q5H),actionUrl=X1k,actionUrl+=(n4O <= X1k.indexOf(Z1r)?G3H:Z1r) + D1V + m6y,G7z && K9S == typeof G7z && Object.keys(G7z).forEach(function(W5j,I7l){j3W.append(W5j,G7z[W5j]);}),j3W.append(W7R,r82),s.querySelector(M$m) && s.querySelector(M$m).parentNode.removeChild(s.querySelector(M$m)));X1k=D84;if(((X1k=s.createElement(a5z)).type=q5Z,X1k.id=X42,X1k.style.display=e44,z$4)){for(var C1H=(z$4 + z7w).split(U7e),a1h=z7w,R2q=n4O;R2q < C1H.length;R2q++)(n4O < R2q && (a1h+=v2A),a1h+=I9E + C1H[R2q].replace(I9E,z7w));X1k.accept=a1h;}(X1k.onchange=function(R0g){var z59=this.value,l50=R0g.target.files[n4O].size,f4a=s8R * i4F * s8R;if(z7w != this.value){if(n4O < f4a && f4a < l50)return (d9Y.hideMessage(),void d9Y.ShowAlert(d9Y.getMessage(M83,h37).replace(/%d/g,i4F + C$y),f6F));if(z7w != z$4)for((c_l={},X0Z=z$4.split(U7e),R2q=n4O,max=X0Z.length);R2q < max;R2q++)c_l[I9E + X0Z[R2q]]=i1f;if(z7w != z59 && -i1f < z59.indexOf(I9E))if((z$4=z59.substring(z59.lastIndexOf(I9E),z59.length).toLowerCase(),c_l[z$4])){(J.OnLoadFileSelect && J.OnLoadFileSelect(d9Y,t6j,this.value),j3W.append(q5Z,R0g.target.files[n4O]));try{z$y.send(j3W);}catch(S03){}}else d9Y.ShowAlert(d9Y.getMessage(G1P,h37),f6F);}},s.body.appendChild(X1k));var z$y=new XMLHttpRequest();(z$y.open(K1T,actionUrl),n8e && K9S == typeof n8e && Object.keys(n8e).forEach(function(N_a,y6w){z$y.setRequestHeader(N_a,n8e[N_a]);}),z$y.responseType=k$_,z$y.onload=function(v2i){var W6f=20;var S9H=z$y.response;if(u4T)for(var n9w=n4O;n4O <= n9w;)(M({data:S9H.substring(S9H.indexOf(v0r,n9w) + y3I,S9H.indexOf(F97,n9w) - S8T).replace(/\\'/g,V$7).replace(/\\n/g,g5k)}),n9w=S9H.indexOf(F97,n9w) < n4O?-i1f:S9H.indexOf(F97,n9w) + W6f);else M({data:S9H.substring(S9H.indexOf(v0r) + y3I,S9H.indexOf(F97) - S8T).replace(/\\'/g,V$7).replace(/\\n/g,g5k)});},X1k.click());}},q._prepareExportSetting=function(){var e_t="";var M50="";var L3j=".jsp";var W7Z="";var y_v="";var p$z="";for(var q_I=z7w,O7a=L3j,d86=(this.Source.Export && M8J == typeof this.Source.Export.Url?((q_I=this.Source.Export.Url.split(Y6L))[q_I.length - i1f]=z7w,q_I=q_I.join(Y6L)):this.Export && M8J == typeof this.Export.Url && ((q_I=this.Export.Url.split(Y6L))[q_I.length - i1f]=z7w,q_I=q_I.join(Y6L)),this.Source.Export.Ext && (O7a=I9E + this.Source.Export.Ext),[R5Q,X8h,u0p,B9k,I6l,e6w,m7I,N$w]),a9o=n4O;a9o < d86.length;a9o++)(this.Source[d86[a9o]] || (this.Source[d86[a9o]]={}),this.Source.Export[d86[a9o] + V0H]?this.Source[d86[a9o]].Url=this.Source.Export[d86[a9o] + V0H]:this.Source[d86[a9o]].Url?this.Source[d86[a9o]].Url=this.Source[d86[a9o]].Url:this.Source[d86[a9o]].Url=z7w == q_I?d86[a9o] + O7a:q_I + d86[a9o] + O7a);if((this.ImageList=[],this.Down2ExcelBufferInfo || (this.Down2ExcelBufferInfo={}),this.g_LoadExcelBufferCfg || (this.g_LoadExcelBufferCfg={}),this._eventFunctions={},this.MarkupTagDelimiter?(this.MarkupTagSS=this.MarkupTagDelimiter[n4O],this.MarkupTagSE=this.MarkupTagDelimiter[i1f],this.MarkupTagES=this.MarkupTagDelimiter[m$I],this.MarkupTagEE=this.MarkupTagDelimiter[S8T]):(this.MarkupTagSS=v1d,this.MarkupTagSE=B1Z,this.MarkupTagES=B6Q,this.MarkupTagEE=B1Z),this.IB_DELIMITER_ROW=p$z,this.IB_DELIMITER_COL=M50,this.IB_DELIMITER_SHEET=d3O,this.IB_DELIMITER_END=e_t,this.IB_DELIMITER_TITLE_NEWLINE=e_t,this.IB_DELIMITER_TITLE_BACKSLASH=M50,this.IB_DELIMITER_COLOR=W7Z,this.IB_DELIMITER_TREE_INDENT=y_v,this.DataRows=this.MultiRecord && i1f & this.MultiRecordShape?this.MultiRecordMax:i1f,this.SearchSync=n4O,this.MultiRecord && i1f & this.MultiRecordShape)){(this._DownMultiMap=[],this.MultiRecord && i1f & this.MultiRecordShape && this.MultiFootMerge && (this._DownMultiFootMap=[]));for(var X5q=n4O;X5q < this.DataRows;X5q++){this._DownMultiMap.push([]);for(var k6b=n4O;k6b < this.MultiHeaderMap[n4O].length;k6b++)this._DownMultiMap[X5q][k6b]=this.MultiHeaderMap[X5q][k6b];}for(X5q=n4O;X5q < this.DataRows;X5q++)for(k6b=n4O;k6b < this.MultiHeaderMap[n4O].length;k6b++)if(this._DownMultiMap[X5q][k6b] && i1f < this.Cols[this._DownMultiMap[X5q][k6b]].RecordColSpan && i1f < this.Cols[this._DownMultiMap[X5q][k6b]].RecordRowSpan)for(var t_b=n4O;t_b < this.Cols[this._DownMultiMap[X5q][k6b]].RecordRowSpan;t_b++){for(var D1_=i1f;D1_ < this.Cols[this._DownMultiMap[X5q][k6b]].RecordColSpan;D1_++)this._DownMultiMap[X5q + t_b][k6b + D1_]=void n4O;n4O < t_b && (this._DownMultiMap[X5q + t_b][k6b]=void n4O);}else if(this._DownMultiMap[X5q][k6b] && i1f < this.Cols[this._DownMultiMap[X5q][k6b]].RecordColSpan){for(t_b=i1f;t_b < this.Cols[this._DownMultiMap[X5q][k6b]].RecordColSpan;t_b++)this._DownMultiMap[X5q][k6b + t_b]=void n4O;k6b+=this.Cols[this._DownMultiMap[X5q][k6b]].RecordColSpan - i1f;}else if(this._DownMultiMap[X5q][k6b] && i1f < this.Cols[this._DownMultiMap[X5q][k6b]].RecordRowSpan)for(t_b=i1f;t_b < this.Cols[this._DownMultiMap[X5q][k6b]].RecordRowSpan;t_b++)this._DownMultiMap[X5q + t_b][k6b]=void n4O;if(this._DownMultiFootMap){for(var g$Z,X5q=n4O;X5q < this.DataRows;X5q++){this._DownMultiFootMap.push([]);for(k6b=n4O;k6b < this.MultiHeaderMap[n4O].length;k6b++)this._DownMultiFootMap && (this._DownMultiFootMap[X5q][k6b]=this._DownMultiMap[X5q][k6b]);}for(g$Z=this.XF.firstChild;g$Z && y0j == g$Z.id;g$Z=g$Z.nextSibling);for(X5q=n4O;X5q < this.DataRows;X5q++)for(k6b=n4O;k6b < this.MultiFootMergeMap[n4O].length;k6b++)if(this._DownMultiFootMap[X5q][k6b] && i1f < g$Z[this._DownMultiFootMap[X5q][k6b] + f3y] && i1f < g$Z[this._DownMultiFootMap[X5q][k6b] + i2R])for(t_b=n4O;t_b < g$Z[this._DownMultiFootMap[X5q][k6b] + i2R];t_b++){for(D1_=i1f;D1_ < g$Z[this._DownMultiFootMap[X5q][k6b] + f3y];D1_++)this._DownMultiFootMap[X5q + t_b][k6b + D1_]=void n4O;n4O < t_b && (this._DownMultiFootMap[X5q + t_b][k6b]=void n4O);}else if(this._DownMultiFootMap[X5q][k6b] && i1f < g$Z[this._DownMultiFootMap[X5q][k6b] + f3y]){for(t_b=i1f;t_b < g$Z[this._DownMultiFootMap[X5q][k6b] + f3y];t_b++)this._DownMultiFootMap[X5q][k6b + t_b]=void n4O;k6b+=g$Z[this._DownMultiFootMap[X5q][k6b] + f3y] - i1f;}else if(this._DownMultiFootMap[X5q][k6b] && i1f < g$Z[this._DownMultiFootMap[X5q][k6b] + i2R])for(t_b=i1f;t_b < g$Z[this._DownMultiFootMap[X5q][k6b] + i2R];t_b++)this._DownMultiFootMap[X5q + t_b][k6b]=void n4O;}}},q._removeForm=function(w$A){w$A=s.getElementById(w$A);w$A && (w$A.innerHTML=D84,s.body.removeChild(w$A));},q._removeHTMLTag=function(N7m,s1a){if(D84 == N7m || M8J != typeof N7m)return z7w;switch(s1a){case i1f:return N7m.replace(/<([^>]*)>/gi,z7w);case m$I:return N7m.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*[^>]*)?(\s)*(\/)?>/gi,z7w);default:return N7m.replace(/<(\/)?([a-zA-Z]*)(\s[a-zA-Z]*=[^>]*)?(\s)*(\/)?>/gi,z7w);}},q._selectFileAction=function(G1B,s4i,L5j,H7s,F3X){var T64=".xls";var L1E=".xlsx";var d5e,M4z,y_n=z7w,U2_=z7w,o75=n4O,Q9Q={};if((Y5T == s4i?(Q9Q={".xls":i1f,".xlsx":i1f},y_n=o1D,U2_=A2a):W2X == s4i?(Q9Q={".":i1f,".txt":i1f,".csv":i1f},y_n=w5Y,U2_=q5H,F3X.indexOf(I9E) < n4O && (F3X+=I9E)):j$y == s4i && (Q9Q={".":i1f,".txt":i1f,".csv":i1f,".xls":i1f,".xlsx":i1f},y_n=o1D,U2_=q5H,F3X.indexOf(I9E) < n4O && (F3X+=I9E)),z7w != H7s))for((Q9Q={},o75=n4O,d5e=(M4z=H7s.split(U7e)).length);o75 < d5e;o75++)Q9Q[I9E + M4z[o75]]=i1f;z7w != F3X && (-i1f < F3X.indexOf(I9E) && Q9Q[H7s=F3X.substring(F3X.lastIndexOf(I9E),F3X.length).toLowerCase()]?(W2X != s4i && j$y != s4i || I9E != H7s || (F3X=F3X.substring(n4O,F3X.lastIndexOf(I9E))),G1B.target=y_n,G1B.submit(),L1E != H7s && T64 != H7s || (this.LoadFileType=Y5T),J.OnLoadFileSelect && J.OnLoadFileSelect(this,s4i,F3X)):this.ShowAlert(this.getMessage(U2_,h37),f6F));},q._setRowData=function(s6e,h7g,I7z,e2n,V7P){(s6e[h7g]=e2n,s6e[h7g + o$q]=V7P,s6e[h7g + R3b]=I7z);},q._setRowProperty=function(y3q,x82,z5E){(y3q.Kind=x82.Kind,y3q.id=x82.id,y3q.UnitPos=x82.UnitPos,y3q.SubSumRow=M8T === x82.Name,y3q.CumulateRow=x82.CumulateRow,y3q.RowMerge=x82.RowMerge,y3q.Status=z5E);},q._trim=function(h1s){return h1s=(h1s+=z7w).replace(a_W,z7w).replace(p1J,z7w);},q._validInputRow=function(j0Z,g13){var p67="F";var P_3="P";var v7q="D";var j6t="S";var b8I,U06,y4K=-i1f,t4Q=n4O,P8p={},D46={NoDataRow:i1f,GroupRow:i1f,CountRow:i1f,FillRow:i1f,ToolBar:i1f},J1L=n4O;if(g13)for((t4Q=n4O,U06=(g13=g13.split(U7e)).length);t4Q < U06;t4Q++)switch(g13[t4Q]){case e$m:P8p.Header=i1f;break;case v7q:P8p.Data=i1f;break;case p67:D46.Filter=i1f;break;case j6t:break;case P_3:J1L=i1f;}return (D84 != j0Z && K9S == typeof j0Z && void n4O !== j0Z.Kind?b8I=j0Z:(j0Z=this._getNumberValue(j0Z),isNaN(j0Z) || (b8I=this.getRowByIndex(j0Z))),b8I && (P8p[(y4K=b8I).Kind] && (y4K=-i1f),D46[b8I.id] && (y4K=-i1f),J1L && y0j === b8I.id && (y4K=-i1f),J1L && (M8T === b8I.Name || b8I.CumulateRow) && (y4K=-i1f)),y4K);},q.ExportData=function(S0C){var O7o="json";var H_V="xml";var w_0,i2j,i6O,U91,E5n,V3f,d8Q,j81,Y7e=[],o4o=n4O,e7w=z7w;if(D84 == S0C || void n4O === S0C)return this.InvalidValue;for((w_0=(S0C.type || S0C.Type || z7w).toLowerCase(),U91=S0C.colDelim || S0C.ColDelim || E9P,E5n=S0C.rowDelim || S0C.RowDelim || F7i,V3f=void n4O === S0C.mode || void n4O === S0C.Mode?n4O:D84,V3f=this._getNumberValue(V3f,n4O),S0C.Cols=S0C.Cols || S0C.cols,S0C.Cols=void n4O === S0C.Cols?[]:(S0C.Cols + z7w).split(U7e),d8Q=this._getBooleanValue(S0C.FormattedText,n4O),j81=this._getBooleanValue(S0C.StyleProperty,n4O),o4o=n4O,i2j=S0C.Cols.length);o4o < i2j;o4o++)(Q1f == w_0 && i1f === V3f && z7w === S0C.Cols[o4o] && Y7e.push({}),-i1f !== (i6O=this.Cols[S0C.Cols[o4o]]) && Y7e.push({Name:i6O.Name}));if(n4O === Y7e.length)for(e7w in this.Cols)Z3t == e7w || T4N == e7w || e7w == (this.RowIndex || L6W) && i1f != this.Cols[e7w].Visible || Y7e.push({Name:e7w});return H_V == w_0?this._exportXml(Y7e,d8Q,S0C.checkCol):O7o == w_0?this._exportJson(Y7e,d8Q,j81,S0C.checkCol):Q1f == w_0?this._exportCsv(Y7e,d8Q,U91,E5n,V3f,S0C.newLine || S0C.NewLine,S0C.checkCol):this.InvalidValue;},q.GetAutoSumPosition=function(){return this.FormulaRowPosition;},q.GetColIndexInfo=function(){var w3o,B2l,G4V=n4O,W8d=n4O,Y9B=this.ColNames.length;for((this.ColIndexInfo=[],G4V=n4O);G4V < Y9B;G4V++)for((W8d=n4O,B2l=(w3o=this.ColNames[G4V]).length);W8d < B2l;W8d++)Z3t !== w3o[W8d] && R5W !== w3o[W8d] && this.ColIndexInfo.push(w3o[W8d]);},q.GetColName=function(b88){return this.Cols[b88]?b88:this.SaveNameInfo[b88]?this.SaveNameInfo[b88].ColName:z7w;},q.GetDataRowHeight=function(){return this.RowHeight || this.MinRowHeight;},q.GetExcelRowHeight=function(G_L,c7z){var t5s=this._validInputRow(G_L),G_L=n4O;if(-i1f === t5s)return this.InvalidValue;if(!t5s.Visible)return G_L;if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict && t5s.r1){if(this.MultiRecord && i1f & this.MultiRecordShape && t5s.r1)for(var B0t=t5s.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,j4q=n4O;B0t;){if(j4q == c7z)return B0t.offsetHeight;(B0t=B0t.nextSibling,j4q++);}for(j4q=n4O;j4q < t5s.r1.childNodes.length;j4q++){var m4F=t5s.r1.childNodes[j4q].offsetHeight,J8P=J8P || m4F;n4O < m4F && m4F < J8P && (J8P=m4F);}G_L=J8P || this.MinRowHeight;}else G_L=(G_L=this.GetRHeight(t5s,c7z)) || this.MinRowHeight;return G_L;},q.GetFirstColA=function(x$Y,j6_){for(var Y0$=[Z3t,T4N],w94=this.ColNames,t4B=this.Cols,i0K=D84 == x$Y?(x$Y=n4O,w94.length):n4O == x$Y?i1f:i1f == x$Y?w94.length - i1f:(x$Y=w94.length - i1f,w94.length),U7p=x$Y;U7p < i0K;U7p++){for(var V69=n4O,e2A=w94[U7p];e2A[V69] && (-i1f < Y0$.indexOf(e2A[V69]) || !t4B[e2A[V69]].Visible && m$I != j6_ && (!j6_ || !t4B[e2A[V69]].Hidden));V69++);if(e2A[V69])return e2A[V69];}return D84;},q.GetHeaderBackColor=function(){var e$e,b$_=z7w,a0e=s.createElement(T6y);return (a0e.setAttribute(p5z,this.Style + u4s),a0e.style.visibility=i2O,a0e.style.position=h0S,s.body.appendChild(a0e),e$e=GetStyle(a0e),b$_=IBSheet._ibsUtil.getWebColor(e$e.backgroundColor),a0e.parentNode.removeChild(a0e),b$_=-i1f === b$_?this.InvalidValue:b$_);},q.GetHeaderFontColor=function(){var e2c,d5i=z7w,W8F=s.createElement(T6y);return (W8F.setAttribute(p5z,this.Style + T4Q),W8F.style.visibility=i2O,W8F.style.position=h0S,s.body.appendChild(W8F),e2c=GetStyle(W8F),d5i=IBSheet._ibsUtil.getWebColor(e2c.color),W8F.parentNode.removeChild(W8F),d5i=-i1f === d5i?this.InvalidValue:d5i);},q.GetLoadColNames=function(L2c,s2s){for(col=this.GetFirstColA(D84,m$I);col;col=this.GetNextColA(col))(s2s.DateStrictMode=this.DateStrictMode || this.Cols[col].DateStrictMode || this.Rows[col + k16],i1f == s2s.unMatchColHidden?this.Cols[col].Visible && L2c.push(col):col == (this.RowIndex || L6W) && n4O == this.Cols[col].Visible && h_4 == this.Cols[col].Def || T4N != col && L2c.push(col));},q.GetNextColA=function(n_z){if(!n_z)return D84;var p_d=this.Cols;if(!p_d[n_z])return D84;for(var W$K=p_d[n_z].Section,T0c=this.ColNames,x92=p_d[n_z].Pos + i1f;;){for(;T0c[W$K][x92] && Z3t == T0c[W$K][x92];)x92++;if(T0c[W$K][x92])return T0c[W$K][x92];if((x92=n4O,++W$K >= T0c.length))return D84;}},q.GetOrgType=function(m_Z,l8L){if(!m_Z || !l8L || m_Z.Page)return z7w;var a3i,l0J=m_Z[l8L + K02];return (D84 == (l0J=D84 == l0J && m_Z.Def?m_Z.Def[l8L + o$q]:l0J) && ((a3i=m_Z.Space?this.DefCols.C:this.Cols[l8L]) && (l0J=a3i.LegacyType),J77 != m_Z.Kind || CEditTypes[l0J] || Z3t == l0J || T4N == l8L || (l0J=Y3j)),l0J);},q.GetRHeight=function(O9r,Q4e){if(!O9r)return n4O;if(this.MultiRecord && i1f & this.MultiRecordShape && O9r.r1)for(var N6h=O9r.r1.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling,C2P=n4O;N6h;){if(C2P == Q4e)return N6h.offsetHeight;(N6h=N6h.nextSibling,C2P++);}if(IBSheet.BIE8Strict && !IBSheet.BIE9Strict){if(K7w != O9r.Kind)return O9r.Height || this.RowHeight;if(O9r.r1 && O9r.r1.offsetHeight - this.HeaderRowHeight >= this.HeaderRowHeight)return this.HeaderRowHeight;}if(O9r.r1)return O9r.r1.offsetHeight;var d7K=O9r.Height;return D84 != d7K?d7K:O9r.Page?this.GetPageHeight(O9r):D84 != (d7K=O9r.Def?O9r.Def.Height:d7K)?d7K:this.RowHeight;},q.GetSheetFontName=function(){var B1U="Dotum";var V6b,F4m=B1U;return (this.SheetFontName?F4m=this.SheetFontName:(V6b=this.XH.firstChild) && V6b.r1 && (F4m=GetStyle(V6b.r1).fontFamily.replace(/\"/gi,z7w).split(E9P)[n4O]),F4m);},q.GetSheetFontSize=function(){var v7r="px";var X0G=12;var P2z,X11=X0G;return (this.SheetFontSize?X11=this.SheetFontSize:(P2z=this.XH.firstChild) && P2z.r1 && (X11=GetStyle(P2z.r1).fontSize.replace(v7r,z7w)),parseInt(X11,n1r));},q.GetSheetPageLength=function(){var J9d=n4O;return J9d=this.Paging?this.PageLength:J9d;},q.GetStatusValue=function(U5x){var h7I=z7w,a4T=this.StatusCol,k6J=this.DataRows;if(!a4T)return h7I;if(i1f < k6J){for(var V7v=this.GetUnitBaseRow(U5x);V7v;V7v=this.getNextRow(V7v))if(K13 == this.getAttribute(V7v,a4T,o$q)){h7I=V7v[a4T];break;}}else h7I=U5x[a4T] || z7w;return h7I;},q.GetSumBackColor=function(P9r){var D1a=z7w,L0T=this.Rows.FormulaRow;return ((D1a=L0T && L0T.Background || this.SumBackColor) || (L0T=this.getCell(L0T,P9r || this.GetFirstColA())) && (D1a=GetStyle(L0T).backgroundColor),IBSheet._ibsUtil.getWebColor(D1a));},q.GetTheme=function(){return this.Style;},q.LoadFile=function(i3N){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this._prepareExportSetting());var n5a,W8q,H5f,I6W,i3N=J._ibsUtil.cloneArray(i3N),S6R={},i0e={},P5o=z7w,l$k=[],S6R=(J.g_targetExcelSheetID=this.id,J.g_isLoadExcelBuffer || (J.g_LoadExcelSheetID=[]),J.g_LoadExcelSheetID.push(this.id),void n4O !== this.LoadExcelConfig && (S6R=this.LoadExcelConfig),void n4O !== this.LoadTextConfig && (i0e=this.LoadTextConfig),(i3N=void n4O === i3N?[]:i3N).append=this._getDefault(void n4O !== i3N.append?i3N.append:i3N.Append,this._getDefault(S6R.append,!i1f)),i3N.columnMapping=this._getDefault(void n4O !== i3N.columnMapping?i3N.columnMapping:i3N.ColumnMapping,this._getDefault(S6R.columnMapping,z7w)),i3N.debugMode=this._getDefault(void n4O !== i3N.debugMode?i3N.debugMode:i3N.DebugMode,this._getDefault(S6R.debugMode,!i1f)),i3N.endRow=this._getDefault(void n4O !== i3N.endRow?i3N.endRow:i3N.EndRow,this._getDefault(S6R.endRow,n4O)),i3N.extendParam=this._getDefault(void n4O !== i3N.extendParam?i3N.extendParam:i3N.ExtendParam,this._getDefault(S6R.extendParam,z7w)),i3N.fileExt=this._getDefault(void n4O !== i3N.fileExt?i3N.fileExt:i3N.FileExt,this._getDefault(S6R.fileExt,z7w)),i3N.maxFileSize=this._getDefault(void n4O !== i3N.maxFileSize?i3N.maxFileSize:i3N.MaxFileSize,this._getDefault(S6R.maxFileSize,n4O,V2U),V2U),i3N.merge=this._getDefault(void n4O !== i3N.merge?i3N.merge:i3N.Merge,this._getDefault(S6R.merge,i1f)),i3N.mode=this._getDefault(void n4O !== i3N.mode?i3N.mode:i3N.Mode,this._getDefault(S6R.mode,h3Y)),i3N.serverFile=this._getDefault(void n4O !== i3N.serverFile?i3N.serverFile:i3N.ServerFile,this._getDefault(S6R.serverFile,z7w)),i3N.startCol=this._getDefault(void n4O !== i3N.startCol?i3N.startCol:i3N.StartCol,this._getDefault(S6R.startCol,i1f)),i3N.startRow=this._getDefault(void n4O !== i3N.startRow?i3N.startRow:i3N.StartRow,this._getDefault(S6R.startRow,i1f)),i3N.unMatchColHidden=this._getDefault(void n4O !== i3N.unMatchColHidden?i3N.unMatchColHidden:i3N.UnMatchColHidden,this._getDefault(S6R.unMatchColHidden,z7w)),i3N.useDOM=this._getDefault(void n4O !== i3N.useDOM?i3N.useDOM:i3N.UseDOM,this._getDefault(S6R.useDOM,!i1f)),i3N.workSheetName=this._getDefault(void n4O !== i3N.workSheetName?i3N.workSheetName:i3N.WorkSheetName,this._getDefault(S6R.workSheetName,z7w)),i3N.workSheetNo=this._getDefault(void n4O !== i3N.workSheetNo?i3N.workSheetNo:i3N.WorkSheetNo,this._getDefault(S6R.workSheetNo,i1f)),i3N.encoding=this._getDefault(void n4O !== i3N.encoding?i3N.encoding:i3N.Encoding,this._getDefault(i0e.encoding,z7w)),i3N.deli=this._getDefault(void n4O !== i3N.deli?i3N.deli:i3N.Deli,this._getDefault(i0e.deli,t$s)),i3N.colSeparator=this._getDefault(void n4O !== i3N.colSeparator?i3N.colSeparator:i3N.ColSeparator,this._getDefault(i0e.colSeparator,t$s)),t$s !== i3N.colSeparator && i3N.colSeparator !== i3N.deli && (i3N.deli=i3N.colSeparator),i3N.skipEmptyRow=this._getDefault(void n4O !== i3N.skipEmptyRow?i3N.skipEmptyRow:i3N.SkipEmptyRow,this._getDefault(S6R.skipEmptyRow,!n4O)),i3N.colLength=this._getDefault(void n4O !== i3N.colLength?i3N.colLength:i3N.ColLength,this._getDefault(i0e.colLength,z7w)),i3N.colLength2Byte=this._getDefault(void n4O !== i3N.colLength2Byte?i3N.colLength2Byte:i3N.ColLength2Byte,this._getDefault(i0e.colLength2Byte,!n4O)),i3N.emptyChar=this._getDefault(void n4O !== i3N.emptyChar?i3N.emptyChar:i3N.EmptyChar,this._getDefault(i0e.emptyChar,v4y)),i3N.fillRight=this._getDefault(void n4O !== i3N.fillRight?i3N.fillRight:i3N.FillRight,this._getDefault(i0e.fillRight,!n4O)),i3N.colLength);if((z7w != S6R && d8b != S6R && (U7e == (S6R=U7e == S6R.substring(n4O,i1f)?S6R.substring(i1f):S6R).substring(S6R.length - i1f) && (S6R=S6R.substring(n4O,S6R.length - i1f)),i3N.colLength=S6R),void n4O !== i3N.DialogType && (i3N.dialogType=i3N.DialogType),void n4O !== i3N.Action && (i3N.action=i3N.Action),void n4O !== i3N.LoadAction && (i3N.loadAction=i3N.LoadAction),void n4O !== i3N.DialogTheme && (i3N.dialogTheme=i3N.DialogTheme),void n4O !== i3N.DialogSheetTheme && (i3N.dialogSheetTheme=i3N.DialogSheetTheme),void n4O !== i3N.DisableSheet && (i3N.disableSheet=i3N.DisableSheet),void n4O !== i3N.CallBack && (i3N.callBack=i3N.CallBack),this._uploadDialogDelim=i3N.deli,this._uploadDialogLoadType=i3N.dialogType,i3N.action && o3s == typeof i3N.action?this._uploadDialogAction=i3N.action:this._uploadDialogAction=D84,i3N.loadAction && o3s == typeof i3N.loadAction?this._uploadDialogLoadFile=i3N.loadAction:this._uploadDialogLoadFile=D84,i3N.dialogTheme?this._uploadDialogTheme=i3N.dialogTheme:this._uploadDialogTheme=D84,i3N.dialogSheetTheme?this._uploadDialogSheetTheme=i3N.dialogSheetTheme:this._uploadDialogSheetTheme=D84,i3N.disableSheet?this._uploadDisableSheet=i1f:this._uploadDisableSheet=D84,i3N.callBack && o3s == typeof i3N.callBack?this._uploadCallBack=i3N.callBack:this._uploadCallBack=D84,this._autoExcelModeCheck(i3N,this.AutoExcelMode,j$y,!i1f,!i1f))){if((this.GetLoadColNames(l$k,i3N),i0e=this._getHeaderText(l$k),n5a=(S6R=this._getColInfo(i3N,l$k,!i1f)).name,W8q=S6R.saveName,H5f=S6R.type,I6W=S6R.format,S6R=S6R.datePattern,P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o+=this._makeColumnTag(k16,i3N.DateStrictMode?i1f:n4O)) + this._makeColumnTag(E11,i3N.append?i1f:n4O)) + this._makeColumnTag(d45,i3N.unMatchColHidden)) + this._makeColumnTag(D8L,this.SearchMode)) + this._makeColumnTag(I00,i3N.extendParam)) + this._makeColumnTag(J4f,l$k.length)) + this._makeColumnTag(H1I,this.getHeaderRows().length)) + this._makeColumnTag(l0c,i3N.startRow)) + this._makeColumnTag(q_S,i3N.endRow)) + this._makeColumnTag(W5B,i3N.startCol)) + this._makeColumnTag(Q8A,i3N.workSheetNo)) + this._makeColumnTag(d8_,i3N.workSheetName)) + this._makeColumnTag(p87,i3N.mode.replace(/ /g,z7w).toUpperCase())) + this._makeColumnTag(t4$,void n4O !== this.StatusCol?this.StatusCol:z7w)) + this._makeColumnTag(b_3,i3N.columnMapping)) + this._makeColumnTag(j69,n5a)) + this._makeColumnTag(U83,W8q)) + this._makeColumnTag(T4Q,i0e)) + this._makeColumnTag(P8M,n5a)) + this._makeColumnTag(V2_,H5f)) + this._makeColumnTag(y_G,I6W)) + this._makeColumnTag(o5T,S6R)) + this._makeColumnTag(O3R,this.id)) + this._makeColumnTag(L7f,i3N.deli)) + this._makeColumnTag(s5c,i3N.encoding)) + this._makeColumnTag(Y6_,i3N.merge)) + this._makeColumnTag(x3Q,this.UseJsonAttribute)) + this._makeColumnTag(A62,i3N.serverFile),l$k=this._getDefault(this.Source.LoadExcel.Url,B$9),l$k=J._ibsUtil.getFullPath(l$k),P5o+=this._makeColumnTag(z7B,l$k),o3s != typeof Q.postMessage && K9S != typeof Q.postMessage || (P5o+=this._makeColumnTag(K0u,this.id)),P5o=(P5o=(P5o=(P5o=(P5o=(P5o=(P5o+=this._makeColumnTag(T1Y,i3N.useDOM?i1f:n4O)) + this._makeColumnTag(J1g,i3N.colLength)) + this._makeColumnTag(b4c,i3N.colLength2Byte?i1f:n4O)) + this._makeColumnTag(I3K,i3N.emptyChar)) + this._makeColumnTag(f7u,i3N.fillRight?i1f:n4O)) + this._makeColumnTag(F8g,i3N.cutText?i1f:n4O)) + this._makeColumnTag(M2J,i3N.skipEmptyRow?i1f:n4O),i3N.debugMode || i3N.DebugMode))return P5o;this._makeLoadForm(j$y,!i1f,i3N.fileExt,P5o,i3N.maxFileSize,i3N.serverFile,i3N.sendParam);}},q.mUnMatchColHidden=function(E5V){for(var T63=E5V.split(U7e),t_d=i1f;t_d < T63.length;t_d++)n4O == this.GetColHidden(T63[t_d]) && this.SetColHidden(T63[t_d],!n4O);},q.ShowAlert=function(T9x,X4m,O2F,U0z){var K4V="Ok";var E2s=this;return this.MessageShowLevel && f6F !== this.MessageShowLevel || f6F === X4m?(this.AlertProgress=i1f,f6F != X4m && IBSheet.OnDebugMsg && IBSheet.OnDebugMsg(this,T9x,X4m),this.ShowMsgMode?O2F?confirm(T9x)?(this.AlertProgress=n4O,!(this._invalidInputActionProc=n4O)):(this.AlertProgress=n4O,this._invalidInputActionProc=n4O,!i1f):void setTimeout(function(){(alert(T9x),o3s == typeof U0z && U0z(E2s),E2s.AlertProgress=n4O);},F$K):(IBSheet.OnMessage?IBSheet.OnMessage(this,T9x,X4m,O2F):this.showMessageTime(T9x,n4O,D84,[K4V]),this.ConfirmInfo?(this.ConfirmInfo=n4O,this.AlertProgress=n4O,!(this._invalidInputActionProc=n4O)):(this.AlertProgress=n4O,this._invalidInputActionProc=n4O,!i1f))):-i1f;},q.Down2Text=function(X$2){var h3U="UTF-8(BOM)";var t2U="Down2Text.jsp";var c0n,w5q,l53,r1b=this,m9C=J._ibsUtil.cloneArray(X$2),u$W=(void n4O === m9C && (m9C=[]),this._prepareExportSetting(),!m9C || m9C.DebugMode || m9C.debugMode || this.showMessage(this.getMessage(P$b)),X$2=this.Down2TextConfig,m9C.checkBoxOffValue=this._getDefault(void n4O !== m9C.checkBoxOffValue?m9C.checkBoxOffValue:m9C.CheckBoxOffValue,this._getDefault((X$2=void n4O === X$2?{}:X$2).checkBoxOffValue,S9$)),m9C.checkBoxOnValue=this._getDefault(void n4O !== m9C.checkBoxOnValue?m9C.checkBoxOnValue:m9C.CheckBoxOnValue,this._getDefault(X$2.checkBoxOnValue,H7j)),m9C.debugMode=this._getDefault(void n4O !== m9C.debugMode?m9C.debugMode:m9C.DebugMode,this._getDefault(X$2.debugMode,!i1f)),m9C.downCols=this._getDefault(void n4O !== m9C.downCols?m9C.downCols:m9C.DownCols,this._getDefault(X$2.downCols,z7w)),m9C.downCombo=this._getDefault(void n4O !== m9C.downCombo?m9C.downCombo:m9C.DownCombo,this._getDefault(X$2.downCombo,Y3j)).toUpperCase(),m9C.downHeader=this._getDefault(void n4O !== m9C.downHeader?m9C.downHeader:m9C.DownHeader,this._getDefault(X$2.downHeader,!n4O)),m9C.downRows=this._getDefault(void n4O !== m9C.downRows?m9C.downRows:m9C.DownRows,this._getDefault(X$2.downRows,z7w)),m9C.downSum=this._getDefault(void n4O !== m9C.downSum?m9C.downSum:m9C.DownSum,this._getDefault(X$2.downSum,!n4O)),m9C.downTreeHide=this._getDefault(void n4O !== m9C.downTreeHide?m9C.downTreeHide:m9C.DownTreeHide,this._getDefault(X$2.downTreeHide,!!this.ExcelTreeMode)),m9C.excludeSubSum=this._getDefault(void n4O !== m9C.excludeSubSum?m9C.excludeSubSum:m9C.ExcludeSubSum,this._getDefault(X$2.excludeSubSum,n4O)),m9C.extendParam=this._getDefault(void n4O !== m9C.extendParam?m9C.extendParam:m9C.ExtendParam,this._getDefault(X$2.extendParam,z7w)),m9C.extendParamMethod=this._getDefault(void n4O !== m9C.extendParamMethod?m9C.extendParamMethod:m9C.ExtendParamMethod,this._getDefault(X$2.extendParamMethod,z7w)),m9C.fileName=this._getDefault(void n4O !== m9C.fileName?m9C.fileName:m9C.FileName,this._getDefault(X$2.fileName,Y3j)),m9C.RequiredMark=this._getDefault((m9C.RequiredMark,m9C.RequiredMark),this._getDefault(X$2.RequiredMark,!n4O)),m9C.multipart=this._getDefault(void n4O !== m9C.multipart?m9C.multipart:m9C.Multipart,this._getDefault(X$2.multipart,!n4O)),m9C.rowDelim=this._getDefault(void n4O !== m9C.rowDelim?m9C.rowDelim:m9C.RowDelim,this._getDefault(X$2.rowDelim,S$4)),m9C.sheetName=this._getDefault(void n4O !== m9C.sheetName?m9C.sheetName:m9C.SheetName,this._getDefault(X$2.sheetName,q9Z)),m9C.colLength=this._getDefault(void n4O !== m9C.colLength?m9C.colLength:m9C.ColLength,this._getDefault(X$2.colLength,z7w)),m9C.colLength2Byte=this._getDefault(void n4O !== m9C.colLength2Byte?m9C.colLength2Byte:m9C.ColLength2Byte,this._getDefault(X$2.colLength2Byte,!n4O)),m9C.emptyChar=this._getDefault(void n4O !== m9C.emptyChar?m9C.emptyChar:m9C.EmptyChar,this._getDefault(X$2.emptyChar,v4y)),m9C.fillRight=this._getDefault(void n4O !== m9C.fillRight?m9C.fillRight:m9C.FillRight,this._getDefault(X$2.fillRight,!n4O)),m9C.cutText=this._getDefault(void n4O !== m9C.cutText?m9C.cutText:m9C.CutText,this._getDefault(X$2.cutText,!i1f)),m9C.timeout=this._getDefault(void n4O !== m9C.timeout?m9C.timeout:m9C.Timeout,this._getDefault(X$2.timeout,n4O)),m9C.useXhr=this._getDefault(void n4O !== m9C.useXhr?m9C.useXhr:m9C.UseXhr,this._getDefault(X$2.useXhr,!i1f)),m9C.reqHeader=m9C.reqHeader || m9C.ReqHeader || X$2.reqHeader,m9C.sendParam=m9C.sendParam || m9C.SendParam || X$2.sendParam,m9C.fileName.toLowerCase().split(I9E,-i1f));if((Q1f == u$W[u$W.length - i1f]?(m9C.colDelim=this._getDefault(void n4O !== m9C.colDelim?m9C.colDelim:m9C.ColDelim,this._getDefault(X$2.colDelim,E9P)),m9C.downloadEncoding=this._getDefault(void n4O !== m9C.downloadEncoding?m9C.downloadEncoding:m9C.DownloadEncoding,this._getDefault(X$2.downloadEncoding,h3U))):(m9C.colDelim=this._getDefault(void n4O !== m9C.colDelim?m9C.colDelim:m9C.ColDelim,this._getDefault(X$2.colDelim,t$s)),m9C.downloadEncoding=this._getDefault(void n4O !== m9C.downloadEncoding?m9C.downloadEncoding:m9C.DownloadEncoding,this._getDefault(X$2.downloadEncoding,z7w))),this._autoExcelModeCheck(m9C,this.AutoExcelMode,W2X,!n4O,!i1f)))return (z7w != m9C.downRows && m9C.downTreeHide && (m9C.downTreeHide=n4O),m9C.downRows=U7e + m9C.downRows + U7e,d8b != (u$W=m9C.downCols) && (U7e == (u$W=U7e == u$W.substring(n4O,i1f)?u$W.substring(i1f):u$W).substring(u$W.length - i1f) && (u$W=u$W.substring(n4O,u$W.length - i1f)),m9C.downCols=u$W),z7w != (X$2=m9C.colLength) && d8b != X$2 && (U7e == (X$2=U7e == X$2.substring(n4O,i1f)?X$2.substring(i1f):X$2).substring(X$2.length - i1f) && (X$2=X$2.substring(n4O,X$2.length - i1f)),m9C.colLength=X$2),void n4O !== this.Source.Down2Text.Url && z7w != this.Source.Down2Text.Url || (this.Source.Down2Text.Url=t2U),c0n=this.Source.Down2Text.Url,w5q=m9C.extendParam,l53=m9C.extendParamMethod,this._getDown2Text(m9C,function(F1w){r1b._sendDown(F1w,c0n,w5q,l53,m9C.multipart,W2X,m9C.debugMode,m9C.timeout,m9C.useXhr,J._ibsUtil.getFileName(m9C.fileName,I31),m9C.sendParam,m9C.reqHeader);}));setTimeout(function(){r1b.hideMessage();},n1r);},q.GetDown2TextConfig=function(){return this.Down2TextConfig;},q.GetDown2TextUrl=function(){var H3q=z7w;return H3q=this.Source.Down2Text.Url?this.Source.Down2Text.Url:H3q;},q.GetLoadTextConfig=function(){return this.LoadTextConfig || ({});},q.GetLoadTextUrl=function(){var e9i=z7w;return e9i=this.Source.LoadText.Url?this.Source.LoadText.Url:e9i;},q.LoadText=function(R1I){(this.HasLoadedExcelData && delete this.HasLoadedExcelData,this.LoadFileType=W2X);var v$B,g3p,P4w,S3Y,R1I=J._ibsUtil.cloneArray(R1I),h5P={},K1u=z7w,Y_5=[],h5P=(void n4O === R1I && (R1I=[]),void n4O !== this.LoadTextConfig && (h5P=this.LoadTextConfig),this._prepareExportSetting(),R1I.append=this._getDefault(void n4O !== R1I.append?R1I.append:R1I.Append,this._getDefault(h5P.append,!i1f)),R1I.fileExt=this._getDefault(void n4O !== R1I.fileExt?R1I.fileExt:R1I.FileExt,this._getDefault(h5P.fileExt,z7w)),R1I.maxFileSize=this._getDefault(void n4O !== R1I.maxFileSize?R1I.maxFileSize:R1I.MaxFileSize,this._getDefault(h5P.maxFileSize,n4O,V2U)),R1I.mode=this._getDefault(void n4O !== R1I.mode?R1I.mode:R1I.Mode,this._getDefault(h5P.mode,h3Y)),R1I.encoding=this._getDefault(void n4O !== R1I.encoding?R1I.encoding:R1I.Encoding,this._getDefault(h5P.encoding,z7w)),R1I.deli=this._getDefault(void n4O !== R1I.deli?R1I.deli:R1I.Deli,this._getDefault(h5P.deli,t$s)),R1I.colSeparator=this._getDefault(void n4O !== R1I.colSeparator?R1I.colSeparator:R1I.ColSeparator,this._getDefault(h5P.colSeparator,t$s)),t$s !== R1I.colSeparator && R1I.colSeparator !== R1I.deli && (R1I.deli=R1I.colSeparator),R1I.colLength=this._getDefault(void n4O !== R1I.colLength?R1I.colLength:R1I.ColLength,this._getDefault(h5P.colLength,z7w)),R1I.colLength2Byte=this._getDefault(void n4O !== R1I.colLength2Byte?R1I.colLength2Byte:R1I.ColLength2Byte,this._getDefault(h5P.colLength2Byte,!n4O)),R1I.emptyChar=this._getDefault(void n4O !== R1I.emptyChar?R1I.emptyChar:R1I.EmptyChar,this._getDefault(h5P.emptyChar,v4y)),R1I.fillRight=this._getDefault(void n4O !== R1I.fillRight?R1I.fillRight:R1I.FillRight,this._getDefault(h5P.fillRight,!n4O)),R1I.hideSeq=V4j == typeof R1I.hideSeq && n4O <= R1I.hideSeq && R1I.hideSeq <= m$I?R1I.hideSeq:m$I,R1I.useXhr=this._getDefault((R1I.useXhr,R1I.useXhr),this._getDefault(h5P.useXhr,!i1f)),R1I.reqHeader=R1I.reqHeader || h5P.reqHeader,R1I.sendParam=R1I.sendParam || h5P.sendParam,R1I.colLength);(z7w != h5P && d8b != h5P && (U7e == (h5P=U7e == h5P.substring(n4O,i1f)?h5P.substring(i1f):h5P).substring(h5P.length - i1f) && (h5P=h5P.substring(n4O,h5P.length - i1f)),R1I.colLength=h5P),void n4O !== R1I.DialogType && (R1I.dialogType=R1I.DialogType),this._uploadDialogDelim=R1I.deli,this._uploadDialogLoadType=R1I.dialogType,this._autoExcelModeCheck(R1I,this.AutoExcelMode,W2X,!i1f,!i1f) && (this.GetLoadColNames(Y_5,R1I),h5P=this._getHeaderText(Y_5),v$B=(Y_5=this._getColInfo(R1I,Y_5,!i1f)).name,Y_5.saveName,g3p=Y_5.type,P4w=Y_5.format,S3Y=Y_5.datePattern,dataFormat=Y_5.dataFormat,K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u=(K1u+=this._makeColumnTag(k16,R1I.DateStrictMode?i1f:n4O)) + this._makeColumnTag(p87,R1I.mode.replace(/ /g,z7w).toUpperCase())) + this._makeColumnTag(L7f,R1I.deli)) + this._makeColumnTag(E11,R1I.append?i1f:n4O)) + this._makeColumnTag(D8L,this.SearchMode)) + this._makeColumnTag(I00,R1I.extendParam)) + this._makeColumnTag(J4f,this.ColCount)) + this._makeColumnTag(X81,dataFormat)) + this._makeColumnTag(H1I,this.getHeaderRows().length)) + this._makeColumnTag(t4$,void n4O !== this.StatusCol?this.StatusCol:z7w)) + this._makeColumnTag(j69,v$B)) + this._makeColumnTag(T4Q,h5P)) + this._makeColumnTag(P8M,v$B)) + this._makeColumnTag(V2_,g3p)) + this._makeColumnTag(y_G,P4w)) + this._makeColumnTag(o5T,S3Y)) + this._makeColumnTag(s5c,R1I.encoding)) + this._makeColumnTag(J1g,R1I.colLength)) + this._makeColumnTag(b4c,R1I.colLength2Byte?i1f:n4O)) + this._makeColumnTag(I3K,R1I.emptyChar)) + this._makeColumnTag(f7u,R1I.fillRight?i1f:n4O),o3s != typeof Q.postMessage && K9S != typeof Q.postMessage || (K1u+=this._makeColumnTag(K0u,this.id)),R1I.useXhr || R1I.reqHeader && K9S == typeof R1I.reqHeader?this._makeLoadXhr(W2X,K1u,R1I.maxFileSize,R1I.sendParam,R1I.fileExt,R1I.reqHeader):this._makeLoadForm(W2X,!i1f,R1I.fileExt,K1u,R1I.maxFileSize,R1I.serverFile,R1I.sendParam)));},q.SetDown2TextConfig=function(m27){(this.Down2TextConfig=J._ibsUtil.cloneArray(m27),void n4O !== this.Down2TextConfig.downHeader && (H7j === this.Down2TextConfig.downHeader?this.Down2TextConfig.downHeader=!n4O:S9$ === this.Down2TextConfig.downHeader && (this.Down2TextConfig.downHeader=!i1f)),void n4O !== this.Down2TextConfig.downSum && (H7j === this.Down2TextConfig.downSum?this.Down2TextConfig.downSum=!n4O:S9$ === this.Down2TextConfig.downSum && (this.Down2TextConfig.downSum=!i1f)),void n4O !== this.Down2TextConfig.downTreeHide && (H7j === this.Down2TextConfig.downTreeHide?this.Down2TextConfig.downTreeHide=!n4O:S9$ === this.Down2TextConfig.downTreeHide && (this.Down2TextConfig.downTreeHide=!i1f)),void n4O !== this.Down2TextConfig.RequiredMark && (H7j === this.Down2TextConfig.RequiredMark?this.Down2TextConfig.RequiredMark=!n4O:S9$ === this.Down2TextConfig.RequiredMark && (this.Down2TextConfig.RequiredMark=!i1f)),void n4O !== this.Down2TextConfig.multipart && (H7j === this.Down2TextConfig.multipart?this.Down2TextConfig.multipart=!n4O:S9$ === this.Down2TextConfig.multipart && (this.Down2TextConfig.multipart=!i1f)));},q.SetDown2TextUrl=function(V3G){(this.Source.Down2Text || (this.Source.Down2Text={}),this.Source.Down2Text.Url=V3G);},q.SetLoadTextConfig=function(P83){(this.LoadTextConfig=J._ibsUtil.cloneArray(P83),void n4O !== this.LoadTextConfig.append && (H7j === this.LoadTextConfig.append?this.LoadTextConfig.append=!n4O:S9$ === this.LoadTextConfig.append && (this.LoadTextConfig.append=!i1f)));},q.SetLoadTextUrl=function(A_e){(this.Source.LoadText || (this.Source.LoadText={}),this.Source.LoadText.Url=A_e);},q._exportCsv=function(P5t,G0t,w$B,m4o,w$L,T4y,K6b){for(var l$e,r9x,i8x=[],P0i=D84,l6e=n4O,J3_=[],Z9J=z7w,d2H=i1f < this.DataRows,P0i=this.getFirstRow(D84,B2V);P0i;P0i=this.getNextRow(P0i))if(!P0i || y0j !== P0i.id && M8T !== P0i.Name && U8Z !== P0i.Name){for((l6e=n4O,l$e=P5t.length);l6e < l$e;l6e++)if((r9x=P5t[l6e],!d2H || P0i.UnitPos == r9x.UnitPos)){if((Z9J=i1f == w$L && void n4O === r9x.Name?z7w:G0t?this._getCellText(P0i,r9x.Name):this._getCellValue(P0i,r9x.Name),r9x.Name === K6b && i1f != Z9J))break;(void n4O !== T4y && (Z9J=Z9J.replace(/\r\n/g,T4y).replace(/\n/g,T4y)),J3_.push(Z9J));}d2H && P0i.UnitPos != this.DataRows - i1f || n4O < J3_.length && (i8x.push(J3_.join(w$B)),J3_=[]);}return i8x=i8x.join(m4o);},q._getDown2Text=function(y7I,l43){var u5s="ColDelim";var A9P="DownloadEncoding";var L1X="RowDelim";var a6o,I1U,L1H=[],m4V=this,e53=z7w,j_x=d8b != y7I.downRows,f_m=[],r6V=(f_m=this.MultiRecord && i1f & this.MultiRecordShape?this._DownMultiMap[n4O]:this._getDownColNames(y7I)).length;return n4O == r6V?(this.hideMessage(),IBSheet.OnDownFinish && IBSheet.OnDownFinish(this,W2X,!i1f),-i1f):(j_x={from:W2X,cfg:y7I,sheetDesign:!i1f,isTreeLevel:n4O,isDownRows:j_x,isDownRowVisible:n4O,rowHeights:[],downColNames:f_m,downColNamesLength:r6V,data:L1H,p:i1f,headerRows:n4O,isHeaderMerge:n4O},y7I.downHeader && (I1U=this._getHeaderData(j_x),j_x.p=I1U.p),i1f != J.g_isDirectDown2Excel && (I1U=this._getBodyData(j_x)).p,this.fileDownloadCheckToken=new Date().getTime(),i1f != y7I.useXhr && (J.fileDownloadCheckTimer=Q.setInterval(function(){var a5E=m4V._getCookie(j5R);(m4V._getCookie(h2p) && (s.cookie=S6A,m4V.FileDownloadError=!n4O),a5E == m4V.fileDownloadCheckToken && (m4V.fileDownloadCheckToken=D84,m4V._finishDownload(W2X)));},b29)),e53+=this._makeColumnTag(W0m,this.fileDownloadCheckToken),j_x=(r6V=this._getColInfo(y7I,f_m,n4O)).saveName,I1U=r6V.type,f_m=r6V.format,r6V=r6V.orgFormat,(a6o=location.href.substring(location.href.indexOf(E2O) + m$I).split(Y6L))[n4O]=z7w,a6o[a6o.length - i1f]=z7w,e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53=(e53+=this._makeColumnTag(U8A,a6o.join(Y6L))) + this._makeColumnTag(P0n,J._ibsUtil.getFileName(y7I.fileName,I31))) + this._makeColumnTag(L1X,y7I.rowDelim)) + this._makeColumnTag(u5s,y7I.colDelim)) + this._makeColumnTag(I00,y7I.extendParam)) + this._makeColumnTag(j69,j_x)) + this._makeColumnTag(E1y,I1U)) + this._makeColumnTag(U$Q,f_m)) + this._makeColumnTag(z5f,r6V)) + this._makeColumnTag(S1n,y7I.downHeader?i1f:n4O)) + this._makeColumnTag(J1g,y7I.colLength)) + this._makeColumnTag(b4c,y7I.colLength2Byte?i1f:n4O)) + this._makeColumnTag(I3K,y7I.emptyChar)) + this._makeColumnTag(f7u,y7I.fillRight?i1f:n4O)) + this._makeColumnTag(F8g,y7I.cutText?i1f:n4O)) + this._makeColumnTag(A9P,y7I.downloadEncoding)) + this.IB_DELIMITER_ROW,L1H[n4O]=e53,y7I.debugMode?(this.hideMessage(),L1H.join(z7w)):void (l43 && l43(L1H.join(z7w))));},X=q,(n4O,J.__.each)([{from:C_E,to:j8c},{from:z89,to:z1b},{from:t7m,to:D0E},{from:R_L,to:y03},{from:s92,to:L40},{from:D8y,to:n49},{from:U1z,to:h2h},{from:z0G,to:k1v},{from:f_f,to:n4L},{from:J0v,to:Z_f},{from:G0n,to:A_8},{from:Q27,to:N2_},{from:e8H,to:Z2B},{from:C7n,to:T4n},{from:X9_,to:Y3a},{from:Y2S,to:G06},{from:H5x,to:o56},{from:m7I,to:i8v},{from:R5Q,to:E4w},{from:N$w,to:x$5},{from:D5r,to:o3h},{from:X8h,to:W39},{from:u0p,to:e7N},{from:B9k,to:w$p},{from:V8W,to:V1N},{from:I6l,to:J36},{from:e6w,to:c1M},{from:J6d,to:e39},{from:N9t,to:C9A},{from:S8Z,to:x6T},{from:J06,to:A0s},{from:h6g,to:G0N},{from:W56,to:r98},{from:C3f,to:W8T},{from:Q4z,to:w90},{from:J4m,to:j6v},{from:z7y,to:s3j},{from:A03,to:U3w},{from:v6x,to:h8w},{from:h3u,to:B4x},{from:V80,to:S2$},{from:z5A,to:J4G},{from:z0o,to:W$8},{from:z88,to:J2$},{from:R3I,to:q1w},{from:H2k,to:U8C},{from:G4G,to:B4G},{from:a_Q,to:b84}],function(B5B){X[B5B.to]=X[B5B.from];}));})(window,document);